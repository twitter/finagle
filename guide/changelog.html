
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Changelog &#8212; Finagle 24.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/finagle.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="License" href="license.html" />
    <link rel="prev" title="Signaling Failure within Finagle" href="developers/SignalingFailure.html" />
   
  
  <link media="only screen and (max-device-width: 480px)" href="_static/small_flask.css" type= "text/css" rel="stylesheet" />
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-39101739-4', 'twitter.github.io');
    ga('send', 'pageview');

  </script>

  </head><body>
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="license.html" title="License"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="developers/SignalingFailure.html" title="Signaling Failure within Finagle"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Finagle</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Changelog</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="changelog">
<h1>Changelog<a class="headerlink" href="#changelog" title="Permalink to this headline">¶</a></h1>
<p>Below is a list of changes for each Finagle release.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">PHAB_ID=#</span></code> and <code class="docutils literal notranslate"><span class="pre">RB_ID=#</span></code> correspond to associated messages in commits.</p>
<section id="unreleased">
<h2>Unreleased<a class="headerlink" href="#unreleased" title="Permalink to this headline">¶</a></h2>
</section>
<section id="id1">
<h2>24.2.0<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<section id="new-features">
<h3>New Features<a class="headerlink" href="#new-features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Implement Toggle aware SimpleFilter. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1130236</span></code></p></li>
<li><p>finagle-memcached: Implement compressing cache using lz4 compression filter. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1130236</span></code></p></li>
<li><p>finagle-mysql: Add a param <cite>c.t.f.mysql.param.Interactive</cite> for configuring whether the finagle-mysql
client is interactive. It is true by default (the existing behaviour).``PHAB_ID=D1138775``</p></li>
</ul>
</section>
<section id="bug-fixes">
<h3>Bug Fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Fix for DeadlineFilter takes rejectWithdrawal regardless of passed Deadline. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1120240</span></code></p></li>
</ul>
</section>
</section>
<section id="id2">
<h2>23.11.0<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<section id="id3">
<h3>New Features<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-stats: A new implementation of BucketedHistogram that works better under high contention, but requires
more memory. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1028784</span></code></p></li>
<li><p>finagle-http2: Add a per session request limit option to http2. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1107613</span></code></p></li>
</ul>
</section>
<section id="runtime-behavior-changes">
<h3>Runtime Behavior Changes<a class="headerlink" href="#runtime-behavior-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Bump netty to 4.1.100 and netty-tcnative to 2.0.61.Final. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1104016</span></code></p></li>
<li><p>finagle: Bump version of Jackson to 2.14.2. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1049772</span></code></p></li>
<li><p>finagle: Update JSqlParser to version 4.6 <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1054717</span></code></p></li>
<li><p>finagle: Bump version of Jackson to 2.14.3. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1069160</span></code></p></li>
</ul>
</section>
<section id="id4">
<h3>Bug Fixes<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Failed recvAddress on Linux due to the remote peer resetting connection should now
be properly seen as a <cite>c.t.f.ChannelClosedException</cite> instead of a
<cite>c.t.f.UnknownChannelException</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=`D1104650</span></code></p></li>
</ul>
</section>
<section id="breaking-api-changes">
<h3>Breaking API Changes<a class="headerlink" href="#breaking-api-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The <cite>c.t.f.context.Retries</cite> context has been renamed to <cite>c.t.f.context.Requeues</cite> to reflect what it
actually contains – the number of requeues a request has had (on the client immediately upstream). Requeues are
retries on write exceptions (i.e. the original request was never sent to the server). <code class="docutils literal notranslate"><span class="pre">PHAB_ID=`D1104878</span></code></p></li>
<li><p>finagle: Deposit budget once in MethodBuilder <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1107653</span></code></p></li>
<li><p>finagle: Pass through configured deadline params rather than use default <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1107765</span></code></p></li>
</ul>
</section>
</section>
<section id="id5">
<h2>22.12.0<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<section id="id6">
<h3>New Features<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Enable tracing for individual fanout requests via the FanoutTracer.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D974564</span></code></p></li>
<li><p>finagle-core: Added helpers for local and peer ServiceIdentity to <cite>SslSessionInfo</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D973030</span></code></p></li>
<li><p>finagle-core: Expose <cite>StackClient.DefaultInjectors</cite>.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1009348</span></code></p></li>
<li><p>finagle-http: RequestBuilder’s <cite>c.t.f.http.FileElement</cite> now has <cite>isText</cite> (default: false)
attribute. When set to <cite>true</cite>, no <cite>Content-Transfer-Encoding</cite> header is populated on the request.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D969859</span></code></p></li>
<li><p>finagle-http: When Finagle Http servers are secured with S2S, write <cite>c.t.finagle.SslSessionInfo#peerIdentity</cite>
as remote user in access log. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D988224</span></code></p></li>
</ul>
</section>
<section id="id7">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>util: Bump version of Jackson to 2.14.1. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1025778</span></code></p></li>
<li><p>finagle-http: Remove DeadlineFilter from Server stack. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D964479</span></code></p></li>
<li><p>finagle-core: Ensure BackupRequestFilter respects maxExtraLoad. For low QPS finagle clients
this may mean fewer backup requests, so such clients can increase their maxExtraLoad setting
if they actually want higher backup request rates. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D981168</span></code></p></li>
<li><p>finagle-serversets: Remove Endpoints with a weight of -1.0 from resolved zookeeper serversets
Negative weights aren’t normally valid so we use “-1.0” as a specific signal to not include
the node in the resolved serverset returned to the client.  This is useful for various types
of testing. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1001342</span></code></p></li>
</ul>
</section>
<section id="id8">
<h3>Breaking API Changes<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>DeadlineFilter.module</cite> has been replaced with <cite>DeadlineFilter.clientModule</cite>
and <cite>DeadlineFilter.serverModule</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D943426</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.Http.Http2</cite> and <cite>c.t.f.Http.Netty4Impl</cite> values were removed because they
were confusing. Use <cite>.withHttp2</cite> and <cite>.withNoHttp2</cite> to toggle HTTP/2 support ON and OFF
respectively.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D935292</span></code></p></li>
<li><p>finagle-core: Allow users of MethodBuilder.idempotent to specify non-retryable responses for
idempotent methods. Previously these were overridden to be retryable.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D999969</span></code></p></li>
<li><p>finagle-core: The <cite>com.twitter.finagle.offload.queueSize</cite> has been removed. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D1011484</span></code></p></li>
</ul>
</section>
</section>
<section id="id9">
<h2>22.7.0<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>finagle-thrift: Changing visibility of InputBuffer and OutputBuffer from [finagle] to [twitter].</p></li>
</ul>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">PHAB_ID=D938475</span></code></p>
</div></blockquote>
<section id="id10">
<h3>New Features<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Introduce panic mode in load balancers. Configure the threshold for
panic mode to start using <cite>withLoadBalancer.panicMode</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D879034</span></code></p></li>
<li><p>finagle-core: Provide <cite>ServerParamsInjector</cite>, a class that will be service-loaded at run-time
by Finagle servers, and will allow generic configuration of all sets of parameters.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D897484</span></code></p></li>
<li><p>finagle-memcached: Add new function, <cite>newLoadBalancedTwemcacheClient</cite>, to create a TwemcacheClient
that doesn’t use a partitioning service.
<a href="#id11"><span class="problematic" id="id12">``</span></a>PHAB_ID=D911789`</p></li>
</ul>
</section>
<section id="id13">
<h3>Bug Fixes<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: fix issue where <cite>Trace.traceLocal</cite> and <cite>Trace.traceLocalFuture</cite> nested traces mistakenly
annotate to the parent span. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D912760</span></code></p></li>
</ul>
</section>
<section id="id14">
<h3>Breaking API Changes<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Remove unused <cite>DeterministicAperture</cite> along with pathways to use weight-unaware
aperture loadbalancers. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D933405</span></code></p></li>
<li><p>finagle-base-http: Methods for getting/setting <cite>Accept</cite>, <cite>Authorization</cite>, <cite>Host</cite>, <cite>Referer</cite>,
<cite>User-Agent</cite>, <cite>X-Forwarded-For</cite> headers were moved from <cite>c.t.f.http.Message</cite> class to
<cite>c.t.f.http.Request</cite> as these headers are only valid on requests and not on responses.
Methods for getting/setting <cite>Location</cite>, <cite>Retry-After</cite>, <cite>Server</cite>, and <cite>WWW-Authenticate</cite> headers
were moved from <cite>c.t.f.http.Message</cite> class to <cite>c.t.f.http.Response</cite> as they are only valid
on responses and not on requests.</p></li>
<li><p>finagle-core: Update OffloadFilter.Param API to encourage recommended construction.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D882210</span></code></p></li>
<li><p>finagle-core: <cite>Trace.recordLocalSpan</cite> is <cite>private[this]</cite> and no longer <cite>protected</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D912760</span></code></p></li>
<li><p>finagle-core: “ServiceFactory#status” is abstract and requires implementation in the inherited
classes. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D933288</span></code></p></li>
<li><p>finagle-core: <cite>StackTransformer</cite> has been renamed to <cite>ServerStackTransformer</cite> and the symmetric
client equivalent (<cite>ClientStackTransformer</cite>) has been added. For those using the older <cite>StackTransformer</cite>
API you will both need to change the code (fix the extends) __and__ rename the META-INF file from
<cite>resources/META-INF/services/com.twitter.finagle.StackTransformer</cite> to
<cite>resources/META-INF/services/com.twitter.finagle.ServerStackTransformer</cite> in order to have your
transformer continue to service-load correctly. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D937634</span></code></p></li>
</ul>
</section>
<section id="id15">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Changed the default implementation for random and deterministic aperture</p></li>
</ul>
<p>load balancers to weighted aperture. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D867878</span></code></p>
<ul class="simple">
<li><p>finagle-partitioning: ThriftCustomPartitioningServices now allow fanning out the same</p></li>
</ul>
<p>request to multiple partitions. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D882370</span></code></p>
<ul class="simple">
<li><p>finagle-core: Rename the counter metric <cite>loadbalancer/max_effort_exhausted</cite> to
<cite>loadbalancer/panicked</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D881529</span></code></p></li>
<li><p>finagle: Upgrade to Netty 4.1.76.Final and netty-tcnative 2.0.51.Final. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D886019</span></code></p></li>
<li><p>finagle: Update Jackson library to version 2.13.3 <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D906005</span></code></p></li>
<li><p>finagle: Bump version of lz4-java to 1.8.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D905411</span></code></p></li>
<li><p>finagle: Upgrade to Netty 4.1.78.Final and netty-tcnative 2.0.53.Final to support
tls tracing for finagle in [Pixie](<a class="reference external" href="https://pixie.dev/">https://pixie.dev/</a>). The Pixie changes aren’t
complete yet, but upgrading netty is a prerequisite for that. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D916996`</span></code></p></li>
</ul>
</section>
</section>
<section id="id16">
<h2>22.4.0<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<section id="id17">
<h3>Bug Fixes<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-integration: we discovered that we had a dead code in MuxClientSession.
Let’s remove Timer as a parameter in MuxClientSession since it’s a dead code.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D869538</span></code></p></li>
</ul>
</section>
</section>
<section id="id18">
<h2>22.3.0<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h2>
<section id="id19">
<h3>Breaking API Changes<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Removed the stack param <cite>WhenNoNodesOpenParam</cite> from LoadBalancerFactory.
Removed NoNodesOpenServiceFactory and NoNodesOpenException. When the majority of nodes
are busy or closed (approx 60%), the load balancer will probabilistically fail open and
pick a node at random. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D843176</span></code></p></li>
</ul>
</section>
<section id="id20">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Bump version of Jackson to 2.13.2. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D848592</span></code></p></li>
</ul>
</section>
</section>
<section id="id21">
<h2>22.2.0<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h2>
<section id="id22">
<h3>New Features<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-logging: Introduced finagle-logging, a new module for SLF4J-integrated
filters. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D813291</span></code></p></li>
<li><p>finagle-logging: Introduced SlowTracesFilter, which observes your requests and
logs the slowest ones that are also sampled for tracing. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D813291</span></code></p></li>
<li><p>finagle-core: Introduced MinSendBackupAfterMs to the stack param Configured in
BackupRequestFilter and propagated changes to MethodBuilder by adding new versions of idempotent
function. When traffic load is low, this is useful to increase the delay when backup requests are
sent and prevent the client from sending unnecessary backup requests. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D825503</span></code></p></li>
<li><p>finagle-core: Added a new annotation <cite>clnt/has_dark_request</cite> in tracing and Finagle
Local context. The new annotation can be used to indicate whether or not the request
has a span that is sent to dark service. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D825317</span></code></p></li>
</ul>
</section>
<section id="id23">
<h3>Bug Fixes<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-netty4-http: On a Request, adding multiple cookies with the same name
to a CookieMap preserves all of them. Only cookies on Responses are
deduplicated. Previously, adding a Request cookie with the same name would
overwrite the old value with the new value. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D801466</span></code></p></li>
<li><p>finagle-postgres: Fixed a bug where a single framer instance was shared across all
connections to a host when using TLS. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D768581</span></code></p></li>
<li><p>finagle-core: Fixed a bug where <cite>InetResolver</cite> was leaking memory while resolving
non-existing address, even if no one is still asking for it. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D771608</span></code></p></li>
</ul>
</section>
<section id="id24">
<h3>Breaking API Changes<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Changed the <cite>shouldInvoke</cite> parameter in method <cite>serviceConcurrently</cite>
and <cite>sendDarkRequest</cite> in AbstractDarkRequestFilter to be a Boolean instead of a
function of (Req =&gt; Boolean). <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D825317</span></code></p></li>
<li><p>finagle-core: Renamed the existing <cite>clnt/dark_request</cite> to <cite>clnt/is_dark_request</cite> in
c.t.finagle.filter.DarkTrafficFilter``PHAB_ID=D825317``</p></li>
</ul>
</section>
<section id="id25">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Bump version of Caffeine to 2.9.3. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D815761</span></code></p></li>
<li><p>finagle: Upgrade to Netty 4.1.73.Final and netty-tcnative 2.0.46.Final.``PHAB_ID=D788382``</p></li>
<li><p>finagle-core: in TimeoutFilter, only transform a timeout exception caused by TimeoutFilter. This also
changes the type of exception raised by the TimeoutFilter from a java.util.concurrent.TimeoutException
to a com.twitter.finagle.RequestTimeoutException. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D814094</span></code></p></li>
<li><p>finagle-mux: Exceptions raised when Mux negotiation has failed have been
moved to a <cite>Debug</cite> log level as the stack trace is generally long and not
necessarily helpful. The logged message now includes the remote address and
that is logged at both the <cite>Debug</cite> level (with the exception and stack trace)
and <cite>Warning</cite> level (without). <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D821661</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.ssl.SslConfigurations.initializeSslContext</cite> now creates an engine which includes TLSv1.3 as a supported protocol. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D814211</span></code></p></li>
<li><p>finagle-netty4: <cite>c.t.f.n.ssl.client.Netty4ClientSslConfigurations.createClientContext</cite> and <cite>c.t.f.n.ssl.server.Netty4ServerSslConfigurations.createServerContext</cite> now create contexts using the provided cipher suites. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D732258</span></code></p></li>
</ul>
</section>
</section>
<section id="id26">
<h2>22.1.0<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h2>
<section id="id27">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Bump version of Jackson to 2.13.1. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D808049</span></code></p></li>
</ul>
</section>
</section>
<section id="id28">
<h2>21.12.0<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h2>
<section id="deprecations">
<h3>Deprecations<a class="headerlink" href="#deprecations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-zipkin-core: <cite>c.t.f.zipkin.core.Sampler.DefaultSampleRate</cite> is deprecated in
favor of <cite>c.t.f.zipkin.core.DefaultSampler.sampleRate</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D795303</span></code></p></li>
</ul>
</section>
<section id="id29">
<h3>Bug Fixes<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-zipkin-core: <cite>c.t.f.zipkin.core.Sampler</cite> would sample at 1/10,000
rate when configured with a lower (but non-zero) rate. It can now sample
at rates as low as 1/16,777,216. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D792693</span></code></p></li>
</ul>
</section>
<section id="id30">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-zipkin-scribe: <cite>c.t.f.zipkin.thrift.ZipkinTracer</cite> uses
<cite>c.t.f.zipkin.core.DefaultSampler.sampleRate</cite> as the default sample rate instead of
deprecated <cite>c.t.f.zipkin.core.Sampler.DefaultSampleRate</cite>. This allows it to correctly
observe user-configured overrides to the default sample rate. When a <cite>ZipkinTracer</cite> is
constructed with default parameters and there are no user-configured overrides, the
behavior is unchanged. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D795303</span></code></p></li>
</ul>
</section>
</section>
<section id="id31">
<h2>21.11.0<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>finagle-base-http: Promote several classes out of <cite>exp</cite> experimental package:
<cite>c.t.f.http.{GenStreamingSerialServerDispatcher, IdentityStreamTransport, StreamTransport}</cite> along
with internal support classes. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D782933</span></code></p></li>
</ul>
<section id="id32">
<h3>New Features<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-memcached: Add public object <cite>c.t.f.memcached.KeyValidation</cite> with a
<cite>validKey</cite> method to allow validation of keys before passing them to various
methods where invalid ones will cause exceptions to be thrown. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D782660</span></code></p></li>
</ul>
</section>
<section id="id33">
<h3>Breaking API Changes<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Remove <cite>c.t.f.loadbalancer.Balancer.maxEffort</cite>. Remove the <cite>maxEffort</cite>
argument from <cite>Balancers.{p2c, p2cPeakEwma, aperture, aperturePeakEwmaUse, roundRobin}</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D772863</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.tracing.ClientRequestTracingFilter</cite> has been removed.
Record relevant tracing information in your service or client directly. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D777298</span></code></p></li>
<li><p>finagle: Remove <cite>com.twitter.finagle.Group</cite>, and other rarely used and deprecated pieces that depend on it
<cite>com.twitter.finagle.memcached.TwitterCacheResolver</cite>, <cite>com.twitter.finagle.memcached.CacheNodeGroup</cite>,
<cite>com.twitter.finagle.memcached.RubyMemCacheClient</cite>, and <cite>com.twitter.finagle.memcached.PHPMemCacheClient</cite>.
Instead of <cite>Group</cite>, please use <cite>Var[Set[T]]</cite> or <cite>Activity[Set[T]]</cite> directly instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D776745</span></code></p></li>
</ul>
</section>
<section id="id34">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Update Caffeine cache library to version 2.9.2 <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D771893</span></code></p></li>
<li><p>finagle-netty4: The current SOCKS and HTTP proxies support going through an HTTP proxy first,
and then a SOCKS proxy. It seems more common to do the other way around, so we’re going to
instead support going through a SOCKS proxy and then an HTTP proxy, and drop support for the
reverse. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D713485</span></code></p></li>
</ul>
</section>
</section>
<section id="id35">
<h2>21.10.0<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h2>
<section id="id36">
<h3>Breaking API Changes<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.loadbalancer.distributor.AddressedFactory</cite> has been removed. Use</p></li>
</ul>
<p><cite>c.t.f.loadbalancer.EndpointFactory</cite> directly instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D751145</span></code></p>
</section>
<section id="id37">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Moved <cite>c.t.finagle.stats.LoadedStatsReceiver</cite> and <cite>c.t.finagle.stats.DefaultStatsReceiver</cite>
from the finagle-core module to util-stats.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D763497</span></code></p></li>
</ul>
</section>
</section>
<section id="id38">
<h2>21.9.0<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h2>
<section id="id39">
<h3>New Features<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Add method Tracing#recordCallSite to record callsite-specific annotations including
code.function, code.namespace, code.filepath and code.lineno. See details at
[OpenTelemetry source code attributes](<a class="reference external" href="https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/trace/semantic_conventions/span-general.md#source-code-attributes">https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/trace/semantic_conventions/span-general.md#source-code-attributes</a>) <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D753929</span></code></p></li>
</ul>
</section>
<section id="id40">
<h3>Breaking API Changes<a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-thrift: Removed c.t.finagle.thrift.ThriftClient#newMethodIface and
ThriftClient#thriftService, use c.t.f.thrift.ThriftClient#methodPerEndpoint. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D747744</span></code></p></li>
</ul>
</section>
<section id="id41">
<h3>Bug Fixes<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core/partitioning: Close balancers and their gauges when repartitioning.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D731675</span></code></p></li>
</ul>
</section>
<section id="id42">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Upgrade to Netty 4.1.67.Final and netty-tcnative 2.0.40.Final. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D726343</span></code></p></li>
<li><p>finagle: Downgrade to Netty 4.1.66.Final <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D746041</span></code></p></li>
<li><p>finagle: Bump version of Jackson to 2.11.4. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D727879</span></code></p></li>
<li><p>finagle-core: OffloadFilter hands off work from Netty I/O thread to the offload CPU thread pool
right after we enter the Finagle stack by default. Previously this could be enabled via a toggle.
The <cite>com.twitter.finagle.OffloadEarly</cite> toggle has been removed. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D733526</span></code></p></li>
</ul>
</section>
</section>
<section id="no-21-7-0-release">
<h2>21.8.0 (No 21.7.0 Release)<a class="headerlink" href="#no-21-7-0-release" title="Permalink to this headline">¶</a></h2>
<section id="id43">
<h3>New Features<a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-mysql: introduce <cite>newRichClient(dest: String, label: String)</cite> method, which removes the
need for extra boilerplate to convert the destination String to a <cite>c.t.finagle.Name</cite> when
specifying both <cite>dest</cite> and <cite>label</cite> in String form. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D706140</span></code></p></li>
<li><p>finagle-http, finagle-thriftmux: introduce client.withSni() API. Use this api to specify an
SNI hostname for TLS clients. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D712652</span></code></p></li>
<li><p>finagle-postgresql: introduce <cite>withStatementTimeout</cite>, <cite>withConnectionInitializationCommands</cite>,
and <cite>withSessionDefaults</cite> APIs to allow configuring sessions before they’re used.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D746525</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.n.NameTreeFactory</cite> now has a configuration flag to determine whether to
retain weighted, unreachable branches of a <cite>NameTree.Union</cite>. Current behavior (retain) remains
unchanged, but can now be overridden via GlobalFlag. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D879306</span></code></p></li>
<li><p>finagle-core: introduce new GlobalFlag <cite>com.twitter.finagle.naming.retainUneachableUnionBranches</cite>
which defaults to <cite>true</cite>. Setting to <cite>false</cite> will prune unreachable <cite>NameTree.Union</cite> branches.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D879306</span></code></p></li>
</ul>
</section>
<section id="id44">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle: Update Caffeine cache library to version 2.9.1 <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D660908</span></code></p></li>
<li><p>finagle: Update ScalaCheck to version 1.15.4 <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D691691</span></code></p></li>
<li><p>finagle-core: change ServiceClosedException to extend FailureFlags and to be
universally retryable <code class="docutils literal notranslate"><span class="pre">PHAB_ID=710580</span></code></p></li>
<li><p>finagle-http: remove the <cite>com.twitter.finagle.http.UseH2</cite>,
<cite>com.twitter.finagle.http.UseH2CClients2</cite>, <cite>com.twitter.finagle.http.UseH2CServers</cite> and
<cite>com.twitter.finagle.http.UseHttp2MultiplexCodecClient</cite> toggles. The configuration for
<cite>c.t.finagle.Http.client</cite> and <cite>c.t.finagle.Http.server</cite> now default to using the HTTP/2 based
implementation. To disable this behavior, use <cite>c.t.finagle.Http.client.withNoHttp2</cite> and
<cite>c.t.finagle.Http.server.withNoHttp2</cite> respectively.</p>
<p>Alternatively, new GlobalFlag’s have been introduced to modify the default behavior of clients
and servers that have not been explicitly configured, where
the <cite>com.twitter.finagle.http.defaultClientProtocol</cite>
and <cite>com.twitter.finagle.http.defaultServerProtocol</cite> flags can be set to <cite>HTTP/1.1</cite> to modify
the default client or server configuration, respectively. <cite>PHAB_ID=D625880`</cite></p>
</li>
<li><p>finagle-netty4: Finagle now reuses Netty “boss” (or parent) threads instead of creating a new
thread per server. Netty parent threads are servicing the server acceptor, a relatively
lightweight component that listens for new incoming connections before handing them out to the
global worker pool.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D662116</span></code></p></li>
<li><p>finagle-http2: introduce optional parameter <cite>NackRstFrameHandling</cite> to enable or disable NACK
conversion to RST_STREAM frames. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D702696</span></code></p></li>
<li><p>finagle-thrift, finagle-thriftmux: clients may start reporting (correctly) lower success rate.
Previously server exceptions not declared in IDL were erroneously considered as successes.
The fgix also improves failure detection and thus nodes previously considered as healthy
by failure accrual policy may be considered as unhealthy. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D698272</span></code></p></li>
</ul>
</section>
<section id="id45">
<h3>Bug Fixes<a class="headerlink" href="#id45" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Add <cite>BackupRequestFilter</cite> to client registry when configured. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D686981</span></code></p></li>
<li><p>finagle-thrift, finagle-thriftmux: clients now treat server exceptions
not declared in IDL as failures, rather than successes,
and do not skip the configured response classifier for failure accrual.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D698272</span></code></p></li>
</ul>
</section>
</section>
<section id="id46">
<h2>21.6.0<a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h2>
<section id="id47">
<h3>New Features<a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Introduce <cite>Dtab.limited</cite>, which is a process-local <cite>Dtab</cite> that will
NOT be remotely broadcast for any protocol, where <cite>Dtab.local</cite> will be
broadcast for propagation on supported protocols. For path name resolution, the
<cite>Dtab.local</cite> will take precedence over the <cite>Dtab.limited</cite>, if the same path is
defined in both, and both take precedence over the <cite>Dtab.base</cite>. The existing
<cite>Dtab.local</cite> request propagation behavior remains unchanged. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D677860</span></code></p></li>
<li><p>finagle-core: Add descriptions to RequestDraining, PrepFactory, PrepConn, and
protoTracing modules in StackClient. Add descriptions to preparer and
protoTracing modules in StackServer. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D685887</span></code></p></li>
<li><p>finagle-mysql: Add support for MySQL 8.0’s default <cite>caching_sha2_password</cite> pluggable
authentication. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D676015</span></code></p></li>
</ul>
</section>
<section id="id48">
<h3>Breaking API Changes<a class="headerlink" href="#id48" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-memcached: Ketama Partitioned Client has been removed and the Partition Aware
Memcached Client has been made the default. As part of this change,
<cite>com.twitter.finagle.memcached.UsePartitioningMemcachedClient</cite> toggle has been removed,
and it no longer applies. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D661460</span></code></p></li>
<li><p>finagle-core: c.t.f.builder.ServerBuilder has been removed. Use the StackServer interfaces
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D689067</span></code></p></li>
</ul>
</section>
<section id="id49">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id49" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Broadcast context keys lookups are now case insensitive. This change is backwards
compatible as the marshalled key id is unchanged. Although enabled by default, this change will
be temporarily sitting behind a toggle, <cite>com.twitter.finagle.context.MarshalledContextLookupId</cite>
that can be used to turn off this change. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D665209</span></code></p></li>
</ul>
</section>
<section id="id50">
<h3>Deprecations<a class="headerlink" href="#id50" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The <cite>ServerBuilder</cite> pattern has been deprecated. Use the stack server pattern
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D691414</span></code></p></li>
</ul>
</section>
</section>
<section id="id51">
<h2>21.5.0<a class="headerlink" href="#id51" title="Permalink to this headline">¶</a></h2>
<section id="id52">
<h3>New Features<a class="headerlink" href="#id52" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http2: Added <cite>c.t.f.http2.param.EnforceMaxConcurrentStreams</cite> which allows users to
configure http2 clients to buffer streams once a connection has hit the max concurrent stream
limit rather than rejecting them.  A <cite>buffered_streams</cite> gauge has been added to track the
current number of buffered streams.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D643138</span></code></p></li>
<li><p>finagle-mux: Added support for TLS snooping to the mux protocol. This allows a thriftmux
server to start a connection as TLS or follow the existing upgrade pathway at the leisure of
the client. This also allows the server to support opportunistic TLS and still downgrade to
vanilla thrift. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D584638</span></code></p></li>
<li><p>finagle-netty4: Added a new counter to keep track of the number of TLS connections that were
started via snooping. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D667652</span></code></p></li>
<li><p>finagle-thrift: Thrift(Mux) clients and servers now fill in a <cite>c.t.f.Thrift.param.ServiceClass</cite>
stack param with the runtime class corresponding to a IDL-generated service stub.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D676781</span></code></p></li>
</ul>
</section>
<section id="id53">
<h3>Breaking API Changes<a class="headerlink" href="#id53" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.param.Logger</cite> has been removed. Use external configuration supported by
your logging backend to alter settings of <cite>com.twitter.finagle</cite> logger.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D618667</span></code></p></li>
</ul>
</section>
<section id="id54">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id54" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-http: Make handling of invalid URI consistent across client implementations. There are
behavioral inconsistencies amongst the current HTTP client implementations:</p>
<p>Our HTTP/1.x clients allow for submitting requests that contain non-ASCII characters and
invalid character encoded sequences, while our HTTP/2 clients will either mangle
the URI and strip out non-ASCII characters within the Netty pipeline or result in an
<cite>UnknownChannelException</cite> when attempting to parse invalid character encoded sequences.
With this change, we now consistently propagate an <cite>InvalidUriException</cite> result, which
is marked as NonRetryable for all HTTP client implementations. All HTTP server implementations
maintain behavior of returning a <cite>400 Bad Request</cite> response status, but now also correctly
handle invalid character encoded sequences. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D660069</span></code></p>
</li>
</ul>
</section>
<section id="id55">
<h3>Bug Fixes<a class="headerlink" href="#id55" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Failed writes on Linux due to a remote peer disconnecting should now
be properly seen as a <cite>c.t.f.ChannelClosedException</cite> instead of a
<cite>c.t.f.UnknownChannelException</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D661550</span></code></p></li>
<li><p>finagle-http2: The <cite>streams</cite> gauge is now correctly added for http2 connections over TLS.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D643138</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.n.NameTreeFactory</cite> will now discard empty elements in
<cite>c.t.f.NameTree.Union’s</cite> with zero weight. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D666635</span></code></p></li>
<li><p>finagle-http: All HTTP server implementations consistently return a <cite>400 Bad Request</cite>
response status when encountering a URI with invalid character encoded sequences.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D660069</span></code></p></li>
</ul>
</section>
</section>
<section id="id56">
<h2>21.4.0<a class="headerlink" href="#id56" title="Permalink to this headline">¶</a></h2>
<section id="id57">
<h3>New Features<a class="headerlink" href="#id57" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Introduce a new <cite>ResponseClassifier</cite> (‘IgnoreIRTEs’) that treats
<cite>com.twitter.finagle.IndividualRequestTimeoutException`s as `ResponseClass.Ignored</cite>.
This response classifier is useful when a client has set a super low <cite>RequestTimeout</cite> and
receiving a response is seen as ‘best-effort’. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D645818</span></code></p></li>
<li><p>finagle-mysql: Introduce support of opportunistic TLS to allow mysql clients
with enabled TLS to speak over encrypted connections with MySQL servers where
TLS is on, and fallback to plaintext connections if TLS is switched off on
the server side. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D644982</span></code></p></li>
</ul>
</section>
<section id="id58">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id58" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The “failures” counter is changed to be created eagerly, when no failure
happens, the counter value is 0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D645590</span></code></p></li>
</ul>
</section>
<section id="id59">
<h3>Breaking API Changes<a class="headerlink" href="#id59" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-exception: This package was no longer used and therefore has been removed. No
replacement is planned. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D656591</span></code></p></li>
</ul>
</section>
</section>
<section id="id60">
<h2>21.3.0<a class="headerlink" href="#id60" title="Permalink to this headline">¶</a></h2>
<section id="id61">
<h3>New Features<a class="headerlink" href="#id61" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Added value <cite>ForceWithDtab</cite> to flag
<cite>-com.twitter.finagle.loadbalancer.exp.apertureEagerConnections</cite> that forces the
aperture load balancer to eagerly connect, even in staging environments where
Dtab locals are set. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D613989</span></code></p></li>
<li><p>finagle-core: Introduce a new <cite>Backoff</cite> to create backoffs based on varies strategies, where
backoffs are calculated on the fly, instead of being created once and memoized in a <cite>Stream</cite>.
Also introduced <cite>Backoff.fromStream(Stream)</cite> and <cite>Backoff.toStream</cite> to help with migration to
the new API. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D592562</span></code></p></li>
<li><p>finagle-netty4: Upgrade to Netty 4.1.59.Final and TcNative 2.0.35.Final. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D629268</span></code></p></li>
<li><p>finagle-http: Integrate Kerberos authentication filter to finagle http client and server.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D634270</span></code> <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D621714</span></code></p></li>
<li><p>finagle-core: Provided <cite>c.t.f.ssl.TrustCredentials.X509Certificates</cite> to enable directly
passing <cite>X509Certificate</cite> instead of passing a <cite>File</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D641088</span></code></p></li>
</ul>
</section>
<section id="id62">
<h3>Breaking API Changes<a class="headerlink" href="#id62" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Builds are now only supported for Scala 2.12+ <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D631091</span></code></p></li>
<li><p>finagle-base-http: Kerberos jaas config <cite>KerberosConfiguration</cite> is replaced with ServerKerberosConfiguration
and ClientKerberosConfiguration concrete classes. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D634270</span></code></p></li>
<li><p>finagle-core: Changed flag <cite>-com.twitter.finagle.loadbalancer.exp.apertureEagerConnections”
from having Boolean values true or false to `EagerConnectionsType</cite> values <cite>Enable</cite>,
<cite>Disable</cite>, and <cite>ForceWithDtab</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D613989</span></code></p></li>
<li><p>finagle-mysql: The constructor of <cite>c.t.f.mysql.transport.MysqlBufReader</cite> now takes an underlying
<cite>c.t.io.ByteReader</cite>. Prior uses of the constructor, which took a <cite>c.t.io.Buf</cite>, should migrate to
using <cite>c.t.f.mysql.transport.MysqlBufReader.apply</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D622705</span></code></p></li>
</ul>
</section>
<section id="id63">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id63" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Revert to scala version 2.12.12 due to <a class="reference external" href="https://github.com/scoverage/sbt-scoverage/issues/319">https://github.com/scoverage/sbt-scoverage/issues/319</a>
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D635917</span></code></p></li>
<li><p>finagle: Bump scala version to 2.12.13 <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D632567</span></code></p></li>
<li><p>finagle-core: Move helper tracing methods like <cite>traceLocal</cite> in <cite>Trace</cite> into the <cite>Tracing</cite> class. This
allows cheaper use of these APIs by first capturing a Trace via <cite>Trace#apply</cite>, avoiding the extra lookups
that will add overhead on the request path. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D633318</span></code>.</p></li>
<li><p>finagle-core: <cite>c.t.finagle.InetResolver</cite>, <cite>c.t.finagle.builder.ClientBuilder</cite>,
<cite>c.t.finagle.liveness.FailureAccrualFactory</cite>, <cite>c.t.finagle.liveness.FailureAccrualPolicy</cite>,
<cite>c.t.finagle.param.ClientParams</cite>, <cite>c.t.finagle.param.SessionQualificationParams</cite>,
<cite>c.t.finagle.service.FailFastFactory</cite>, <cite>c.t.finagle.service.RequeueFilter</cite>,
<cite>c.t.finagle.service.Retries</cite>, <cite>c.t.finagle.service.RetryFilter</cite>, and
<cite>c.t.finagle.service.RetryPolicy</cite> will accept the new <cite>c.t.finagle.service.Backoff</cite> to create
backoffs. Services can convert a <cite>Stream</cite> to/from a <cite>Backoff</cite> with <cite>Backoff.fromStream(Stream)</cite>
and <cite>Backoff.toStream</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D592562</span></code></p></li>
<li><p>finagle-core: remove the <cite>com.twitter.finagle.loadbalancer.apertureEagerConnections</cite> Toggle and
change the default behavior to enable eager connections for <cite>c.t.f.loadbalancer.ApertureLeastLoaded</cite>
and <cite>c.t.f.loadbalancer.AperturePeakEwma</cite> load balancers. The state of the
<cite>com.twitter.finagle.loadbalancer.apertureEagerConnections</cite> GlobalFlag now also defaults to enable
this feature (<cite>Enable</cite>. You can disable this feature for all clients via setting the
<cite>com.twitter.finagle.loadbalancer.apertureEagerConnections</cite> GlobalFlag to <cite>Disable</cite> for your process.
(i.e. <cite>-com.twitter.finagle.loadbalancer.apertureEagerConnections=Disable</cite>).
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D625618</span></code></p></li>
<li><p>finagle-partitioning: Add EndpointMarkedDeadException. Before this change, the exception being
thrown appeared as an anonymous class and it made deciphering it difficult when it came up in
stats. Create a concrete class and throw that. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D640835</span></code></p></li>
</ul>
</section>
<section id="id64">
<h3>Deprecations<a class="headerlink" href="#id64" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>Backoff.fromJava</cite> is marked as deprecated, since the new <cite>Backoff</cite> is java-friendly.
For services using <cite>Stream.iterator</cite> on the old <cite>Backoff</cite>, please use the new API
<cite>Backoff.toJavaIterator</cite> to acquire a java-friendly iterator. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D592562</span></code></p></li>
</ul>
</section>
</section>
<section id="id65">
<h2>21.2.0<a class="headerlink" href="#id65" title="Permalink to this headline">¶</a></h2>
<section id="id66">
<h3>New Features<a class="headerlink" href="#id66" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-zipkin-core: Record <cite>zipkin.sampling_rate</cite> annotation to track sampling
rate at trace roots. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D601379</span></code></p></li>
<li><p>finagle-core: Added variant of <cite>c.t.f.Address.ServiceFactory.apply</cite> that does not require
specifying <cite>c.t.f.Addr.Metadata</cite> and defaults to <cite>c.t.f.Addr.Metadata.empty</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D605438</span></code></p></li>
<li><p>finagle-core: Added variant of <cite>c.t.f.Name.bound</cite> which takes a <cite>c.t.f.Service</cite> as a parameter.
Tying a <cite>Name</cite> directly to a <cite>Service</cite> can be extremely useful for testing the functionality
of a Finagle client. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D605745</span></code></p></li>
<li><p>finagle-mux: Added variant of <cite>c.t.f.mux.Request.apply</cite> and <cite>c.t.f.mux.Requests.make</cite> which takes
only the body of the <cite>Request</cite> (in the form of <cite>c.t.io.Buf</cite>) as a parameter. This is useful for
when the path value of a <cite>Request</cite> is not used by the server (e.g. testing). <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D613686</span></code></p></li>
</ul>
</section>
<section id="id67">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id67" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-memcached: The log level of messages pertaining to whether a Memcached client is using the
older non-partitioned or the newer partitioned version has been lowered. These messages are no
longer written at an ‘info’ level. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D607487</span></code></p></li>
</ul>
</section>
</section>
<section id="id68">
<h2>21.1.0<a class="headerlink" href="#id68" title="Permalink to this headline">¶</a></h2>
<section id="id69">
<h3>New Features<a class="headerlink" href="#id69" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Add <cite>clnt/&lt;FilterName&gt;_rejected</cite> annotation to filters that may throttle requests,
including <cite>c.t.finagle.filter.NackAdmissionFilter</cite> and <cite>c.t.finagle.filter.RequestSemaphoreFilter</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D597875</span></code></p></li>
<li><p>finagle-http: Record http-specific annotations including <cite>http.status_code</cite> and
<cite>http.method</cite>. See details at
<a class="reference external" href="https://github.com/open-telemetry/opentelemetry-specification/tree/master/specification/trace">https://github.com/open-telemetry/opentelemetry-specification/tree/master/specification/trace</a>
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D580894</span></code></p></li>
</ul>
</section>
<section id="id70">
<h3>Bug Fixes<a class="headerlink" href="#id70" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Fix wraparound bug in <cite>Ring.weight</cite>, as reported by &#64;nvartolomei <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D575958</span></code></p></li>
<li><p>finagle-mysql: Update the UTF8 character set to cover those added in MySQL 8.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D590996</span></code></p></li>
<li><p>finagle-thriftmux: Fixed a bug where connections were not established eagerly in ThriftMux
MethodBuilder even when eager connections was enabled. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D589592</span></code></p></li>
</ul>
</section>
<section id="id71">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id71" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>finagle-mysql: Don’t use the full query when adding tracing annotations. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D593944</span></code></p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="id72">
<h2>20.12.0<a class="headerlink" href="#id72" title="Permalink to this headline">¶</a></h2>
<section id="id73">
<h3>New Features<a class="headerlink" href="#id73" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-benchmark: Add a benchmark for LocalContext. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D588632</span></code></p></li>
<li><p>finagle-core: Add a new filter, <cite>ClientExceptionTracingFilter</cite>, that records error annotations for
completed spans. Annotations include <cite>error</cite>, <cite>exception.type</cite>, and <cite>exception.message</cite>.
See <a class="reference external" href="https://github.com/open-telemetry/opentelemetry-specification">https://github.com/open-telemetry/opentelemetry-specification</a> for naming details.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D583001</span></code></p></li>
<li><p>finagle-core: Add a new stat (histogram) that reports how long a task has been sitting in the
offload queue. This instrumentation is sampled at the given interval (100ms by default) that
can be overridden with a global flag <cite>com.twitter.finagle.offload.statsSampleInterval</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D571980</span></code></p></li>
<li><p>finagle-core: Add a new experimental flag <cite>com.twitter.finagle.offload.queueSize</cite> that allows to
put bounds on the offload queue. Any excess work that can’t be offloaded due to a queue overflow
is run on IO (Netty) thread instead. Put this way, this flag enables the simplest form of
backpressure on the link between Netty and OffloadFilter. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D573328</span></code></p></li>
<li><p>finagle-netty4: Add <cite>ExternalClientEngineFactory</cite> to the open source version of Finagle. This
<cite>SslClientEngineFactory</cite> acts as a better example of how to build custom client and server engine
factories in order to reuse SSL contexts for performance concerns. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D572567</span></code></p></li>
<li><p>finagle-core: Provide <cite>com.twitter.finagle.naming.DisplayBoundName</cite> for configuring how to
display the bound <cite>Name</cite> for a given client in metrics metadata. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D573905</span></code></p></li>
<li><p>finagle-core: Provide <cite>ClientParamsInjector</cite>, a class that will be service-loaded at run-time
by Finagle clients, and will allow generic configuration of all sets of parameters.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D574861</span></code></p></li>
</ul>
</section>
<section id="id74">
<h3>Breaking API Changes<a class="headerlink" href="#id74" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Move <cite>DarkTrafficFilter</cite> and <cite>AbstractDarkTrafficFilter</cite> from the experimental
finagle-exp to supported finagle-core. The package containing these classes changed from
<cite>c.t.finagle.exp</cite> to <cite>c.t.finagle.filter</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D572384</span></code></p></li>
<li><p>finagle-core, finagle-thrift: Move <cite>ForwardingWarmUpFilter</cite> and <cite>ThriftForwardingWarmUpFilter</cite>
from the experimental finagle-exp to supported finagle-core, and finagle-thrift, respectively.
The package containing <cite>ForwardingWarmUpFilter</cite> changed from <cite>c.t.finagle.exp</cite> to
<cite>c.t.finagle.filter</cite>, and the package containing <cite>ThriftForwardingWarmUpFilter</cite> changed from
<cite>c.t.finagle.exp</cite> to <cite>c.t.finagle.thrift.filter</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D573545</span></code></p></li>
<li><p>finagle-core: <cite>FailureAccrualFactory.isSuccess</cite> has been replaced with the method
<cite>def classify(ReqRep): ResponseClass</cite> to allow expressing that a failure should be ignored.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D571093</span></code></p></li>
</ul>
</section>
<section id="id75">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id75" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Use Scala default implementation to calculate Hashcode and equals method for
ServiceFactoryProxy. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D569045</span></code></p></li>
<li><p>finagle: Update build.sbt to get aarch64 binaries and try the fast path acquire up to 5 times
before failing over to the AbstractQueuedSynchronizer slow path in NonReentrantReadWriteLock
for Arm64. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D589167</span></code></p></li>
</ul>
</section>
<section id="id76">
<h3>Bug Fixes<a class="headerlink" href="#id76" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Users should no longer see the problematic
<cite>java.lang.UnsupportedOperationException: tail of empty stream</cite> when a <cite>c.t.f.s.RetryPolicy</cite>
is converted to a String for showing. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D582199</span></code></p></li>
</ul>
</section>
</section>
<section id="id77">
<h2>20.10.0<a class="headerlink" href="#id77" title="Permalink to this headline">¶</a></h2>
<section id="id78">
<h3>Breaking API Changes<a class="headerlink" href="#id78" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-thrift: Change the partition locator function getLogicalPartitionId in
PartitioningStrategy from Int =&gt; Int to Int =&gt; Seq[Int], which supports many to many mapping
from hosts and logical partitions. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D550789</span></code></p></li>
</ul>
</section>
<section id="id79">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id79" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Disable eager connections for balancers with a non 1.0 weight. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D567842</span></code></p></li>
</ul>
</section>
</section>
<section id="id80">
<h2>20.9.0<a class="headerlink" href="#id80" title="Permalink to this headline">¶</a></h2>
<section id="id81">
<h3>New Features<a class="headerlink" href="#id81" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Add RelativeName field to Metric Metadata and populate it for
client and server metrics. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D552357</span></code></p></li>
<li><p>finagle-scribe: Add <cite>c.t.finagle.scribe.Publisher</cite> for publishing messages to a
Scribe process. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D539003</span></code></p></li>
<li><p>finagle-thrift/partitioning: Support dynamic resharding for partition aware thriftmux client.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D543466</span></code></p></li>
</ul>
</section>
<section id="id82">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id82" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Bump version of Jackson to 2.11.2. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D538440</span></code></p></li>
</ul>
</section>
<section id="id83">
<h3>Bug Fixes<a class="headerlink" href="#id83" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The TraceId alternative constructor now forwards the <cite>traceIdHigh</cite> parameter to
the primary constructor. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D546612</span></code></p></li>
<li><p>finagle-core: Enforce ordering in RequestLogger to make sure we log the end of async
action before higher modules have a chance to process the result. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D551741</span></code></p></li>
<li><p>finagle-stats: Handle Double percentile rounding error in stat format. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D554778</span></code></p></li>
</ul>
</section>
</section>
<section id="id84">
<h2>20.8.1<a class="headerlink" href="#id84" title="Permalink to this headline">¶</a></h2>
<section id="id85">
<h3>New Features<a class="headerlink" href="#id85" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Populate SourceRole field of Metric Metadata for client and server metrics.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D542596</span></code></p></li>
<li><p>finagle-thriftmux: Add MethodBuilder specific APIs for ThriftMux partition aware client.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D531900</span></code></p></li>
<li><p>finagle-netty4: Upgrade to Netty 4.1.51.Final and TcNative 2.0.34.Final. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D536904</span></code></p></li>
</ul>
</section>
</section>
<section id="do-not-use">
<h2>20.8.0 (DO NOT USE)<a class="headerlink" href="#do-not-use" title="Permalink to this headline">¶</a></h2>
<section id="id86">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id86" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-netty4-http: Post, Put, Patch non-streaming outbound requests with empty bodies will
be added the <cite>Content-Length</cite> header with value <cite>0</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D518010</span></code></p></li>
<li><p>finagle-core: A ServiceFactory created by ServiceFactory.const/constant propagates the wrapped
service status. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D520598</span></code></p></li>
<li><p>finagle-core: Only deposit into the RetryBudget after a request succeeds.
This should help mitigate retry storm behavior. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D528880</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.http.filter.PayloadSizeFilter</cite> no longer adds an annotation on each
streaming chunk and instead aggregates the byte count and adds a single record on stream
termination. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D522543</span></code></p></li>
<li><p>finagle-zipkin-scribe: zipkin scribe <cite>log_span</cite> prefix replaced with <cite>scribe</cite>. <cite>zipkin-scribe/scribe/&lt;stats&gt;</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D527531</span></code></p></li>
</ul>
</section>
<section id="id87">
<h3>New Features<a class="headerlink" href="#id87" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: introduce type-safe <cite>ReqRep</cite> variant <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D520027</span></code></p></li>
<li><p>finagle-core: Added a new variant of <cite>Filter.andThenIf</cite> which allows passing the parameters
as individual parameters instead of a Scala tuple. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D523010</span></code></p></li>
<li><p>finagle-core: new metric (counter) for traces that are sampled. <cite>finagle/tracing/sampled</cite> <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D522355</span></code></p></li>
<li><p>finagle-netty4: Add the <cite>c.t.f.netty4.Netty4Listener.MaxConnections</cite> param that can be used
to limit the number of connections that a listener will maintain. Connections that exceed
the limit are eagerly closed. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D517737</span></code></p></li>
<li><p>finagle-thrift: Added java-friendly <cite>c.t.f.thrift.exp.partitioning.ClientHashingStrategy</cite> and
<cite>c.t.f.thrift.exp.partitioning.ClientCustomStrategy</cite> <cite>create</cite> methods, and added java-friendly
<cite>c.t.f.thrift.exp.partitioning.RequestMergerRegistry#addRequestMerger</cite> and
<cite>c.t.f.thrift.exp.partitioning.ResponseMergerRegistry#addResponseMerger</cite> to make partitioning
easier to use from Java. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D525770</span></code></p></li>
</ul>
</section>
<section id="id88">
<h3>Breaking API Changes<a class="headerlink" href="#id88" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>ReqRep</cite> can no longer be created via <cite>new ReqRep(..)</cite>. Please use
<cite>ReqRep.apply(..)</cite> instead.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D520027</span></code></p></li>
<li><p>finagle-thrift: Updated the <cite>c.t.f.thrift.exp.partitioning.ClientHashingStrategy</cite> and the
<cite>c.t.f.thrift.exp.partitioning.ClientCustomStrategy</cite> to take constructor arguments instead
of needing to override methods on construction. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D525770</span></code></p></li>
<li><p>finagle-zipkin-core: Removed unused <cite>statsReceiver</cite> constructor argument from <cite>RawZipkinTracer</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D527531</span></code></p></li>
</ul>
</section>
</section>
<section id="id89">
<h2>20.7.0<a class="headerlink" href="#id89" title="Permalink to this headline">¶</a></h2>
<section id="id90">
<h3>Breaking API Changes<a class="headerlink" href="#id90" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Correct the spelling of <cite>Tracing.recordClientSendFrargmet()</cite> to
<cite>Tracing.recordClientSendFragment()</cite> <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D505617</span></code></p></li>
<li><p>finagle-redis: Use <cite>StrictKeyCommand</cite> for XDEL <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D517291</span></code></p></li>
<li><p>finagle-toggle: <cite>Toggle.isDefinedAt(i: Int)</cite> has become <cite>Toggle.isDefined</cite>. Additionally, a new method <cite>Toggle.isUndefined</cite> has been added. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D516868</span></code></p></li>
<li><p>finagle-zipkin-scribe: The scribe.thrift file was moved to finagle-thrift/src/main/thrift under a new
namespace. <cite>com.twitter.finagle.thrift.scribe.(thrift|thriftscala)</cite> <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D511471</span></code></p></li>
</ul>
</section>
<section id="id91">
<h3>Bug Fixes<a class="headerlink" href="#id91" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-zipkin-scribe: The scribe client should be configured using the <cite>NullTracer</cite>. Otherwise, spans
produced by the client stack will be sampled at <cite>initialSampleRate</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D507318</span></code></p></li>
<li><p>finagle-redis: The redis client now includes the <cite>RedisTracingFilter</cite> and <cite>RedisLoggingFilter</cite> by default.
Previously, the filters existed but were not applied to the client or accessible. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D558552</span></code></p></li>
</ul>
</section>
</section>
<section id="id92">
<h2>20.6.0<a class="headerlink" href="#id92" title="Permalink to this headline">¶</a></h2>
<section id="id93">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id93" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: FailFastFactory is now disabled at runtime when a client’s destination has only
one endpoint, since the client cannot do anything meaningful by breaking the circuit early.
This is recommended as a best practice anyway, now it’s the default behavior. Less things
to configure and worry about! <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D498911</span></code></p></li>
<li><p>finagle-core: namer annotations are prefixed with “clnt/”. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D492443</span></code></p></li>
<li><p>finagle-core: <cite>namer.success</cite> &amp; <cite>namer.failure</cite> are not annotated as they are not request based.
<cite>namer.tree</cite> annotation was also removed to reduce the size of traces.``PHAB_ID=D492443``</p></li>
<li><p>finagle-core: The offload filter client annotation is annotated under the child request span instead of
its parent. The offload filter annotations are also changed to be binary annotations with the key
<cite>(clnt|srv)/finagle.offload_pool_size</cite> and the value being the pool size <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D502521</span></code></p></li>
</ul>
</section>
<section id="id94">
<h3>Breaking API Changes<a class="headerlink" href="#id94" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-mux: The <cite>c.t.f.mux.transport.OpportunisticTlsConfig</cite> params were moved to
<cite>c.t.f.ssl.OpportunisticTlsConfig</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D482693</span></code></p></li>
<li><p>finagle-core: Migrated <cite>List[Tracer]</cite> to <cite>Seq[Tracer]</cite> in <cite>Tracing</cite>, and <cite>tracersCtx</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D489697</span></code></p></li>
<li><p>finagle-core: <cite>PayloadSizeFilter</cite> and <cite>WireTracingFilter</cite> are now public APIs.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D493803</span></code></p></li>
<li><p>finagle-zipkin-core: <cite>initialSampleRate</cite> flag will now fail if the sample rate is not in the range
[0.0, 1.0]. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D498408</span></code></p></li>
<li><p>finagle-mysql: mysql client annos are prefixed with <cite>clnt/</cite> <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D492274</span></code></p></li>
</ul>
</section>
<section id="id95">
<h3>New Features<a class="headerlink" href="#id95" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-thrift: Expose <cite>c.t.f.thrift.exp.partitioning.PartitioningStrategy</cite>,
the bundled PartitioningStrategy APIs are public for experiments.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D503436</span></code></p></li>
<li><p>finagle-http: Add LoadBalancedHostFilter to allow setting host header after LoadBalancer
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D498954</span></code></p></li>
<li><p>finagle-core: Trace the request’s protocol identified by the <cite>ProtocolLibrary</cite> of the client
stack. This is annotated under <cite>clnt/finagle.protocol</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D495645</span></code></p></li>
<li><p>finagle-core: Add <cite>letTracers</cite> to allow setting multiple tracers onto the tracer stack.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D489697</span></code></p></li>
<li><p>finagle-core: <cite>DeadlineFilter</cite> now exposes a metric <cite>admission_control/deadline/remaining_ms</cite>
which tracks the remaining time in non-expired deadlines on the server side. An increase in this
stat, assuming request latency is constant and timeout configurations upstream have not changed,
may indicate that upstream services have become slower. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D492608</span></code></p></li>
<li><p>finagle-redis: Make partitionedClient accessible. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D492754</span></code></p></li>
<li><p>finagle-core, finagle-http, finagle-thriftmux: introduce <cite>MethodBuilder</cite> <cite>maxRetries</cite>
configuration. A ThriftMux or HTTP method can now be configured to allow a specific number of
maximum retries per request, where the retries are gated by the configured <cite>RetryBudget</cite>. This
configuration can be applied via <cite>Http.client.methodBuilder(name).withMaxRetries(n)</cite> or
<cite>ThriftMux.client.methodBuilder(name).withMaxRetries(n)</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D493139</span></code></p></li>
<li><p>finagle-memcached: Annotate the shard id of the backend the request will reach. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D491738</span></code></p></li>
</ul>
</section>
<section id="id96">
<h3>Bug Fixes<a class="headerlink" href="#id96" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-zipkin-core: Remove flush and late-arrival annotations, which artificially extend
trace durations. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D498073</span></code></p></li>
<li><p>finagle-core: namer annotations are added at the Service level instead of ServiceFactory as
traces are intended to be request based <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D492443</span></code></p></li>
</ul>
</section>
<section id="id97">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id97" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-memcached: The key in <cite>RetrievalCommand</cite> are omitted in traces. The total number of Hits
and Misses are annotated via a counter instead under <cite>clnt/memcached.(hits/misses)</cite> <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D491738</span></code></p></li>
</ul>
</section>
</section>
<section id="id98">
<h2>20.5.0<a class="headerlink" href="#id98" title="Permalink to this headline">¶</a></h2>
<section id="id99">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id99" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Bump jackson version to 2.11.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D457496</span></code></p></li>
</ul>
</section>
</section>
<section id="id100">
<h2>20.4.1<a class="headerlink" href="#id100" title="Permalink to this headline">¶</a></h2>
<section id="id101">
<h3>New Features<a class="headerlink" href="#id101" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-redis: Add <cite>ConnectionInitCommand</cite> stack to set database and password.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D468835</span></code></p></li>
<li><p>finagle-mysql: Add <cite>ConnectionInitSql</cite> stack to set connection init sql. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D468856</span></code></p></li>
</ul>
</section>
<section id="id102">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id102" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Requeued reqeuests due to the <cite>c.t.finagle.service.RequeueFilter</cite> will generate
their own spanId. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D459106</span></code></p></li>
</ul>
</section>
<section id="id103">
<h3>Bug Fixes<a class="headerlink" href="#id103" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Restrict <cite>OffloadFilter</cite> from allowing interruption of the work performed in
the worker pool. This is to ensure that the worker thread isn’t interruptible, which is a
behavior of certain <cite>FuturePool</cite> implementations. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D465042</span></code> <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D465591</span></code></p></li>
<li><p>finagle-netty4: ChannelStatsHandler will now only count the first channel <cite>close(..)</cite> call
when incrementing the <cite>closes</cite> counter. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D462360</span></code></p></li>
</ul>
</section>
<section id="id104">
<h3>Breaking API Changes<a class="headerlink" href="#id104" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-toggle: Removed abstract type for <cite>c.t.finagle.Toggle</cite>, all Toggles are of type <cite>Int</cite>.
This is to avoid Integer auto-boxing when calling <cite>Toggle.apply</cite>, thus to improve overall toggle
performance. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D456960</span></code></p></li>
<li><p>finagle-core: Retried requests due to the <cite>c.t.finagle.service.RetryFilter</cite> will generate their</p></li>
</ul>
<p>own spanId. <a href="#id105"><span class="problematic" id="id106">``</span></a>PHAB_ID=`D466083`</p>
</section>
</section>
<section id="id107">
<h2>20.4.0 (DO NOT USE)<a class="headerlink" href="#id107" title="Permalink to this headline">¶</a></h2>
<section id="id108">
<h3>New Features<a class="headerlink" href="#id108" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Add <cite>Transport.sslSessionInfo</cite> local context which provides access to
the <cite>SSLSession</cite>, session id, cipher suite, and local and peer certificates.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D459854</span></code></p></li>
<li><p>finagle-thrift/thriftmux: Thrift and ThriftMux client side can set a sharable
TReusableBuffer by <cite>withTReusableBufferFactory</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D452763</span></code></p></li>
<li><p>finagle: Server side TLS snooping has been added to all server implementations with the
exception of Mux/ThriftMux. This feature allows a server to select between a cleartext
and TLS connection based on identifying the initial bytes as a TLS record of type handshake.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D436225</span></code></p></li>
</ul>
</section>
<section id="id109">
<h3>Breaking API Changes<a class="headerlink" href="#id109" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-partitioning: Rename <cite>c.t.finagle.partitioning.CacheNode</cite> and <cite>CacheNodeMetadata</cite>
to <cite>c.t.finagle.partitioning.PartitionNode</cite> and <cite>PartitionNodeMetadata</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D448015</span></code></p></li>
<li><p>finagle-partitioning: Rename <cite>c.t.finagle.partitioning.KetamaClientKey</cite> to <cite>HashNodeKey</cite>
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D449929</span></code></p></li>
</ul>
</section>
<section id="id110">
<h3>Bug Fixes<a class="headerlink" href="#id110" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: RequestBuilder headers use SortedMap to equalize keys in different caps.
<cite>setHeader</cite> keys are case insensitive, the last one wins. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D449255</span></code></p></li>
</ul>
</section>
<section id="id111">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id111" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-stats: JsonExporter now caches the regex matching, so that you only need to check
the result of regex matching on new stats. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D459391</span></code></p></li>
</ul>
</section>
</section>
<section id="id112">
<h2>20.3.0<a class="headerlink" href="#id112" title="Permalink to this headline">¶</a></h2>
<section id="id113">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id113" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-netty4: When not using the JDK implementation, the Netty reference counted SSL
types are used which move SSL cleanup out of the GC cycle, reducing pause durations.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D442409</span></code></p></li>
<li><p>finagle-netty4: Upgraded to Netty 4.1.47.Finale and netty-tcnative 2.0.29.Final. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D444065</span></code></p></li>
</ul>
</section>
<section id="id114">
<h3>Bug Fixes<a class="headerlink" href="#id114" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-zipkin-scribe: add a logical retry mechanism to scribe’s TRY_LATER response <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D441366</span></code></p></li>
<li><p>finagle-zipkin-scribe: scope logical stats under “logical” <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D445075</span></code></p></li>
</ul>
</section>
<section id="id115">
<h3>Breaking API Changes<a class="headerlink" href="#id115" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-zipkin-scribe: update the deprecated <cite>FutureIface</cite> to <cite>MethodPerEndpoint</cite> <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D441366</span></code></p></li>
<li><p>finagle-core: Removed <cite>c.t.finagle.service.ShardingService</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D445176</span></code></p></li>
</ul>
</section>
</section>
<section id="id116">
<h2>20.2.1<a class="headerlink" href="#id116" title="Permalink to this headline">¶</a></h2>
<section id="id117">
<h3>New Features<a class="headerlink" href="#id117" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-opencensus-tracing: Add support for providing a custom TextFormat for header
propagation. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D432003</span></code></p></li>
</ul>
</section>
<section id="id118">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id118" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: Support for the <cite>SameSite</cite> cookie attribute is now on by default. This can
be manipulated via the <cite>com.twitter.finagle.http.cookie.supportSameSiteCodec</cite> flag. This means
that cookies that have a value other than <cite>Unset</cite> for the <cite>sameSite</cite> field will have the
attribute encoded (by servers) and decoded (by clients). See this
[Chromium blog post](<a class="reference external" href="https://blog.chromium.org/2019/10/developers-get-ready-for-new.html">https://blog.chromium.org/2019/10/developers-get-ready-for-new.html</a>)
for more information about the <cite>SameSite</cite> attribute. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D426349</span></code></p></li>
<li><p>finagle-core: The default NullTracer for ClientBuilder has been removed. Affected clients may
now see tracing enabled by default via the Java ServiceLoader, as described in the
[Finagle User’s Guide](<a class="reference external" href="http://twitter.github.io/finagle/guide/Tracing.html">http://twitter.github.io/finagle/guide/Tracing.html</a>). <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D437948</span></code></p></li>
<li><p>finagle-http2: The HTTP/2 frame logging tools now log at level INFO. This is symmetric with
the behavior of the <cite>ChannelSnooper</cite> tooling which serves a similar purpose which is to aid
in debugging data flow and isn’t intended to be enabled in production. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D441876</span></code></p></li>
</ul>
</section>
<section id="id119">
<h3>Bug Fixes<a class="headerlink" href="#id119" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http2: Initialize state in H2Pool before use in the gauge to avoid a
NullPointerException. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D428272</span></code></p></li>
<li><p>finagle-http2: HTTP/2 server pipeline now traps close calls to ensure that
events from the initial HTTP/1.x pipeline don’t close the HTTP/2 session. For
example, the initial pipeline was subject to session timeouts even though the
tail of the socket pipeline was effectively dead. Closing of HTTP/2 server
pipelines is now handled through the <cite>H2ServerFilter</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D429554</span></code></p></li>
<li><p>finagle-http2: HTTP/2 servers clean out unused channel handlers when upgrading
from a HTTP/1.x pipeline, removing some traps such as unintended timeouts.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D429416</span></code></p></li>
<li><p>finagle-opencensus-tracing: Fixed internal server error when invalid or no propagation headers
are provided. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D432003</span></code></p></li>
<li><p>finagle-zipkin-scribe: export application metrics under a consistent <cite>zipkin-scribe</cite> scope. Finagle client
stats under <cite>clnt/zipkin-scribe</cite> <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D432274</span></code></p></li>
</ul>
</section>
<section id="id120">
<h3>Breaking API Changes<a class="headerlink" href="#id120" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-zipkin-scribe: Coalesce <cite>ScribeRawZipkinTracer</cite> apply methods into two simple ones. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D432274</span></code></p></li>
<li><p>finagle-zipkin-scribe: <cite>DefaultSampler</cite> moved to <cite>c.t.f.zipkin.core</cite> in finagle-zipkin-core. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D439456</span></code></p></li>
<li><p>finagle-zipkin-scribe: <cite>initialSampleRate</cite> GlobalFlag is moved to finagle-zipkin-core, under the same package
scope <cite>c.t.f.zipkin</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D439456</span></code></p></li>
</ul>
</section>
</section>
<section id="id121">
<h2>20.1.0<a class="headerlink" href="#id121" title="Permalink to this headline">¶</a></h2>
<section id="id122">
<h3>New Features<a class="headerlink" href="#id122" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-memcached: Upgrade to Bijection 0.9.7. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D426488</span></code></p></li>
<li><p>finagle-opencensus-tracing: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D421452</span></code></p></li>
<li><p>finagle-thriftmux: Add support for automatically negotiating compression between a client
and server.  Off by default, clients and servers must be configured to negotiate.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D414638</span></code></p></li>
<li><p>finagle-stats: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D421449</span></code></p></li>
<li><p>finagle-stats-core: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D421449</span></code></p></li>
<li><p>finagle-serversets: Add generic metadata support in ServerSet. Add support for announcing the
generic metadata via ZkAnnouncer. Add support to resolve the generic metadata via Zk2Resolver
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D421151</span></code></p></li>
<li><p>finagle-serversets: Add support for announcing additional endpoints via ZkAnnouncer
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D431062</span></code></p></li>
</ul>
</section>
<section id="id123">
<h3>Breaking API Changes<a class="headerlink" href="#id123" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-partitioning: <cite>ZKMetadata</cite> case class has a new default argument breaking API for
Java users. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D421151</span></code></p></li>
<li><p>finagle-serversets: <cite>Endpoint</cite> case class has a new metadata argument. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D421151</span></code></p></li>
</ul>
</section>
<section id="id124">
<h3>Bug Fixes<a class="headerlink" href="#id124" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-memcached: MemcachedTracingFilter should replace StackClient.Role.protoTracing and not
the protocol-agnostic ClientTracingFilter <code class="docutils literal notranslate"><span class="pre">PHAB=D427660</span></code></p></li>
</ul>
</section>
</section>
<section id="id125">
<h2>19.12.0<a class="headerlink" href="#id125" title="Permalink to this headline">¶</a></h2>
<section id="id126">
<h3>New Features<a class="headerlink" href="#id126" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core, finagle-exp: Add annotations to <code class="docutils literal notranslate"><span class="pre">DarkTrafficFilter</span></code> to identify which span
is dark, as well as which light span it correlates with. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D402864</span></code></p></li>
<li><p>finagle-core: Introduce <cite>Trace#traceLocal</cite> for creating local spans within a trace context.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D404869</span></code></p></li>
</ul>
</section>
<section id="id127">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id127" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Upgrade to jackson 2.9.10 and jackson-databind 2.9.10.1 <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D410846</span></code></p></li>
<li><p>finagle-core: Per-method metrics on MethodBuilder are now created lazily, so if you have
methods that you don’t use, the associated metrics won’t be exported.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D400382</span></code></p></li>
<li><p>finagle-mysql: The RollbackFactory no longer attempts to roll back if the underlying
session is closed since it is highly unlikely to succeed. It now simply poisons the
session and calls close. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D408155</span></code></p></li>
<li><p>finagle-netty4: Change the ‘connection_requests’ metric to debug verbosity.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D391289</span></code></p></li>
<li><p>finagle-serversets: Ensure <cite>ZkSession#retrying</cite> is resilient to ZK host resolution failure.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D403895</span></code></p></li>
<li><p>finagle-thrift: Per-method metrics are now created lazily, so if you have methods on a Thrift
service that you don’t use, the associated metrics won’t be exported.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D400382</span></code></p></li>
<li><p>finagle-zipkin-core: Tracing produces microsecond resolution timestamps in JDK9 or later.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D400661</span></code></p></li>
<li><p>finagle-core: <cite>Trace#time</cite> and <cite>Trace#timeFuture</cite> no longer generate timestamped annotations or
silently discard timing information. They now instead generate a <cite>BinaryAnnotation</cite> containing
the timing information. In order to also get timestamped <cite>Annotations</cite> for when the operation
began and ended, use in conjunction with <cite>Trace#traceLocal</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D404869</span></code></p></li>
</ul>
</section>
<section id="id128">
<h3>Breaking API Changes<a class="headerlink" href="#id128" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The <cite>RetryPolicy</cite> companion object is no longer a <cite>JavaSingleton</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D399947</span></code></p></li>
<li><p>finagle-thrift: The RichClientParam constructors are now all either
deprecated, so to construct it, you must call one of the RichClientParam.apply
methods.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D400382</span></code></p></li>
</ul>
</section>
<section id="id129">
<h3>Deprecations<a class="headerlink" href="#id129" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Deprecate <cite>Tracing#record(message, duration)</cite> as it does not have the intended
effect and silently discards any duration information in the resulting trace. Instead you should
use either <cite>Tracing#recordBinary</cite> or a combination of <cite>Trace#traceLocal</cite> and <cite>Trace#time</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D404869</span></code></p></li>
</ul>
</section>
<section id="id130">
<h3>Bug Fixes<a class="headerlink" href="#id130" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>ClosableService</cite> client stack module that prevents the reuse of closed services
when <cite>FactoryToService</cite> is not set. This is important for clients making use of the <cite>newClient</cite>
api. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D407805</span></code></p></li>
</ul>
</section>
</section>
<section id="id131">
<h2>19.11.0<a class="headerlink" href="#id131" title="Permalink to this headline">¶</a></h2>
<section id="id132">
<h3>New Features<a class="headerlink" href="#id132" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: The <cite>Uri</cite> class now provides access publicly to its
<cite>path</cite>, which is the request uri without the query parameters.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D393893</span></code></p></li>
<li><p>finagle-mysql: Adding native support to finagle-mysql for MySQL JSON Data Type. A client
can now  use <cite>jsonAsObjectOrNull[T]</cite> or <cite>getJsonAsObject[T]</cite> APIs on <cite>c.t.f.mysql.Row</cite> to
read the underlying json value as type <cite>T</cite> or use <cite>jsonBytesOrNull</cite> API to get a raw byte
array of the the json column value. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D390914</span></code></p></li>
<li><p>finagle-mysql: MySQL integration tests can now run on a port other than the default (3306).
Add a <cite>port</cite> property to <cite>.finagle-mysql/integration-test.properties</cite> to customize the value.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D390914</span></code></p></li>
</ul>
</section>
<section id="id133">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id133" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Upgrade to Netty 4.1.43.Final and netty-tcnative 2.0.26.Final. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D389870</span></code></p></li>
<li><p>finagle: Add initial support for JDK 11 compatibility. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D365075</span></code></p></li>
<li><p>finagle: Upgrade to caffeine 2.8.0 <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D384592</span></code></p></li>
<li><p>finagle-http2: Nacks in the form of RST(STREAM_REFUSED | ENHANCE_YOUR_CALM) no
longer surface as a RstException, instead opting for a generic Failure to be
symmetric with the HTTP/1.x nack behavior. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D389234</span></code></p></li>
<li><p>finagle-mux: The mux handshake latency stat has be changed to Debug
verbosity. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D393158</span></code></p></li>
<li><p>finagle-serversets: <cite>finagle/serverset2/stabilizer/notify_ms</cite> histogram has been downgraded to
debug verbosity. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D392265</span></code></p></li>
</ul>
</section>
<section id="id134">
<h3>Breaking API Changes<a class="headerlink" href="#id134" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: <cite>c.t.f.http.codec.HttpContext</cite> moved into <cite>c.t.f.http.codec.context.HttpContext</cite>
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D380407</span></code></p></li>
</ul>
</section>
</section>
<section id="id135">
<h2>19.10.0<a class="headerlink" href="#id135" title="Permalink to this headline">¶</a></h2>
<section id="id136">
<h3>New Features<a class="headerlink" href="#id136" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-partition: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D380444</span></code></p></li>
<li><p>finagle-exception: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D381107</span></code></p></li>
<li><p>finagle-exp: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D380497</span></code></p></li>
<li><p>finagle-http: Expose header validation API to public. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D381771</span></code></p></li>
<li><p>finagle-mysql: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D377721</span></code></p></li>
<li><p>finagle-{mux,thrift,thrift-mux}: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D373165</span></code></p></li>
<li><p>finagle-netty4: Add support to stop default Finagle Netty 4 Timer. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D381605</span></code></p></li>
<li><p>finagle-redis: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D381107</span></code></p></li>
<li><p>finagle-tunable: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D373170</span></code></p></li>
<li><p>finagle-grpc-context: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D373168</span></code></p></li>
<li><p>finagle-thrift: Pass a factory to create a TReusableBuffer as the parameter of a finagle client
to allow multiple clients share one TReusableBuffer. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D378466</span></code></p></li>
<li><p>finagle-zipkin-{core,scribe}: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D381675</span></code></p></li>
</ul>
</section>
<section id="id137">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id137" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: Better performance for the default <cite>HeaderMap.add</cite> method for headers with
the same name. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D381142</span></code></p></li>
<li><p>finagle-http2: H2ServerFilter will no longer swallow exceptions that fire via
<cite>exceptionCaught</cite> in the Netty pipeline. <cite>PHAB_ID=D369185</cite></p></li>
<li><p>finagle-http: Remove legacy HTTP/2 client implementation and make the <cite>MultiplexHandler</cite>-based
implementation the default HTTP/2. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D362950</span></code></p></li>
</ul>
</section>
<section id="id138">
<h3>Breaking API Changes<a class="headerlink" href="#id138" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.l.FailureAccrualFactory</cite>’s <cite>didMarkDead()</cite> changed to <cite>didMarkDead(Duration)</cite>.
The <cite>Duration</cite> is the length of time the endpoint is marked dead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D369209</span></code></p></li>
<li><p>finagle-core: removed the <cite>staticDetermisticApertureWidth</cite> flag. The behavior is now as if the flag
was set to <cite>true</cite> which was also the default behavior. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D382779</span></code></p></li>
</ul>
</section>
<section id="id139">
<h3>Bug Fixes<a class="headerlink" href="#id139" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-mux: Mux now properly propagates <cite>Ignorable</cite> failures multiple levels for superseded
backup requests. This allows for more accurate success rate metrics for downstream services,
when using backup requests.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D365729</span></code></p></li>
</ul>
</section>
</section>
<section id="id140">
<h2>19.9.0<a class="headerlink" href="#id140" title="Permalink to this headline">¶</a></h2>
<section id="id141">
<h3>New Features<a class="headerlink" href="#id141" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-{core,init,toggle,netty4}: Enables cross-build for 2.13.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D364013</span></code></p></li>
<li><p>finagle-base-http: Add <cite>None</cite> as a valid SameSite header value. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D365170</span></code></p></li>
</ul>
</section>
<section id="id142">
<h3>Breaking API Changes<a class="headerlink" href="#id142" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-core: The constructor on <cite>c.t.f.filter.NackAdmissionFilter</cite> used for testing that
took an <cite>Ema.Monotime</cite> has been removed. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D351249</span></code></p></li>
<li><p>finagle-core: The <cite>Adddress.ServiceFactory</cite> variant has been promoted from experimental
status and moved to be properly part of <cite>c.t.f.Address</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D357122</span></code></p></li>
<li><p>finagle-http: improve performance of c.t.f.http.filter.StatsFilter. This results in two notable
API changes:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>There is a <cite>private[filter]</cite> constructor which can take a <cite>() =&gt; Long</cite> for
determining the current time in milliseconds (the existing <cite>StatsFilter(StatsReceiver)</cite>
constructor defaults to using <cite>Stopwatch.systemMillis</cite> for determining the current time in
milliseconds.</p></li>
<li><p>The <cite>protected count(Duration, Response)</cite> method has been changed to
<cite>private[this] count(Long, Response)</cite> and is no longer part of the public API.</p></li>
</ol>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">PHAB_ID=D350733</span></code></p>
</li>
<li><p>finagle-partitioning: the hash-based routing that memcached uses has been relocated to a new
top-level module so that it can be used more broadly across protocols. This results
in several classes moving to the c.t.f.partitioning package:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The <cite>Memcached.param.EjectFailedHost</cite>, <cite>KeyHasher</cite>, and <cite>NumReps</cite> parameters are now
available under <cite>c.t.f.partitioning.param</cite></p></li>
<li><p>The <cite>FailureAccrualException</cite> and <cite>CacheNode</cite> definitions are now in the <cite>c.t.f.paritioning</cite>
package.</p></li>
<li><p>The <cite>ZkMetadata</cite> class has moved to <cite>c.t.f.p.zk</cite> and the finagle-serverset module now depends
on finagle-partitioning.</p></li>
</ol>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">PHAB_ID=D359303</span></code></p>
</li>
</ul>
</section>
<section id="id143">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id143" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: <cite>c.t.f.http.service.NotFoundService</cite> has been changed to no longer
use <cite>Request.response</cite>. Use of <cite>Request.response</cite> is deprecated and discouraged.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D357348</span></code></p></li>
<li><p>finagle-mysql: Handshaking for the MySQL ‘Connection Phase’ now occurs as part of session
acquisition. As part of this change, the
<cite>com.twitter.finagle.mysql.IncludeHandshakeInServiceAcquisition</cite> toggle
has been removed and it no longer applies. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D355549</span></code></p></li>
<li><p>finagle: Upgrade to Netty 4.1.39.Final. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D355848</span></code></p></li>
<li><p>finagle-http: Enable Ping Failure Detection for MultiplexHandler based HTTP/2 clients. Note that
the Ping Failure Detection implementation has been removed completely from the
non-MultiplexHandler based HTTP/2 client. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D360712</span></code></p></li>
<li><p>finagle: Added a dependency on Scala Collections Compat 2.1.2. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D364013</span></code></p></li>
</ul>
</section>
<section id="id144">
<h3>Bug Fixes<a class="headerlink" href="#id144" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: Removes the <cite>Cookie</cite> header of a <cite>c.t.f.http.Message</cite> whenever its cookie map
becomes empty. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D361326</span></code></p></li>
</ul>
</section>
</section>
<section id="id145">
<h2>19.8.0<a class="headerlink" href="#id145" title="Permalink to this headline">¶</a></h2>
<section id="id146">
<h3>Breaking API Changes<a class="headerlink" href="#id146" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The contents of the <cite>c.t.f.dispatch.GenSerialClientDispatcher</cite> object have been
moved to the new <cite>c.t.f.dispatch.ClientDispatcher</cite> object. The stats receiver free constructors
of <cite>GenSerialClientDispatcher</cite> and <cite>SerialClientDispatcher</cite> have been removed.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D342883</span></code></p></li>
<li><p>finagle-thrift: The deprecated <cite>ReqRepThriftServiceBuilder</cite> object has been
removed. Users should migrate to <cite>ReqRepMethodPerEndpointBuilder</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D345740</span></code></p></li>
</ul>
</section>
<section id="id147">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id147" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Failed reads on Linux due to a remote peer disconnecting should now be properly
seen as <cite>c.t.f.ChannelClosedException</cite> instead of a <cite>c.t.f.UnknownChannelException</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D336428</span></code></p></li>
<li><p>finagle: Upgrade to Jackson 2.9.9. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D345969</span></code></p></li>
<li><p>finagle: Upgrade to Netty 4.1.38.Final. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D346259</span></code></p></li>
<li><p>finagle-base-http: Moved c.t.f.http.serverErrorsAsFailures out of its package
object, which changes its name from
<cite>com.twitter.finagle.http.package$serverErrorsAsFailures</cite> to
<cite>com.twitter.finagle.http.serverErrorsAsFailures</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D353045</span></code></p></li>
<li><p>finagle-thrift: Moved c.t.f.thrift.maxReusableBufferSize out of its package
object, which changes its name from
<cite>com.twitter.finagle.thrift.package$maxReusableBufferSize</cite> to
<cite>com.twitter.finagle.thrift.maxReusableBufferSize</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D353045</span></code></p></li>
</ul>
</section>
</section>
<section id="id148">
<h2>19.7.0<a class="headerlink" href="#id148" title="Permalink to this headline">¶</a></h2>
<section id="id149">
<h3>New Features<a class="headerlink" href="#id149" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Measure streaming (message.isChunked) chunk payload size with two new histograms:
<cite>stream/request/chunk_payload_bytes</cite> and <cite>stream/response/chunk_payload_bytes</cite>, they are
published with a debug verbosity level. These chunk payload sizes are also traced via the same
trace keys. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D337877</span></code></p></li>
<li><p>finagle-base-http: Add support for new “b3” tracing header. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D334419</span></code></p></li>
<li><p>finagle-core: Allow to not bypass SOCKS proxy for localhost by using the GlobalFlag
<cite>-com.twitter.finagle.socks.socksProxyForLocalhost</cite> <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D337073</span></code></p></li>
<li><p>finagle-core: OffloadFilter flag to reduce network contention. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D331502</span></code></p></li>
<li><p>finagle-exp: Add private <cite>c.t.f.exp.ConcurrencyLimitFilter</cite> for rejecting requests
that exceed estimated concurrency limit <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D328815</span></code></p></li>
</ul>
</section>
<section id="id150">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id150" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: <cite>c.t.f.http.Cors</cite> has been changed to no longer use the <cite>c.t.f.http.Response</cite>
associated with the passed in <cite>c.t.f.http.Request</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D332765</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.http.filter.ExceptionFilter</cite> has been changed to no longer
use the <cite>c.t.f.http.Response</cite> associated with the passed in <cite>c.t.f.http.Request</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D333509</span></code></p></li>
<li><p>finagle-http: Optimize creation of new Http Dispatchers by re-using created metrics and loggers.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D335114</span></code></p></li>
</ul>
</section>
<section id="id151">
<h3>Breaking API Changes<a class="headerlink" href="#id151" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: Removed the methods <cite>setStatusCode</cite> and <cite>getStatusCode</cite> from
<cite>c.t.f.http.Response</cite> which have been deprecated since 2017. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D326326</span></code></p></li>
<li><p>finagle-core: All deprecated <cite>c.t.f.builder.ServerBuilder#build</cite> methods have
been removed. Users should migrate to using the <cite>build</cite> method which takes a
<cite>ServiceFactory[Req, Rep]</cite> as a parameter. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D331011</span></code></p></li>
<li><p>finagle-core: The <cite>c.t.f.ssl.client.SslClientEngineFactory#getHostname</cite> method has been removed.
All uses should be changed to use the <cite>getHostString</cite> method of <cite>SslClientEngineFactory</cite> instead.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=DD334087</span></code></p></li>
<li><p>finagle-http: The <cite>setOriginAndCredentials</cite>, <cite>setMaxAge</cite>, <cite>setMethod</cite>, and <cite>setHeaders</cite> methods
of <cite>c.t.f.http.Cors.HttpFilter</cite> are no longer overridable. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D332765</span></code></p></li>
<li><p>finagle-http: The details of the <cite>c.t.f.Http.HttpImpl</cite> class are meant to be implementation
details so the class constructor was made private along with the fields. Along these same lines
the <cite>c.t.f.Http.H2ClientImpl.transporter</cite> method has been moved to a private location.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D337136</span></code></p></li>
</ul>
</section>
<section id="id152">
<h3>Bug Fixes<a class="headerlink" href="#id152" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Ensure ClientDispatcher <cite>queueSize</cite> gauge is removed on transport
close, instead of waiting for clean-up at GC time. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D331923</span></code></p></li>
<li><p>finagle-http2: Don’t propagate stream dependency information for the H2 client.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D332191</span></code></p></li>
</ul>
</section>
</section>
<section id="id153">
<h2>19.6.0<a class="headerlink" href="#id153" title="Permalink to this headline">¶</a></h2>
<section id="id154">
<h3>New Features<a class="headerlink" href="#id154" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: SSL/TLS session information has been added to <cite>c.t.f.ClientConnection</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D323305</span></code></p></li>
<li><p>finagle-core: Add a Stack Module with 7 parameters for convenience sake. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D325382</span></code></p></li>
<li><p>finagle-core: For both, servers and clients, introduce a way to shift application-level future
callbacks off of IO threads, into a given <cite>FuturePool</cite> or <cite>ExecutorService</cite>.
Use <cite>withExecutionOffloaded</cite> configuration method (on a client or a server) to access
new functionality. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D325049</span></code></p></li>
<li><p>finagle-http: Added counters for request/response stream as: <cite>stream/request/closed</cite>,
<cite>stream/request/failures</cite>, <cite>stream/request/failures/&lt;exception_name&gt;</cite>, <cite>stream/request/opened</cite>,
<cite>stream/request/pending</cite> and <cite>stream/response/closed</cite>, <cite>stream/response/failures</cite>,
<cite>stream/response/failures/&lt;exception_name&gt;</cite>, <cite>stream/response/opened</cite>, <cite>stream/response/pending</cite>.
The counters will be populated when <cite>isChunked</cite> is set to true, the failures counters will be
populated when <cite>isChunked</cite> is set to true and the stream fails before it has been fully read in the
request and response respectively.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D315041</span></code></p></li>
<li><p>finagle-http: Add two new API variants in <cite>CookieMap</cite>: <cite>addAll</cite> and <cite>removeAll</cite> that allow for
adding and removing cookies in bulk, without triggering a header rewrite on each item.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D318013</span></code></p></li>
<li><p>finagle-mysql: finagle-mysql now supports using SSL/TLS with MySQL. SSL/TLS can be turned on by
calling <cite>withTransport.tls(sslClientConfiguration)</cite> with a specified
<cite>c.t.f.ssl.client.SslClientConfiguration</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D328077</span></code></p></li>
</ul>
</section>
<section id="id155">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id155" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Upgrade to Netty 4.1.35.Final and netty-tcnative 2.0.25.Final.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D312439</span></code></p></li>
<li><p>finagle-core: The default failure accrual policy has been changed from one
which uses only consecutive failures to a hybrid model which uses both
success rate over a window and consecutive failures. Previously this was
changeable via toggle. The toggle has been removed, and the hybrid version
has been made the default. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D327394</span></code></p></li>
<li><p>finagle-http: Rename <cite>request_stream_duration_ms</cite> to <cite>stream/request/duration_ms</cite> and
<cite>response_stream_duration_ms</cite> to <cite>stream/response/duration_ms</cite>. The stats will be
populated when <cite>isChunked</cite> is set to true in the request and response respectively.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D315041</span></code></p></li>
<li><p>finagle-http2: Disable ping-based failure detector in HTTP/2 client as it seems to do
more harm than good.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D322357</span></code></p></li>
<li><p>finagle-http2: Frame logging is now disabled by default for clients. To enable,
use the <cite>c.t.f.http2.param.FrameLogging.Enabled</cite> Stack Param. For example:
<cite>Http.client.configured(FrameLogging.Enabled)</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D326727</span></code></p></li>
<li><p>finagle-netty4: When using a Netty <cite>LocalChannel</cite>, the value of the <cite>BackPressure</cite>
stack param is effectively changed to <cite>backPressureDisabled</cite> so that other functionality
(e.g. SSL/TLS) works as expected. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D319011</span></code></p></li>
<li><p>finagle-netty4: <cite>finagle/netty/pooling/used</cite> now includes the size of the buffers in the
thread-local caches.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D320021</span></code></p></li>
<li><p>finagle-core: Stats and retry modules use a ResponseClassifier to give hints
for how to handle failure (e.g., Is this a success or is it a failure? If
it’s a failure, may I retry the request?). The stats module increments a
success counter for successes, and increments a failure counter for failures.
But there isn’t a way to tell the stats module to just do nothing. And, this
is exactly what the stats module should do (nothing) in the case of ignorable
failures (e.g. backup request cancellations). To represent these cases, we
introduce a new ResponseClass: Ignorable. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D316884</span></code></p></li>
</ul>
</section>
<section id="id156">
<h3>Bug Fixes<a class="headerlink" href="#id156" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>UsingSslSessionInfo</cite> would fail to be constructed properly when
<cite>SSLSession.getLocalCertificates</cite> returns ‘null’. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D324499</span></code></p></li>
<li><p>finagle-http: Finagle now properly sets the <cite>Transport.peerCertificate</cite> local context
when using HTTP/2. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D324392</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.http.collection.RecordSchema.Record</cite> is now thread-safe.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D325700</span></code></p></li>
<li><p>finagle-zipkin-core: Fix a race condition which could cause a span to get logged
missing some annotations. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D319367</span></code></p></li>
<li><p>finagle-mysql: Don’t log <cite>c.t.f.ChannelClosedException</cite> when rolling back a transaction
fails. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D327111</span></code></p></li>
</ul>
</section>
<section id="id157">
<h3>Breaking API Changes<a class="headerlink" href="#id157" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The exceptions <cite>c.t.f.SslHandshakeException</cite> and
<cite>c.t.f.SslHostVerificationException</cite> were no longer used and have
been removed. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D330138</span></code></p></li>
<li><p>finagle-mysql: The structure of <cite>c.t.f.mysql.Request</cite> has changed. It is now based on
a higher level <cite>c.t.f.mysql.ProtocolMessage</cite> and the <cite>cmd</cite> field must contain a value.
Additionally, the synthetic <cite>Command.COM_NO_OP</cite> has been removed, as due to the
restructuring it was no longer necessary. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D327554</span></code></p></li>
<li><p>finagle-mysql: Uses of the abbreviation ‘cap’ have been renamed to the full
word: ‘capabilities’, including for the <cite>baseCapabilities</cite> of <cite>Capability</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D329603</span></code></p></li>
</ul>
</section>
<section id="id158">
<h3>Deprecations<a class="headerlink" href="#id158" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Removed deprecated <cite>response_size</cite> in Finagle Http stats. This is a duplicate stat
of <cite>response_payload_bytes</cite>. PHAB_ID=D328254``</p></li>
</ul>
</section>
</section>
<section id="id159">
<h2>19.5.1<a class="headerlink" href="#id159" title="Permalink to this headline">¶</a></h2>
<p>No Changes</p>
</section>
<section id="id160">
<h2>19.5.0<a class="headerlink" href="#id160" title="Permalink to this headline">¶</a></h2>
<section id="id161">
<h3>New Features<a class="headerlink" href="#id161" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Add two new methods to <cite>com.twitter.finagle.http.MediaType</cite>,
<cite>MediaType#typeEquals</cite> for checking if two media types have the same type and
subtype, ignoring their charset, and <cite>MediaType#addUtf8Charset</cite> for easily
setting a utf-8 charset.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D308761</span></code></p></li>
</ul>
</section>
<section id="id162">
<h3>Bug Fixes<a class="headerlink" href="#id162" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Ensure server returns 400 Bad Request when
non-ASCII characters are present in the HTTP request URI path. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D312009</span></code></p></li>
</ul>
</section>
<section id="id163">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id163" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Deterministic aperture (d-aperture) load balancers no longer export
“loadband” scoped metrics: “widen”, “narrow”, “offered_load_ema”. These were not
necessary as d-aperture does not change the aperture size at runtime. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D303833</span></code></p></li>
<li><p>finagle-core: Request logging now defaults to disabled. Enable it by configuring the
<cite>RequestLogger</cite> Stack parameter on your <cite>Client</cite> or <cite>Server</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D308476</span></code></p></li>
<li><p>finagle-core: Subtree binding failures in <cite>NameTree.Union</cite>’s are ignored in the
final binding result. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D315282</span></code></p></li>
</ul>
</section>
<section id="id164">
<h3>Breaking API Changes<a class="headerlink" href="#id164" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The <cite>c.t.f.client.EndpointerModule</cite> and <cite>c.t.f.pushsession.PushStackClient</cite> public
and protected APIs have been changed to use the abstract <cite>java.net.SocketAddress</cite> instead of the
concrete <cite>java.net.InetSocketAddress</cite> as relying on the concrete implementation was not
necessary. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D315111</span></code></p></li>
<li><p>finagle-http: For Finagle HTTP clients, the <cite>withMaxRequestSize(size)</cite> API
method has been removed. For Finagle HTTP servers, the
<cite>withMaxResponseSize(size)</cite> method has been removed. The underlying <cite>Stack</cite>
params which are set by these methods are respectively HTTP server and HTTP
client side params only. Using these removed methods had no effect on the
setup of Finagle HTTP clients and servers. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D314019</span></code></p></li>
<li><p>finagle-mysql: HandshakeResponse has been removed from finagle-mysql’s public
API. It is expected that users of the library are relying entirely on
finagle-mysql for handshaking. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D304512</span></code></p></li>
</ul>
</section>
</section>
<section id="id165">
<h2>19.4.0<a class="headerlink" href="#id165" title="Permalink to this headline">¶</a></h2>
<section id="id166">
<h3>New Features<a class="headerlink" href="#id166" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-core: Make maxDepth in Namer configurable. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D286444</span></code></p>
<ul class="simple">
<li><p>namerMaxDepth in Namer now configurable through a global flag (namerMaxDepth)</p></li>
</ul>
</li>
<li><p>finagle-core: The newly renamed <cite>SslSessionInfo</cite> is now public. It is
intended for providing information about a connection’s SSL/TLS session.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D286242</span></code></p></li>
<li><p>finagle-core: Added the <cite>c.t.finagle.DtabFlags</cite> trait which defines a Flag and function for
appending to the “base” <cite>c.t.finagle.Dtab</cite> delegation table. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D297596</span></code></p></li>
<li><p>finagle-http: Finagle HTTP implementation now supports trailing headers (trailers). Use
<cite>c.t.f.http.Message.trailers</cite> to access trailing headers on a fully-buffered message
(<cite>isChunked == false</cite>) or <cite>c.t.f.http.Message.chunkReader</cite> on a message with chunked payload
(<cite>isChunked == true</cite>).  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D283999</span></code></p></li>
<li><p>finagle-http,thriftmux: Added tracing annotations to backup requests. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D285486</span></code></p>
<ul class="simple">
<li><p>Binary annotation “srv/backup_request_processing”, when servers are processing backup requests.</p></li>
</ul>
</li>
<li><p>finagle-http: Added new server metrics to keep track of inbound requests that are rejected due to
their headers containing invalid characters (as seen by RFC-7230): <cite>rejected_invalid_header_names</cite>
and <cite>rejected_invalid_header_values</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D294754</span></code></p></li>
<li><p>finagle-http: Added stats of the duration in milliseconds of request/response streams:
<cite>request_stream_duration_ms</cite> and <cite>response_stream_duration_ms</cite>. They are enabled by using
<cite>.withHttpStats</cite> on <cite>Http.Client</cite> and <cite>Http.Server</cite>  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D297900</span></code></p></li>
<li><p>finagle-mysql: A new toggle, “com.twitter.finagle.mysql.IncludeHandshakeInServiceAcquisition”, has
been added. Turning on this toggle will move MySQL session establishment (connection phase) to be
part of service acqusition. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D301456</span></code></p></li>
<li><p>finagle-core: Support for MethodBuilder and stack construction outside of <cite>c.t.f</cite> package.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D275053</span></code>.
This includes:
- <cite>c.t.f.client.MethodBuilder</cite> is now public.
- construction of the following stack modules are now public: <cite>c.t.f.factory.TimeoutFactory</cite>,</p>
<blockquote>
<div><p><cite>c.t.f.filter.ExceptionSourceFilter</cite>, <cite>c.t.f.loadbalancer.LoadBalancerFactory</cite>,
<cite>c.t.f.service.Retries</cite></p>
</div></blockquote>
</li>
</ul>
</section>
<section id="id167">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id167" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Client-side nacking admission control now defaults on. See the documentation
on <cite>c.t.f.filter.NackAdmissionFilter</cite> for details. This can be disabled by setting the
global flag, <cite>com.twitter.finagle.client.useNackAdmissionFilter</cite>, to false.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D289583</span></code></p></li>
<li><p>finagle-core: <cite>LatencyCompensation</cite> now applies to service acquisition. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D285574</span></code></p></li>
<li><p>finagle-http: HTTP headers validation on the outbound path is now in compliance with RFC7230.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D247125</span></code></p></li>
<li><p>finagle-netty4: Netty’s reference leak tracking now defaults to disabled.
Set the flag <cite>com.twitter.finagle.netty4.trackReferenceLeaks</cite> to <cite>true</cite> to enable.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D297031</span></code></p></li>
</ul>
</section>
<section id="id168">
<h3>Breaking API Changes<a class="headerlink" href="#id168" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Dropped a dependency on Netty 3:</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>finagle-netty3 sub-project has been removed</p></li>
<li><p>finagle-http-cookie sub-project has been removed</p></li>
<li><p><cite>c.t.f.http.Cookie</cite> no longer takes Netty’s <cite>DefaultCookie</cite> in the constructor</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">PHAB_ID=D291221</span></code></p>
</div></blockquote>
<ul class="simple">
<li><p>finagle-core: The <cite>peerCertificate</cite> methods of <cite>c.t.f.t.TransportContext</cite> and
<cite>c.t.f.p.PushChannelHandle</cite> have been replaced with the more robust
<cite>sslSessionInfo</cite>. Users looking for just the functional equivalence of
<cite>peerCertificate</cite> can use <cite>sslSessionInfo.peerCertificates.headOption</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D285926</span></code></p></li>
<li><p>finagle-core: The <cite>com.twitter.finagle.core.UseClientNackAdmissionFilter</cite> toggle
has been replaced by a global flag, <cite>com.twitter.finagle.client.useNackAdmissionFilter</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D289583</span></code></p></li>
<li><p>finagle-thrift: Allow users to specify stringLengthLimit and containerLengthLimit <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D286346</span></code>
- method parameter <cite>readLength</cite> in com.twitter.finagle.thrift.Protocols#binaryFactory renamed to stringLengthLimit to reflect usage
- method parameter <cite>containerLengthLimit</cite> added to com.twitter.finagle.thrift.Protocols#binaryFactory</p></li>
</ul>
</section>
</section>
<section id="id169">
<h2>19.3.0<a class="headerlink" href="#id169" title="Permalink to this headline">¶</a></h2>
<section id="id170">
<h3>New Features<a class="headerlink" href="#id170" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Added tracing annotations to backup requests. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D280998</span></code></p>
<ul>
<li><p>Timestamped annotation “Client Backup Request Issued”</p></li>
<li><p>Timestamped annotation “Client Backup Request Won” or “Client Backup Request Lost”</p></li>
<li><p>Binary annotation “clnt/backup_request_threshold_ms”, with the current value of the latency threshold, in milliseconds</p></li>
<li><p>Binary annotation “clnt/backup_request_span_id”, with the span id of the backup request</p></li>
</ul>
</li>
</ul>
</section>
<section id="id171">
<h3>Breaking API Changes<a class="headerlink" href="#id171" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Deprecated multi-param legacy <cite>tls</cite> methods have been removed in
<cite>c.t.f.param.ServerTransportParams</cite> and <cite>c.t.f.builder.ServerBuilder</cite>. Users should migrate
to using the <cite>tls(SslServerConfiguration)</cite> method instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D277045</span></code></p></li>
</ul>
</section>
<section id="id172">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id172" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The tracing annotations from <cite>MkJvmFilter</cite> have been enhanced. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D282590</span></code></p>
<ul>
<li><p>Timestamped annotations “GC Start” and “GC End” for each garbage collection
event that occurred during the request.</p></li>
<li><p>Binary annotation “jvm/gc_count”, with the total number of garbage collection
events that occurred during the request.</p></li>
<li><p>Binary annotation “jvm/gc_ms”, with the total milliseconds of garbage collection
events that occurred during the request.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="id173">
<h2>19.2.0<a class="headerlink" href="#id173" title="Permalink to this headline">¶</a></h2>
<section id="id174">
<h3>New Features<a class="headerlink" href="#id174" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Added gauge <cite>is_marked_dead</cite> as an indicator of whether the host is marked
as dead(1) or not(0) in <cite>FailFastFactory</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D263552</span></code></p></li>
<li><p>finagle-core: <cite>KeyCredentials.CertsAndKey</cite> has been added as an option for
<cite>c.t.f.ssl.KeyCredentials</cite> for when the certificate and certificate chain are
contained within the same file. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D264325</span></code></p></li>
<li><p>finagle-thriftmux: Additional information is now annotated in traces for clients
using Scrooge generated Thrift bindings. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D269383</span></code>, <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D270597</span></code>,
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D272934</span></code>.
This includes:</p>
<ul>
<li><p>RPC method name</p></li>
<li><p>Request serialization time, in nanoseconds</p></li>
<li><p>Request deserialization time, in nanoseconds</p></li>
<li><p>Response serialization time, in nanoseconds</p></li>
<li><p>Response deserialization time, in nanoseconds</p></li>
</ul>
</li>
</ul>
</section>
<section id="id175">
<h3>Breaking API Changes<a class="headerlink" href="#id175" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-http: Removed <cite>Http.Client.withCompressionLevel</cite> because it wasn’t doing anything.
To migrate your client, simply remove the configuration–it had absolutely no effect.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D260077</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.dispatch.ExpiringServerDispatcher</cite> was dead code. We removed it.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D269331</span></code></p></li>
<li><p>finagle-thrift: Removed <cite>newIface</cite> and <cite>newServiceIface</cite> methods from
<cite>c.t.f.thrift.ThriftRichClient.MultiplexedThriftClient</cite>, which are deprecated in November 2017.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D271774</span></code></p></li>
<li><p>finagle-thrift: Removed deprecated APIs located in Thrift.scala: <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D272811</span></code></p>
<blockquote>
<div><ol class="arabic simple">
<li><p>c.t.f.Thrift.Client.stats =&gt; use c.t.f.Thrift.Client.clientParam.clientStats</p></li>
<li><p>c.t.f.Thrift.withProtocolFactory =&gt; use c.t.f.Thrift.client.withProtocolFactory</p></li>
<li><p>c.t.f.Thrift.withClientId =&gt; use c.t.f.Thrift.client.withClientId</p></li>
<li><p>c.t.f.Thrift.Server.serverLabel =&gt; use c.t.f.Thrift.Server.serverParam.serviceName</p></li>
<li><p>c.t.f.Thrift.Server.serverStats =&gt; use c.t.f.Thrift.Server.serverParam.serverStats</p></li>
<li><p>c.t.f.Thrift.Server.maxThriftBufferSize =&gt; use c.t.f.Thrift.Server.serverParam.maxThriftBufferSize</p></li>
</ol>
</div></blockquote>
</li>
<li><p>finagle-thrift: <cite>c.t.f.thrift.ThriftServiceIface.Filterable</cite> is removed, use
<cite>c.t.f.thrift.service.Filterable</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D272427</span></code></p></li>
<li><p>finagle-thrift: <cite>c.t.f.thrift.ThriftServiceIface</cite> is removed, use
<cite>c.t.f.thrift.service.ThriftServicePerEndpoint</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D272427</span></code></p></li>
<li><p>finagle-thriftmux: Removed deprecated APIs located in ThriftMux.scala: <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D272811</span></code></p>
<blockquote>
<div><ol class="arabic simple">
<li><p>c.t.f.ThriftMux.Client.stats =&gt; use c.t.f.ThriftMux.Clien.clientParam.clientStats</p></li>
<li><p>c.t.f.ThriftMux.Server.serverLabel =&gt; use c.t.f.ThriftMux.Server.serverParam.serviceName</p></li>
<li><p>c.t.f.ThriftMux.Server.serverStats =&gt; use c.t.f.ThriftMux.Server.serverParam.serverStats</p></li>
<li><p>c.t.f.ThriftMux.Server.maxThriftBufferSize =&gt; use c.t.f.ThriftMux.Server.serverParam.maxThriftBufferSize</p></li>
</ol>
</div></blockquote>
</li>
<li><p>finagle-thriftmux: <cite>ThriftMux.Client.pushMuxer</cite> is removed. Use <cite>ThriftMux.Client.standardMuxer</cite>
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D269373</span></code></p></li>
<li><p>finagle-thriftmux: <cite>ThriftMux.serverMuxer</cite> is removed. Use <cite>ThriftMux.Server.defaultMuxer</cite>
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D269373</span></code></p></li>
<li><p>finagle-base-http: Removed the <cite>c.t.f.http.Statuses</cite> java helper, which was deprecated two years
ago in favor of using <cite>c.t.f.http.Status</cite> directly. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D269224</span></code></p></li>
<li><p>finagle-base-http: Removed the <cite>c.t.f.http.Versions</cite> java helper, which was deprecated two years
ago in favor of using <cite>c.t.f.http.Version</cite> directly. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D269207</span></code></p></li>
<li><p>finagle-base-http: Removed the <cite>c.t.f.http.Methods</cite> java helper, which was deprecated two years
ago in favor of using <cite>c.t.f.http.Method</cite> directly. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D273235</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.http.Response.Ok</cite> was removed. Use just <cite>Response()</cite> or <cite>Response.Proxy</cite>
if you need to mock it. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D269737</span></code></p></li>
<li><p>finagle-core: <cite>Drv.Aliased</cite> and <cite>Drv.newVose</cite> are now private, please
construct a <cite>Drv</cite> instance using <cite>Drv.apply</cite> or <cite>Drv.fromWeights</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D262960</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.BackupRequestLost</cite> is now removed. Please use <cite>c.t.f.Failure.ignorable</cite>
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D270833</span></code></p></li>
</ul>
</section>
<section id="id176">
<h3>Bug Fixes<a class="headerlink" href="#id176" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Fix for a bug where HTTP/2 clients could retry requests that had a chunked
body even if the request body was consumed. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D258719</span></code></p></li>
<li><p>finagle-http: Fix for a bug where HTTP clients could assume connections are reusable, despite
having streaming requests in flight. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D264985</span></code></p></li>
</ul>
</section>
<section id="id177">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id177" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Faster <cite>Filters</cite>. Removes unnecessary <cite>Service.rescue</cite> proxies from
the intermediate <cite>andThen</cite>-ed <cite>Filters</cite>. Previously in rare cases you might have seen
a raw <cite>Exception</cite> not wrapped in a <cite>Future</cite> if the <cite>Filter</cite> threw. These will now
consistently be lifted into a <cite>Future.exception</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D269003</span></code></p></li>
<li><p>finagle-core: MethodBuilder metrics filtering updated to now report rolled-up
logical failures. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D271195</span></code></p></li>
<li><p>finagle-http: Disabling Netty3 cookies in favor of Netty4 cookies. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D262776</span></code></p></li>
<li><p>finagle-http: Removed the debug metrics <cite>http/cookie/dropped_samesites</cite> and
<cite>http/cookie/flagless_samesites</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D267239</span></code></p></li>
</ul>
</section>
<section id="id178">
<h3>Deprecations<a class="headerlink" href="#id178" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Multi-param legacy <cite>tls</cite> methods have been deprecated in
<cite>c.t.f.param.ServerTransportParams</cite> and <cite>c.t.f.builder.ServerBuilder</cite>. Users should migrate
to using the <cite>tls(SslServerConfiguration)</cite> method instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D265844</span></code></p></li>
<li><p>finagle-core: <cite>$client.withSession.maxIdleTime</cite> is now deprecated; use
<cite>$client.withSessionPool.ttl</cite> instead to set the maximum allowed duration a connection may be
cached for.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D272370</span></code></p></li>
<li><p>finagle-serversets: <cite>c.t.f.zookeeper.ZkResolver</cite> has been deprecated in favor
of <cite>c.t.f.serverset2.Zk2Resolver</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D273608</span></code></p></li>
</ul>
</section>
</section>
<section id="id179">
<h2>19.1.0<a class="headerlink" href="#id179" title="Permalink to this headline">¶</a></h2>
<section id="id180">
<h3>New Features<a class="headerlink" href="#id180" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.s.StackBasedServer</cite> has been changed to extend the
<cite>c.t.f.Stack.Transformable</cite> trait. This brings <cite>StackBasedServer</cite> into parity
with <cite>c.t.f.c.StackBasedClient</cite>, which already extends the
<cite>Stack.Transformable</cite> trait. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D253542</span></code></p></li>
<li><p>finagle-http: HttpMuxer propagates the close signal to the underlying handlers.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D254656</span></code></p></li>
<li><p>finagle-stats-core: introduce flag to allow logging metrics on service shutdown.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D253590</span></code></p></li>
</ul>
</section>
<section id="id181">
<h3>Breaking API Changes<a class="headerlink" href="#id181" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The deprecated <cite>c.t.f.b.ServerBuilder.stack</cite> method which takes a function
has been removed. Uses of this method should be changed to use the <cite>c.t.f.b.ServerBuilder.stack</cite>
method which takes a <cite>c.t.f.s.StackBasedServer</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D251975</span></code></p></li>
<li><p>finagle-core: The type of <cite>c.t.f.b.ServerConfig.nilServer</cite> has been changed from
<cite>Server[Req, Rep]</cite> to <cite>StackBasedServer[Req, Rep]</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D252142</span></code></p></li>
<li><p>finagle-core: The access level of the <cite>c.t.f.b.ServerBuilder.copy</cite> method has changed
from protected to private. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D252142</span></code></p></li>
<li><p>finagle-core: The bridge type <cite>c.t.f.b.Server</cite> has been removed. Users should
change to use <cite>c.t.f.ListeningServer</cite> instead. Uses of the previously
deprecated <cite>Server.localAddress</cite> should use <cite>ListeningServer.boundAddress</cite>
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D254339</span></code></p></li>
<li><p>finagle-core: The deprecated <cite>c.t.f.t.Transport.localAddress</cite> and
<cite>c.t.f.t.Transport.remoteAddress</cite> methods are now final and can no longer
be extended. Users should migrate to the respective <cite>c.t.f.t.TransportContext</cite>
methods. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D256257</span></code></p></li>
<li><p>finagle-thrift: The <cite>c.t.f.t.ThriftRichClient.protocolFactory</cite> and
<cite>c.t.f.t.ThriftRichServer.protocolFactory</cite> methods have been removed. Users should
switch to using <cite>ThriftRichClient.clientParam.protocolFactory</cite> and
<cite>ThriftRichServer.serverParam.protocolFactory</cite> instead. In addition, implementations
of the <cite>protocolFactory</cite> method have been removed from the concrete <cite>c.t.f.Thrift</cite>
and <cite>c.t.f.ThriftMux</cite> client and server. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D256217</span></code></p></li>
</ul>
</section>
<section id="id182">
<h3>Bug Fixes<a class="headerlink" href="#id182" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Failed writes on Linux due to a remote peer disconnecting should now
be properly seen as a <cite>c.t.f.ChannelClosedException</cite> instead of a
<cite>c.t.f.UnknownChannelException</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D256007</span></code></p></li>
<li><p>finagle-http: Compression level of 0 was failing on the server-side when speaking h2c.
Updated so that it can handle a request properly. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D251320</span></code></p></li>
<li><p>finagle-thriftmux: A Java compatibility issue for users trying to call <cite>withOpportunisticTls</cite>
on <cite>ThriftMux</cite> clients and servers has been fixed. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D256027</span></code></p></li>
</ul>
</section>
<section id="id183">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id183" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>ServiceFactory.const</cite> propagates the close from the <cite>ServiceFactory</cite>
to the underlying service, instead of ignoring it. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D254656</span></code></p></li>
</ul>
</section>
</section>
<section id="id184">
<h2>18.12.0<a class="headerlink" href="#id184" title="Permalink to this headline">¶</a></h2>
<section id="id185">
<h3>New Features<a class="headerlink" href="#id185" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-redis: Add support for the new stream API released in Redis 5.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D244329</span></code></p></li>
<li><p>finagle-core: Add Java compatibility for <cite>c.t.f.Filter.TypeAgnostic.Identity</cite>
via <cite>c.t.f.Filter.typeAgnosticIdentity()</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D242006</span></code></p></li>
<li><p>finagle-core: Add Java compatibility for <cite>c.t.f.Name</cite> through <cite>Names</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D242084</span></code></p></li>
<li><p>finagle-core: Introduce a <cite>StackServer.withStack</cite> overload that
makes modifying the existing <cite>Stack</cite> easier when using method chaining.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D246893</span></code></p></li>
<li><p>finagle-stats: Split the implementation and <cite>ServiceLoading</cite> into separate modules.
The implementation is in <cite>finagle-stats-core</cite>. This is backwards compatible
for existing users of <cite>finagle-stats</cite> while allowing new usages built on top.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D249875</span></code></p></li>
<li><p>finagle-thrift: Add <cite>c.t.finagle.thrift.MethodMetadata</cite> which provides a <cite>LocalContext</cite> Key
for setting information about the current Thrift method and an accessor for retrieving
the currently set value. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D241295</span></code></p></li>
<li><p>finagle-thrift: Update <cite>c.t.finagle.thrift.MethodMetadata</cite> to provide an
<cite>asCurrent</cite> method to set the current <cite>c.t.finagle.thrift.MethodMetadata</cite> in the
<cite>LocalContext</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D243625</span></code></p></li>
</ul>
</section>
<section id="id186">
<h3>Breaking API Changes<a class="headerlink" href="#id186" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The <cite>c.t.u.Closable</cite> trait has been removed from
<cite>c.t.f.t.TransportContext</cite>, as well as the <cite>close</cite> and <cite>onclose</cite> methods. Uses of
these methods within <cite>TransportContext</cite> should be changed to use the corresponding
methods on <cite>c.t.f.t.Transport</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D244742</span></code></p></li>
<li><p>finagle-core: The deprecated <cite>c.t.f.t.Transport.peerCertificate</cite> method on the <cite>Transport</cite> class
(not the <cite>Transport.peerCertificate</cite> Finagle context) has been removed. Uses of this
method should be changed to use <cite>c.t.f.t.TransportContext.peerCertificate</cite> instead.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D250027</span></code></p></li>
<li><p>finagle-core: The deprecated <cite>c.t.f.t.TransportContext.status</cite> method has been removed
from <cite>TransportContext</cite>. Uses of this method should be changed to use
<cite>c.t.f.t.Transport.status</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D247234</span></code></p></li>
<li><p>finagle-mysql: <cite>c.t.f.m.Charset</cite> has been renamed to <cite>c.t.f.m.MysqlCharset</cite> to resolve
any ambiguity between it and the <cite>Charset</cite> <cite>Stack</cite> parameter. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D240965</span></code></p></li>
<li><p>finagle-mysql: All <cite>Stack</cite> params (<cite>Charset</cite>, <cite>Credentials</cite>, <cite>Database</cite>, <cite>FoundRows</cite>,
<cite>MaxConcurrentPrepareStatements</cite>, <cite>UnsignedColumns</cite>) have been moved to the
<cite>com.twitter.finagle.mysql.param</cite> namespace. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D242473</span></code></p></li>
<li><p>finagle-mysql: The deprecated <cite>c.t.f.m.Client.apply(factory, statsReceiver)</cite> method
has been removed. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D243038</span></code></p></li>
<li><p>finagle-mysql: The <cite>c.t.f.m.Handshake</cite> class and companion object have been made
private. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D244734</span></code></p></li>
<li><p>finagle-http: Rename the toggle ‘c.t.f.h.UseH2CClients’ to ‘c.t.f.h.UseH2CClients2’.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D247320</span></code></p></li>
</ul>
</section>
<section id="id187">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id187" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Upgrade to Netty 4.1.31.Final and netty-tcnative 2.0.19.Final. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D235402</span></code></p></li>
<li><p>finagle-base-http: The <cite>DefaultHeaderMap</cite> will replace <cite>obs-fold</cite> ( CRLF 1*(SP/HTAB) ) in
inserted header values. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D245928</span></code></p></li>
<li><p>finagle-core: <cite>MethodBuilder#idempotent</cite> and <cite>MethodBuilder#nonIdempotent</cite> will no longer
clobber <cite>MethodBuilder.withRetries.withClassifier</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D255275</span></code></p></li>
</ul>
</section>
</section>
<section id="id188">
<h2>18.11.0<a class="headerlink" href="#id188" title="Permalink to this headline">¶</a></h2>
<section id="id189">
<h3>New Features<a class="headerlink" href="#id189" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: Add <cite>Message.httpDateFormat(millis)</cite> to format the epoch millis into
an RFC 7231 formatted String representation. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D234867</span></code></p></li>
<li><p>finagle-core: Introduce a <cite>StackClient.withStack</cite> overload that
makes modifying the existing <cite>Stack</cite> easier when using method chaining.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D234739</span></code></p></li>
<li><p>finagle-mysql: Introduce <cite>session</cite> to be able to perform multiple operations that require
session state on a guaranteed single connection. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D219322</span></code></p></li>
<li><p>finagle-netty4: When using the native epoll transport, finagle now publishes the TCP window size
and number of retransmits based on the <cite>tcpInfo</cite> provided by from the channel.  These stats are
published with a debug verbosity level.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D218772</span></code></p></li>
<li><p>finagle-http: HTTP clients and servers now accept <cite>fixedLengthStreamedAfter</cite> param in their
<cite>withStreaming</cite> configuration (default: 5 MB when streaming is enabled). This new parameter
controls the limit after which Finagle will stop aggregating messages with known <cite>Content-Length</cite>
(payload will be available at <cite>.content</cite>) and switch into a streaming mode (payload will be
available at <cite>.reader</cite>). Note messages with <cite>Transfer-Encoding: chunked</cite> never aggregated.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D236573</span></code></p></li>
<li><p>finagle-thrift: <cite>tracing.thrift</cite> now has an optional timestamp field for a <cite>Span</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D242204</span></code></p></li>
<li><p>finagle-zipkin-core: A Span now encodes a timestamp of when it was created as part
of its thrift serialization. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D242204</span></code></p></li>
</ul>
</section>
<section id="id190">
<h3>Breaking API Changes<a class="headerlink" href="#id190" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: <cite>c.t.f.http.param.MaxChunkSize</cite> has been removed. There is no good reason to
configure it with anything but <cite>Int.MaxValue</cite> (unlimited). <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D233538</span></code></p></li>
<li><p>finagle-exp: Update <cite>DarkTrafficFilter#handleFailedInvocation</cite> to accept the request type
for more fidelity in handling the failure. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D237484</span></code></p></li>
</ul>
</section>
<section id="id191">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id191" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Unset <cite>maxChunkSize</cite> limit in Netty HTTP codecs. Now both clients and servers
emit all available data as a single chunk so we can put it into use quicker.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D233538</span></code></p></li>
<li><p>finagle-http: Streaming clients (<cite>withStreaming(true)</cite>) now aggregate inbound messages with known
<cite>Content-Length</cite> if their payloads are less than 5mb (8k before). Use <cite>withStreaming(true, 32.kb)</cite>
to override it with a different value. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D234882</span></code></p></li>
<li><p>finagle-http2: HTTP/2 servers perform a more graceful shutdown where an initial
GOAWAY is sent with the maximum possible stream id and waits for either the client
to hang up or for the close deadline, at which time a second GOAWAY is sent with
the true last processed stream and the connection is then closed.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D206683</span></code></p></li>
</ul>
</section>
<section id="id192">
<h3>Deprecations<a class="headerlink" href="#id192" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Deprecate
<cite>EndpointerStackClient.transformed(Stack[ServiceFactory[Req, Rep]] =&gt; Stack[ServiceFactory[Req, Rep]])</cite>
in favor of the <cite>withStack</cite> variant. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D234739</span></code></p></li>
</ul>
</section>
</section>
<section id="id193">
<h2>18.10.0<a class="headerlink" href="#id193" title="Permalink to this headline">¶</a></h2>
<section id="id194">
<h3>Deprecations<a class="headerlink" href="#id194" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Deprecation warnings have been removed from the ‘status’, ‘onClose’,
and ‘close’ methods on <cite>c.t.f.t.Transport</cite>, and added to the corresponding methods
on <cite>c.t.f.t.TransportContext</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D221528</span></code></p></li>
</ul>
</section>
<section id="id195">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id195" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-netty3: Implementations for ‘status’, ‘onClose’, and ‘close’ methods have
been moved from <cite>c.t.f.n.t.ChannelTransportContext</cite> to <cite>c.t.f.n.t.ChannelTransport</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D221528</span></code></p></li>
</ul>
</section>
</section>
<section id="id196">
<h2>18.9.1<a class="headerlink" href="#id196" title="Permalink to this headline">¶</a></h2>
<section id="id197">
<h3>Breaking API Changes<a class="headerlink" href="#id197" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: <cite>DefaultHeaderMap</cite> now validates HTTP Header names and
values in <cite>add</cite> and <cite>set</cite>. <cite>addUnsafe</cite> and <cite>setUnsafe</cite> have been created to
allow adding and setting headers without validation. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D217035</span></code></p></li>
<li><p>finagle-core: Remove slow host detection from <cite>ThresholdFailureDetector</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D210015</span></code></p></li>
</ul>
</section>
<section id="id198">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id198" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: When Finagle would exhaust a retry budget with an exception that was
not a <cite>FailureFlags</cite>, previously it would wrap that exception with a non-retryable
failure. This lead to surprising behavior for users. Those exceptions will no longer
be wrapped. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D216281</span></code></p></li>
<li><p>finagle-http: The finagle HTTP clients and servers now consider a <cite>Retry-After: 0</cite>
header to be a retryable nack. Servers will set this header when the response is
a retryable failure, and clients will interpret responses with this header as a
<cite>Failure.RetryableNackFailure</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D216539</span></code></p></li>
</ul>
</section>
</section>
<section id="id199">
<h2>18.9.0<a class="headerlink" href="#id199" title="Permalink to this headline">¶</a></h2>
<section id="id200">
<h3>New Features<a class="headerlink" href="#id200" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.FailureFlags</cite> is now a public API. This is Finagle’s
API for attaching metadata to an exception. As an example this is used to
check if an exception is known to be safe to retry. Java compatibility has
also been added. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D202374</span></code></p></li>
<li><p>finagle-core: Introducing StackTransformer, a consistent mechanism for
accessing and transforming the default ServerStack. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D207980</span></code></p></li>
<li><p>finagle-netty4: Allow sockets to be configured with the [SO_REUSEPORT](<a class="reference external" href="https://lwn.net/Articles/542629/">https://lwn.net/Articles/542629/</a>) option
when using native epoll, which allows multiple processes to bind and accept connections
from the same port. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D205535</span></code></p></li>
</ul>
</section>
<section id="id201">
<h3>Breaking API Changes<a class="headerlink" href="#id201" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: <cite>c.t.io.Reader</cite> and <cite>c.t.io.Writer</cite> are now abstracted over the type
they produce/consume (<cite>Reader[A]</cite> and <cite>Writer[A]</cite>) and are no longer fixed to <cite>Buf</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D195638</span></code></p></li>
<li><p>finagle-core: <cite>Address.hashOrdering</cite> now takes a seed parameter and
<cite>PeerCoordinate.setCoordinate</cite> does not take a <cite>peerOffset</cite> any longer.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D199545</span></code></p></li>
<li><p>finagle-core: Removed deprecated members <cite>c.t.f.Failure.{Interrupted, Ignorable, DeadlineExceeded,
Rejected, NonRetryable, flagsOf}</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D199361</span></code></p></li>
<li><p>finagle-core: SingletonPool now takes an additional parameter which indicates if interrupts
should propagate to the underlying resource. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D205433</span></code></p></li>
<li><p>finagle-core: Remove <cite>TimeoutFactory.Role</cite> in favor of passing a role to the <cite>module</cite> function.
Since this module is a re-used within the client stack, it needs unique identifiers for each
distinct module. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D204647</span></code></p></li>
<li><p>finagle-core: the valid range for the argument to <cite>WindowedPercentileHistogram.percentile</cite>
is now [0.0..1.0], e.g., 0.95 means 95th percentile. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D198915</span></code></p></li>
<li><p>finagle-mux: The old pull-based mux implementations have been removed. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D208737</span></code></p></li>
<li><p>finagle-netty3: The type of context of a <cite>ChannelTransport</cite> has been changed from a
<cite>LegacyContext</cite> to a <cite>ChannelTransportContext</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D205473</span></code></p></li>
<li><p>finagle-netty4: The type of context of a <cite>ChannelTransport</cite> has been changed from a
<cite>Netty4Context</cite> to a <cite>ChannelTransportContext</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D205794</span></code></p></li>
<li><p>finagle-netty4: <cite>c.t.f.netty4.param.useUnpoolledByteBufAllocator</cite> flag has been removed. There is
no good reason to opt-out of a more efficient, pooled allocator. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D212097</span></code></p></li>
<li><p>finagle-thrift: <cite>DeserializeCtx</cite> became <cite>ClientDeserializeCtx</cite> for client side response
classification, add <cite>ServerDeserializeCtx</cite> to handle server side response classification.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D196032</span></code></p></li>
<li><p>finagle-serversets: <cite>ZkMetadata.shardHashOrdering</cite> now takes a seed parameter.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D199545</span></code></p></li>
</ul>
</section>
<section id="id202">
<h3>Bug Fixes<a class="headerlink" href="#id202" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-thrift: Thrift clients created via <cite>.servicePerEndpoint</cite> now propagate exceptions
appropriately when the method return type is void. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D200690</span></code></p></li>
<li><p>finagle-thrift, finagle-thriftmux: Response classification is enabled in server side.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D196032</span></code></p></li>
</ul>
</section>
<section id="id203">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id203" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-memcached: A Memcached client (<cite>c.t.f.Memcached.Client</cite>) is now backed by a more efficient,
push-based implementation. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D208047</span></code></p></li>
<li><p>finagle-netty4: Finagle’s Netty 4 implementation now defaults to use Linux’s native epoll
transport, when available. Run with <cite>-com.twitter.finagle.netty4.useNativeEpoll=false</cite> to opt out.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D208088</span></code></p></li>
</ul>
</section>
</section>
<section id="id204">
<h2>18.8.0<a class="headerlink" href="#id204" title="Permalink to this headline">¶</a></h2>
<section id="id205">
<h3>New Features<a class="headerlink" href="#id205" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Introducing the new <cite>c.t.f.tracing.Tracing</cite> API for more efficient tracing
(dramatically reduces the number of context lookups; see scaladoc for <cite>c.t.f.tracing.Trace</cite>).
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D190670</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.tracing.Trace</cite> facade API now provides forwarding <cite>record</cite> methods for
all kinds of annotations and is a preffered way of recording traces. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D192598</span></code></p></li>
<li><p>finagle-thriftmux: Promote the push-based ThriftMux implementation out of experimental
status.``PHAB_ID=D189187``</p></li>
</ul>
</section>
<section id="id206">
<h3>Breaking API Changes<a class="headerlink" href="#id206" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: <cite>c.t.f.http.cookie.exp.supportSameSiteCodec</cite> has been moved out of the
exp package to <cite>c.t.f.http.cookie.supportSameSiteCodec</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D196517</span></code></p></li>
<li><p>finagle-core: Parameter-less annotation classes (<cite>c.t.f.tracing.Annotation</cite>) have been
promoted to objects for efficiency reasons.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D192598</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.tracing.Trace.record(Record)</cite> now accepts the record argument by
value (previously by name). <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D193300</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.Failure.{Restartable, Interrupted, Ignorable, DeadlineExceeded,
Wrapped, Rejected, NonRetryable}</cite> are deprecated in favor of the <cite>c.t.f.FailureFlags</cite>
analogs. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D195647</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.Leaf</cite> and <cite>c.t.f.Node</cite> are now private; use <cite>Stack.leaf</cite> and
<cite>Stack.node</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D195924</span></code></p></li>
<li><p>finagle-core: Marked <cite>transform</cite> in <cite>com.twitter.finagle.Stack</cite> as protected. It is too
powerful and unnecessary for users, and should be for implementor use only. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D195938</span></code></p></li>
<li><p>finagle-mysql: <cite>c.t.f.mysql.CanBeParameter</cite>’s implicit conversions <cite>timestampCanBeParameter</cite>,
<cite>sqlDateCanBeParameter</cite>, and <cite>javaDateCanBeParameter</cite> have been consolidated into a single
implicit, <cite>dateCanBeParameter</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D195351</span></code></p></li>
</ul>
</section>
<section id="id207">
<h3>Bug Fixes<a class="headerlink" href="#id207" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http2: Fixed a race condition caused by c.t.f.http.transport.StreamTransports being
closed, but that status not being reflected right away, causing a second request to fail.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D198198</span></code></p></li>
</ul>
</section>
<section id="id208">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id208" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.tracing.Trace</cite> API is no longer guarding <cite>Trace.record</cite> calls behind
<cite>Trace.isActivelyTracing</cite>. Add <cite>Trace.isActivelyTracing</cite> guards on the call sites if
materializing tracing annotations is a performance concern.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D193300</span></code></p></li>
<li><p>finagle-mysql: Clients will now issue a ROLLBACK each time a service is checked back
into the connection pool. This can be disabled via <cite>Mysql.Client.withNoRollback</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D196673</span></code></p></li>
<li><p>finagle-thriftmux: The push-based server muxer is now the default. In both synthetic tests
and production it has shown signifcant performance benefits and is simpler to maintain.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D193630</span></code></p></li>
<li><p>finagle-mysql: Remove deprecated <cite>TimestampValue.apply(Timestamp)</cite> and
<cite>TimestampValue.unapply(value)</cite> methods. Use <cite>TimestampValue.apply(TimeZone, TimeZone)</cite>
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D182920</span></code></p></li>
</ul>
</section>
<section id="id209">
<h3>Deprecations<a class="headerlink" href="#id209" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-mux: The pull based mux implementation, c.t.f.Mux, has been deprecated in favor of
the push-based mux implementation, c.t.f.pushsession.MuxPush. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D193630</span></code></p></li>
</ul>
</section>
</section>
<section id="id210">
<h2>18.7.0<a class="headerlink" href="#id210" title="Permalink to this headline">¶</a></h2>
<section id="id211">
<h3>New Features<a class="headerlink" href="#id211" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Promote the push-based API’s out of experimental. For protocols that
have eager read paths, for example multiplexed protocols and non-streaming clients,
a push-based protocol implementation can provide significant performance benefits
by avoiding the impedance mismatch between the underlying Netty framework and the
pull-based Transport model. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D189187</span></code></p></li>
<li><p>finagle-core: There is now an implicit instance for Finagle’s default timer:
<cite>DefaultTimer.Implicit</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D185896</span></code></p></li>
<li><p>finagle-core: Introduce new command-line flag <cite>c.t.f.tracing.enabled</cite> to entirely
disable/enable tracing for a given process (default: <cite>true</cite>).  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D186557</span></code></p></li>
<li><p>finagle-mux: Promote the push-based Mux implementation out of experimental status.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D189187</span></code></p></li>
<li><p>finagle-mysql: <cite>com.twitter.util.Time</cite> can now be used with
<cite>PreparedStatement`s without converting the `ctu.Time</cite> to a <cite>java.sql.Timestamp</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D182973</span></code></p></li>
<li><p>finagle-stats: Adds a lint rule to detect when metrics with colliding names are used.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D183494</span></code></p></li>
<li><p>finagle-core: Client side <cite>NackAdmissionFilter</cite> can now be configured more easily by
calling <cite>$client.withAdmissionControl.nackAdmissionControl(window, threshold)</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D188877</span></code></p></li>
<li><p>finagle-thrift: Trait c.t.scrooge.ThriftService is now c.t.finagle.thrift.ThriftService.
Scrooge generated service objects now all inherit from c.t.finagle.thrift.GeneratedThriftService.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D180341</span></code></p></li>
</ul>
</section>
<section id="id212">
<h3>Breaking API Changes<a class="headerlink" href="#id212" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.dispatch.ClientDispatcher.wrapWriteException</cite> has been turned from a
partial function instance into a static total function. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D189639</span></code></p></li>
<li><p>finagle-mux: <cite>ClientDiscardedRequestException</cite> now extends <cite>FailureFlags</cite> and is no longer
a case class. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D183456</span></code></p></li>
</ul>
</section>
<section id="id213">
<h3>Bug Fixes<a class="headerlink" href="#id213" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.filter.NackAdmissionFilter</cite> is now aware of <cite>FailureFlags</cite> encoded
failures. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D193390</span></code></p></li>
<li><p>finagle-mux: Mux’s server dispatcher is now aware of <cite>FailureFlags</cite> encoded failures.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D193456</span></code></p></li>
</ul>
</section>
<section id="id214">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id214" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Server-side rejections from <cite>c.t.f.filter.RequestSempahoreFilter.module</cite> are now
captured by <cite>c.t.f.service.StatsFilter</cite>. They will roll up under “/failures”,
“/failures/rejected”, and “/failures/restartable” in stats. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D187127</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.tracing.Trace.tracers</cite> now returns only distinct tracers stored in
the local context (returned all tracers before).  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D188389</span></code></p></li>
<li><p>finagle-http: HTTP param decoding is no longer truncated to 1024 params.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D190113</span></code></p></li>
<li><p>finagle-mux: When mux propagates an interrupt started by <cite>BackupRequestFilter</cite> over the
network, the <cite>FailureFlags.Ignorable</cite> status is propagated with it.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D183456</span></code></p></li>
</ul>
</section>
</section>
<section id="id215">
<h2>18.6.0<a class="headerlink" href="#id215" title="Permalink to this headline">¶</a></h2>
<section id="id216">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id216" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: By default, the deterministic aperture load balancer doesn’t expand
based on the loadband. This is because the loadband is influenced by a degree of
randomness, and this breaks the deterministic part of deterministic aperture and
can lead to aggressive banding on backends. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D180922</span></code></p></li>
<li><p>finagle-http2: Unprocessed streams are retryable in case of GOAWAY.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D174401</span></code></p></li>
</ul>
</section>
<section id="id217">
<h3>New Features<a class="headerlink" href="#id217" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-core: Add <cite>PropagateDeadlines</cite> <cite>Stack.Param</cite> to <cite>TimeoutFilter</cite> for
disabling propagation of deadlines to outbound requests.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D168405</span></code></p></li>
<li><p>finagle-core: Add <cite>toString</cite> implementations to <cite>c.t.finagle.Service</cite> and
<cite>c.t.finagle.Filter</cite>. Update in <cite>Filter#andThen</cite> composition to expose a
useful <cite>toString</cite> for composed Filters and a composed Service (a Filter chain
with a terminal Service or ServiceFactory).</p>
<p>The default implementation for <cite>Filter</cite> and <cite>Service</cite> is <cite>getClass.getName</cite>. When
composing filters, the <cite>andThen</cite> composition method correctly tracks the composed
parts to produce a useful <cite>toString</cite>, e.g.,</p>
</li>
</ul>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">package</span> <span class="nn">com</span><span class="p">.</span><span class="n">foo</span>

<span class="k">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">twitter</span><span class="p">.</span><span class="nn">finagle</span><span class="p">.{</span><span class="nc">Filter</span><span class="p">,</span> <span class="nc">Service</span><span class="p">}</span>
<span class="k">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">twitter</span><span class="p">.</span><span class="nn">util</span><span class="p">.</span><span class="nc">Future</span>

<span class="k">class</span> <span class="nc">MyFilter1</span> <span class="k">extends</span> <span class="nc">Filter</span><span class="p">[</span><span class="nc">Int</span><span class="p">,</span> <span class="nc">Int</span><span class="p">,</span> <span class="nc">Int</span><span class="p">,</span> <span class="nc">Int</span><span class="p">]</span> <span class="p">{</span>
   <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span> <span class="n">service</span><span class="p">:</span> <span class="nc">Service</span><span class="p">[</span><span class="nc">Int</span><span class="p">,</span> <span class="nc">Int</span><span class="p">]):</span> <span class="nc">Future</span><span class="p">[</span><span class="nc">Int</span><span class="p">]</span> <span class="o">=</span> <span class="o">???</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">package</span> <span class="nn">com</span><span class="p">.</span><span class="n">foo</span>

<span class="k">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">twitter</span><span class="p">.</span><span class="nn">finagle</span><span class="p">.{</span><span class="nc">Filter</span><span class="p">,</span> <span class="nc">Service</span><span class="p">}</span>
<span class="k">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">twitter</span><span class="p">.</span><span class="nn">util</span><span class="p">.</span><span class="nc">Future</span>

<span class="k">class</span> <span class="nc">MyFilter2</span> <span class="k">extends</span> <span class="nc">Filter</span><span class="p">[</span><span class="nc">Int</span><span class="p">,</span> <span class="nc">Int</span><span class="p">,</span> <span class="nc">Int</span><span class="p">,</span> <span class="nc">Int</span><span class="p">]</span> <span class="p">{</span>
  <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span> <span class="n">service</span><span class="p">:</span> <span class="nc">Service</span><span class="p">[</span><span class="nc">Int</span><span class="p">,</span> <span class="nc">Int</span><span class="p">]):</span> <span class="nc">Future</span><span class="p">[</span><span class="nc">Int</span><span class="p">]</span> <span class="o">=</span> <span class="o">???</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span> <span class="n">filters</span> <span class="o">=</span> <span class="p">(</span><span class="k">new</span> <span class="nc">MyFilter1</span><span class="p">).</span><span class="n">andThen</span><span class="p">(</span><span class="k">new</span> <span class="nc">MyFilter2</span><span class="p">)</span>
</pre></div>
</div>
<p><cite>filters.toString</cite> would emit the String “com.foo.MyFilter1.andThen(com.foo.MyFilter2)”</p>
<p>If a Service (or ServiceFactory) were then added:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">twitter</span><span class="p">.</span><span class="nn">finagle</span><span class="p">.{</span><span class="nc">Filter</span><span class="p">,</span> <span class="nc">Service</span><span class="p">}</span>
<span class="k">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">twitter</span><span class="p">.</span><span class="nn">finagle</span><span class="p">.</span><span class="nn">service</span><span class="p">.</span><span class="nc">ConstantService</span>
<span class="k">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">twitter</span><span class="p">.</span><span class="nn">util</span><span class="p">.</span><span class="nc">Future</span>

<span class="p">...</span>

<span class="kd">val</span> <span class="n">svc</span><span class="p">:</span> <span class="nc">Service</span><span class="p">[</span><span class="nc">Int</span><span class="p">,</span> <span class="nc">Int</span><span class="p">]</span> <span class="o">=</span> <span class="n">filters</span><span class="p">.</span><span class="n">andThen</span><span class="p">(</span><span class="k">new</span> <span class="nc">ConstantService</span><span class="p">[</span><span class="nc">Int</span><span class="p">,</span> <span class="nc">Int</span><span class="p">](</span><span class="nc">Future</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
<p>Then, <cite>svc.toString</cite> would thus return the String:
“com.foo.MyFilter1.andThen(com.foo.MyFilter2).andThen(com.twitter.finagle.service.ConstantService(ConstFuture(2)))”</p>
<p>Filter implementations are permitted to override their <cite>toString</cite> implementations which would
replace the default of <cite>getClass.getName</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D172526</span></code></p>
<ul class="simple">
<li><p>finagle-core: Make <cite>Filter.TypeAgnostic</cite> an abstract class for Java usability.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D172716</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.filter.NackAdmissionFilter</cite> is now public. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D177322</span></code></p></li>
<li><p>finagle-core: Extended <cite>c.t.f.ssl.KeyCredentials</cite> and <cite>c.t.f.ssl.TrustCredentials</cite> to work
with <cite>javax.net.ssl.KeyManagerFactory</cite> and <cite>javax.net.ssl.TrustManagerFactory</cite> respectively.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D177484</span></code></p></li>
</ul>
</section>
<section id="id218">
<h3>Breaking API Changes<a class="headerlink" href="#id218" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Rename <cite>DeadlineFilter.Param(maxRejectFraction)</cite> to
<cite>DeadlineFilter.MaxRejectFraction(maxRejectFraction)</cite> to reduce confusion
when adding additional params.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D172402</span></code></p></li>
</ul>
</section>
<section id="id219">
<h3>Bug Fixes<a class="headerlink" href="#id219" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http2: <cite>StreamTransportFactory</cite> now marks itself as dead/closed when it runs out of
HTTP/2 stream IDs instead of stalling. This allows the connection to be closed/reestablished in
accordance with the spec <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D175898</span></code></p></li>
<li><p>finagle-netty4: <cite>SslServerSessionVerifier</cite> is now supplied with the proper peer address
rather than <cite>Address.failing</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D168334</span></code></p></li>
<li><p>finagle-thrift/thriftmux: Disabled client side per-endpoint stats by default for client
ServicePerEndpoint. It can be set via <cite>c.t.f.thrift.RichClientParam</cite> or a <cite>with</cite>-method
as <cite>Thrift{Mux}.client.withPerEndpointStats</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D169427</span></code></p></li>
<li><p>finagle-netty4: Avoid NoClassDefFoundError if netty-transport-native-epoll is not available
on the classpath.</p></li>
</ul>
</section>
</section>
<section id="id220">
<h2>18.5.0<a class="headerlink" href="#id220" title="Permalink to this headline">¶</a></h2>
<section id="id221">
<h3>New Features<a class="headerlink" href="#id221" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: Added ability to add SameSite attribute to Cookies to
comply with <a class="reference external" href="https://tools.ietf.org/html/draft-west-first-party-cookies-07">https://tools.ietf.org/html/draft-west-first-party-cookies-07</a>.
The attribute may be set in the constructor via the <cite>c.t.f.http.Cookie</cite>
<cite>sameSite</cite> param or via the <cite>c.t.f.http.Cookie.sameSite</cite> method. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D157942</span></code></p>
<ul>
<li><p>Pass <cite>SameSite.Lax</cite> to the <cite>Cookie</cite> to add the “Lax” attribute.</p></li>
<li><p>Pass <cite>SameSite.Strict</cite> to the <cite>Cookie</cite> to add the “Strict” attribute.</p></li>
</ul>
</li>
<li><p>finagle-base-http: Introduced an API to extract query string params from a
<cite>c.t.f.http.Request</cite>, <cite>c.t.f.http.Uri.fromRequest</cite> and <cite>c.t.f.http.Uri#params</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D160298</span></code></p></li>
<li><p>finagle-mysql: Added APIs to <cite>Row</cite> which simplify the common access pattern.
For example, <cite>Row.stringOrNull(columnName: String): String</cite> and
<cite>Row.getString(columnName: String): Option[String]</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D156926</span></code>, <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D157360</span></code></p></li>
<li><p>finagle-mysql: Added <cite>read</cite> and <cite>modify</cite> APIs to <cite>c.t.f.mysql.Client</cite> and
<cite>c.t.f.mysql.PreparedStatement</cite> for that return the specific type of
<cite>Result</cite> for those operations, <cite>ResultSet</cite> and <cite>OK</cite> respectively.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D160215</span></code></p></li>
<li><p>finagle-serversets: Zk2Session’s AsyncSemaphore which controls the maximum
concurrent Zk operations is configurable (GlobalFlag c.t.f.serverset2.zkConcurrentOperations).
<code class="docutils literal notranslate"><span class="pre">`PHAB_ID=D157709`</span></code></p></li>
<li><p>finagle-mysql: Address <cite>CursoredStatement</cite> usability from Java via
<cite>CursoredStatement.asJava()</cite>. Through this, you can use the API with
varargs and Java 8 lambdas. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D158399</span></code></p></li>
<li><p>finagle-toggle: Improved Java compatibility for <cite>ToggleMap</cite> and <cite>Toggle</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D164489</span></code></p></li>
<li><p>finagle-toggle: <cite>StandardToggleMap.apply</cite> and <cite>StandardToggleMap.registeredLibraries</cite> now
use <cite>ToggleMap.Mutable</cite> to better support mutating the underlying mutable <cite>ToggleMap</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D167046</span></code></p></li>
</ul>
</section>
<section id="id222">
<h3>Breaking API Changes<a class="headerlink" href="#id222" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-mux: With the introduction of the push-based mux client, we’ve
removed the need for the optimized <cite>c.t.f.Mux.Netty4RefCountingControl</cite>
MuxImpl, which has been removed. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D141010</span></code></p></li>
<li><p>finagle-mysql: <cite>c.t.f.mysql.Client.ping</cite> now returns a <cite>Future[Unit]</cite>
instead of the broad <cite>Future[Result]</cite> ADT. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D160215</span></code></p></li>
<li><p>finagle-toggle: Changed <cite>ToggleMap.Mutable</cite> from a trait to an abstract class, and
<cite>ToggleMap.Proxy</cite> no longer extends <cite>ToggleMap</cite>, but now has a self-type that conforms to
<cite>ToggleMap</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D164489</span></code></p></li>
</ul>
</section>
<section id="id223">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id223" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Add <cite>c.t.f.SslException</cite> to better model exceptions related to SSL/TLS.
The <cite>c.t.f.ChannelException.apply</cite> method will now wrap <cite>javax.net.ssl.SSLException`s in
`c.t.f.SslException</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D158344</span></code></p></li>
<li><p>finagle-core: MethodBuilder metrics now include failures.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D167589</span></code>, <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D168095</span></code></p></li>
<li><p>finagle-http: ServerAdmissionControl is circumvented for HTTP requests that have
a body unless the request contains the header ‘finagle-http-retryable-request’ since
it cannot be known whether the client can actually retry them, potentially resulting
in depressed success rates during periods of throttling. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D134209</span></code></p></li>
<li><p>finagle-http2: Clients and servers no longer attempt a cleartext upgrade if the
first request of the HTTP/1.1 session has a body. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D153986</span></code></p></li>
<li><p>finagle-thriftmux: The push-based client muxer is now the default muxer implementation.
The push-based muxer has better performance and a simpler architecture. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D158134</span></code></p></li>
<li><p>finagle-toggle: <cite>ToggleMap.Proxy#underlying</cite> is now public, and <cite>ToggleMap.Proxy</cite>
participates in <cite>ToggleMap.components</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D167046</span></code></p></li>
</ul>
</section>
<section id="id224">
<h3>Bug Fixes<a class="headerlink" href="#id224" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: Concurrent modification of the <cite>c.t.f.http.DefaultHeaderMap</cite> could
result in an infinite loop due to HashMap corruption. Access is now synchronized to avoid
the infinite loop. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D159250</span></code></p></li>
<li><p>finagle-core: <cite>FailureFlags</cite> that have their flags set modified will now
retain the original stack trace, suppressed Throwables, and cause when possible.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D160402</span></code></p></li>
<li><p>finagle-memcached: Added the missing support for partial success for the batch
operations in the new PartitioningService based Memcached client. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D161249</span></code></p></li>
<li><p>finagle-thrift: Removed copied libthrift files. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D165455</span></code></p></li>
<li><p>finagle-thrift/thriftmux: Server side per-endpoint statsFilter by default is disabled now.
It can be set via <cite>c.t.f.thrift.RichServerParam</cite> or a <cite>with</cite>-method as
<cite>Thrift{Mux}.server.withPerEndpointStats</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D167433</span></code></p></li>
</ul>
</section>
</section>
<section id="id225">
<h2>18.4.0<a class="headerlink" href="#id225" title="Permalink to this headline">¶</a></h2>
<section id="id226">
<h3>New Features<a class="headerlink" href="#id226" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.filter.NackAdmissionFilter</cite> can now be disabled via a <cite>with</cite>-method.
<cite>$Protocol.client.withAdmissionControl.noNackAdmissionControl</cite> <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D146873</span></code></p></li>
<li><p>finagle-mysql: Exceptions now include the SQL that was being executed when possible.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D150503</span></code></p></li>
<li><p>finagle-mysql: Address <cite>PreparedStatement</cite> usability from Java via
<cite>PreparedStatement.asJava()</cite>. Through this, you can use the API with
varargs and Java 8 lambdas. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D156755</span></code></p></li>
<li><p>finagle-mysql: Added support for <cite>Option</cite>s to <cite>Parameter</cite> implicits. This
allows for the natural representation of nullable columns with an <cite>Option</cite>
where a <cite>None</cite> is treated as a <cite>null</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D156186</span></code></p></li>
<li><p>finagle-netty4: Add ‘tls/connections’ gauge for Finagle on Netty 4 which tracks the number
of open SSL/TLS connections per Finagle client or server.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D144184</span></code></p></li>
<li><p>finagle-redis: Support has been added for a number of new cluster commands
introduced in Redis 3.0.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D152186</span></code></p></li>
</ul>
</section>
<section id="id227">
<h3>Bug Fixes<a class="headerlink" href="#id227" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-mysql: Fix handling of interrupts during transactions. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D154441</span></code></p></li>
</ul>
</section>
<section id="id228">
<h3>Breaking API Changes<a class="headerlink" href="#id228" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.ssl.client.HostnameVerifier</cite> has been removed since it was using
<cite>sun.security.util.HostnameChecker</cite> which is no longer accessible in JDK 9.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D144149</span></code></p></li>
<li><p>finagle-thrift: Upgraded libthrift to 0.10.0, <cite>c.t.f.thrift.Protocols.TFinagleBinaryProtocol</cite>
constructor now takes <cite>stringLengthLimit</cite> and <cite>containerLengthLimit</cite>, <cite>NO_LENGTH_LIMIT</cite> value
changed from 0 to -1. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D124620</span></code></p></li>
<li><p>finagle-thrift: Move “stateless” methods in <cite>c.t.finagle.thrift.ThriftRichClient</cite>
to <cite>c.t.finagle.thrift.ThriftClient</cite>. Then mix the <cite>ThriftClient</cite> trait into the
ThriftMux and Thrift Client companions to make it clearer that these stateless methods
are not affected by the changing state of the configured client instance but are instead
simply utility methods which convert or wrap the incoming argument. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D143185</span></code></p></li>
<li><p>finagle-base-http: Removed deprecated <cite>c.t.f.Cookie.value_=</cite>; use <cite>c.t.f.Cookie.value</cite>
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D148266</span></code></p></li>
<li><p>finagle-base-http: Removed deprecated <cite>c.t.f.Cookie.domain_=</cite>; use <cite>c.t.f.Cookie.domain</cite>
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D148266</span></code></p></li>
<li><p>finagle-base-http: Removed deprecated <cite>c.t.f.Cookie.path_=</cite>; use <cite>c.t.f.Cookie.path</cite>
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D148266</span></code></p></li>
</ul>
</section>
<section id="id229">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id229" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Add minimum request threshold for <cite>successRateWithinDuration</cite> failure accrual.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D154129</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.filter.NackAdmissionFilter</cite> no longer takes effect when
the client’s request rate is too low to accurately update the EMA value or
drop requests. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D143996</span></code></p></li>
<li><p>finagle-core: SSL/TLS client hostname verification is no longer performed by
<cite>c.t.f.ssl.client.HostnameVerifier</cite>. The same underlying library
<cite>sun.security.util.HostnameChecker</cite> is used to perform the hostname verification.
However it now occurs before the SSL/TLS handshake has been completed, and the
exception on failure has changes from a <cite>c.t.f.SslHostVerificationException</cite> to a
<cite>javax.net.ssl.CertificateException</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D144149</span></code></p></li>
<li><p>finagle-core: Closing <cite>c.t.f.NullServer</cite> is now a no-op. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D156098</span></code></p></li>
<li><p>finagle-netty4: Netty ByteBuf leak tracking is enabled by default. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D152828</span></code></p></li>
</ul>
</section>
<section id="id230">
<h3>Deprecations<a class="headerlink" href="#id230" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-thrift: System property “-Dorg.apache.thrift.readLength” is deprecated. Use
constructors to set read length limit for TBinaryProtocol.Factory and TCompactProtocol.Factory.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D124620</span></code></p></li>
</ul>
</section>
</section>
<section id="id231">
<h2>18.3.0<a class="headerlink" href="#id231" title="Permalink to this headline">¶</a></h2>
<section id="id232">
<h3>New Features<a class="headerlink" href="#id232" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.client.BackupRequestFilter.filterService</cite> for wrapping raw services in a
<cite>c.t.f.client.BackupRequestFilter</cite> is now public. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D135484</span></code></p></li>
<li><p>finagle-core: Introduce <cite>c.t.f.Stacks.EMPTY_PARAMS</cite> for getting an empty Param map from
Java, and <cite>c.t.f.Stack.Params.plus</cite> for easily adding Params to a Param map from Java.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D139660</span></code></p></li>
</ul>
</section>
<section id="id233">
<h3>Bug Fixes<a class="headerlink" href="#id233" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.liveness.FailureAccrualFactory</cite> takes no action on <cite>c.t.f.Failure.Ignorable</cite>
responses. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D135435</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.pool.WatermarkPool</cite> is resilient to multiple closes on a service instance.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D137198</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.pool.CachingPool</cite> service wrapper instances are resilient to multiple closes.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D136781</span></code></p></li>
<li><p>finagle-core: Requeue module now closes sessions it prevented from propagating up the stack.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D142457</span></code></p></li>
<li><p>finagle-base-http: <cite>c.t.f.http.Netty4CookieCodec.encode</cite> now wraps Cookie values that would
be wrapped in <cite>c.t.f.http.Netty3CookieCodec.encode</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D134566</span></code></p></li>
<li><p>finagle-base-http: <cite>c.t.f.http.Cookie.maxAge</cite> returns <cite>c.t.f.http.Cookie.DefaultMaxAge</cite>
(instead of null) if maxAge has been set to null or None in the copy constructor
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D138393</span></code>.</p></li>
<li><p>finagle-http: The HTTP client will not attempt to retry nacked requests with streaming
bodies since it is likely that at least part of the body was already consumed and therefore
it isn’t safe to retry. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D136053</span></code></p></li>
</ul>
</section>
<section id="id234">
<h3>Breaking API Changes<a class="headerlink" href="#id234" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: Removed <cite>c.t.f.http.Cookie.comment_</cite>, <cite>c.t.f.http.Cookie.comment_=</cite>,
<cite>c.t.f.http.Cookie.commentUrl_</cite>, and <cite>c.t.f.http.Cookie.commentUrl_=</cite>. <cite>comment</cite> and <cite>commentUrl</cite>
per RFC-6265. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D137538</span></code></p></li>
<li><p>finagle-base-http: Removed deprecated <cite>c.t.f.http.Cookie.isDiscard</cite> and
<cite>c.t.f.http.Cookie.isDiscard_=</cite>, per RFC-6265. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D138109</span></code></p></li>
<li><p>finagle-base-http: Removed deprecated <cite>c.t.f.http.Cookie.ports</cite> and
<cite>c.t.f.http.Cookie.ports_=</cite>, per RFC-6265. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D139243</span></code></p></li>
<li><p>finagle-base-http: <cite>c.t.f.http.RequestBuilder</cite> has been moved to the finagle-http target
and the implicit evidence, <cite>RequestConfig.Yes</cite> has been renamed to <cite>RequestBuilder.Valid</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D122227</span></code></p></li>
<li><p>finagle-base-http: Removed deprecated <cite>c.t.f.Cookie.isSecure</cite>; use <cite>c.t.f.Cookie.secure</cite>
instead. Removed deprecated <cite>c.t.f.Cookie.isSecure_=</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D140435</span></code></p></li>
<li><p>finagle-base-http: Removed deprecated <cite>c.t.f.http.Cookie.version</cite> and
<cite>c.t.f.http.Cookie.version_=</cite>, per RFC-6265. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D142672</span></code></p></li>
<li><p>finagle-base-http: Removed deprecated <cite>c.t.f.Cookie.httpOnly_=</cite>; use <cite>c.t.f.Cookie.httpOnly</cite>
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D143177</span></code></p></li>
<li><p>finagle-base-http: Removed deprecated <cite>c.t.f.Cookie.maxAge_=</cite>; use <cite>c.t.f.Cookie.maxAge</cite>
instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D143177</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.pool.WatermarkPool</cite> was finalized. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D137198</span></code></p></li>
<li><p>finagle-core: <cite>c.t.finagle.ssl.Ssl</cite> and related classes have been
removed. They were replaced as the primary way of using SSL/TLS
within Finagle in release 6.44.0 (April 2017). Please migrate to using
<cite>c.t.f.ssl.client.SslClientEngineFactory</cite> or
<cite>c.t.f.ssl.server.SslServerEngineFactory</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D135908</span></code></p></li>
<li><p>finagle-core: Removed <cite>newSslEngine</cite> and <cite>newFinagleSslEngine</cite> from
<cite>ServerBuilder</cite>. Please implement a class which extends
<cite>c.t.f.ssl.server.SslServerEngineFactory</cite> with the previously passed in
function used as the implementation of the <cite>apply</cite> method. Then use the
created engine factory with one of the <cite>tls</cite> methods instead.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D135908</span></code></p></li>
<li><p>finagle-core: The deprecated <cite>c.t.f.loadbalancer.DefaultBalancerFactory</cite> has been removed.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D139814</span></code></p></li>
<li><p>finagle-exp: The deprecated <cite>c.t.f.exp.BackupRequestFilter</cite> has been removed. Please use
<cite>c.t.f.client.BackupRequestFilter</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D143333</span></code></p></li>
<li><p>finagle-http: Removed the <cite>c.t.f.Http.Netty3Impl</cite>. Netty4 is now the only
underlying HTTP implementation available. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D136705</span></code></p></li>
<li><p>finagle-zipkin-scribe: Renamed the finagle-zipkin module to finagle-zipkin-scribe, to
better advertise that this is just the scribe implementation, instead of the default.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D141940</span></code></p></li>
</ul>
</section>
</section>
<section id="id235">
<h2>18.2.0<a class="headerlink" href="#id235" title="Permalink to this headline">¶</a></h2>
<section id="id236">
<h3>New Features<a class="headerlink" href="#id236" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Add orElse to allow composition of <cite>FailureAccrualPolicy`s.
``PHAB_ID=D131156`</cite></p></li>
<li><p>finagle-core: <cite>c.t.f.http.MethodBuilder</cite> now exposes a method <cite>newService</cite> without a
<cite>methodName</cite> to create a client. <cite>c.t.f.thriftmux.MethodBuilder</cite> now exposes a
method <cite>servicePerEndpoint</cite> without a <cite>methodName</cite> to create a client. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D131809</span></code></p></li>
<li><p>finagle-thriftmux: Expose the underlying configured client <cite>label</cite> in the
<cite>c.t.finagle.thriftmux.MethodBuilder</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D129109</span></code></p></li>
</ul>
</section>
<section id="id237">
<h3>Bug Fixes<a class="headerlink" href="#id237" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http2: http2 servers no longer leak ping bodies. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D130503</span></code></p></li>
</ul>
</section>
<section id="id238">
<h3>Deprecations<a class="headerlink" href="#id238" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.finagle.ssl.Ssl</cite> and related classes have been
deprecated. They were replaced as the primary way of using SSL/TLS
within Finagle in release 6.44.0 (April 2017). Please migrate to using
<cite>c.t.f.ssl.client.SslClientEngineFactory</cite> or
<cite>c.t.f.ssl.server.SslServerEngineFactory</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D129692</span></code></p></li>
</ul>
</section>
<section id="id239">
<h3>Breaking API Changes<a class="headerlink" href="#id239" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: <cite>c.t.f.h.codec.HttpCodec</cite> has been moved to the <cite>finagle-http</cite>
project. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D116364</span></code></p></li>
<li><p>finagle base-http: <cite>c.t.f.h.Request.multipart</cite> has been removed.
Use <cite>c.t.f.h.exp.MultipartDecoder</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D129158</span></code></p></li>
<li><p>finagle-http: Split the toggle ‘c.t.f.h.UseH2C’ into a client-side toggle and a
server-side toggle, named ‘c.t.f.h.UseH2CClients’, and ‘c.t.f.h.UseH2CServers’,
respectively.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D130988</span></code></p></li>
</ul>
</section>
<section id="id240">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id240" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Finagle clients with retry budgets or backoffs should no
longer have infinite hash codes. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D128594</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.l.Balancer</cite> no longer uses a <cite>c.t.f.u.Updater</cite> as its underlying
concurrency primitive as it was found that in practice coalescing updates almost never
happens and in the absence of that <cite>Updater</cite> imposes more overhead than simple
synchronization while complicating the result of calling <cite>rebuild()</cite> since we don’t know
if the rebuild actually occurred by the time we attempt to use the distributor again.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D126486</span></code></p></li>
</ul>
</section>
</section>
<section id="id241">
<h2>18.1.0<a class="headerlink" href="#id241" title="Permalink to this headline">¶</a></h2>
<section id="id242">
<h3>New Features<a class="headerlink" href="#id242" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>FailureDetector</cite> has a new method, <cite>onClose</cite>, which provides
a Future that is satisfied when the <cite>FailureDetector</cite> marks a peer as Closed.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D126840</span></code></p></li>
<li><p>finagle-core: Introduce trace logging of requests as they flow through a
Finagle client or server. These logs can be turned on at runtime by setting
the “com.twitter.finagle.request.Logger” logger to trace level.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D124352</span></code></p></li>
<li><p>finagle-http2: HTTP/2 clients now expose the number of currently opened streams under
the <cite>$client/streams</cite> gauge. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D127238</span></code></p></li>
<li><p>finagle-http2: HTTP/2 servers now expose the number of currently opened streams under
the <cite>$server/streams</cite> gauge. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D127667</span></code></p></li>
<li><p>finagle-memcached: By default, the Memcached client now creates two connections
to each endpoint, instead of 4. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D119619</span></code></p></li>
<li><p>finagle-redis: Add support for redis Geo Commands. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D123167</span></code> based on the PR
<a class="reference external" href="https://github.com/twitter/finagle/pull/628">https://github.com/twitter/finagle/pull/628</a> written by Mura-Mi [<a class="reference external" href="https://github.com/Mura-Mi">https://github.com/Mura-Mi</a>]</p></li>
<li><p>finagle-thrift: Add <cite>c.t.f.thrift.service.ThriftServiceBuilder</cite> and
<cite>c.t.f.thrift.service.ReqRepThriftServiceBuilder</cite> for backwards compatibility
of creating higher-kinded method-per-endpoint clients. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D127538</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.http.MethodBuilder</cite> and <cite>c.t.f.thriftmux.MethodBuilder</cite> now
expose <cite>idempotent</cite> and <cite>nonIdempotent</cite> methods, which can be used to configure
retries and the sending of backup requests. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D122087</span></code></p></li>
</ul>
</section>
<section id="id243">
<h3>Bug Fixes<a class="headerlink" href="#id243" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-mysql: Fix a bug with transactions where an exception during a rollback
could leave the connection with a partially committed transaction. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D122771</span></code></p></li>
<li><p>finagle-toggle: <cite>c.t.f.toggle.Toggle`s are independent; that is, applying the same value to
two different toggles with the same fraction will produce independent true/false
values. ``PHAB_ID=D128172`</cite></p></li>
</ul>
</section>
<section id="id244">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id244" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core, finagle-netty4: When creating engines, SslClientEngineFactories now use
<cite>SslClientEngineFactory.getHostString</cite> instead of <cite>SslClientEngineFactory.getHostname</cite>.
This no longer performs an unnecessary reverse lookup when a hostname is not supplied
as part of the <cite>SslClientConfiguration</cite>.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D124369</span></code></p></li>
<li><p>finagle-http2: Supplies a dependency on io.netty.netty-tcnative-boringssl-static,
which adds support for ALPN, which is necessary for encrypted http/2.  To use a
different static ssl dependency, exclude the tcnative-boringssl dependency and
manually depend on the one you want to use. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D119555</span></code></p></li>
</ul>
</section>
<section id="id245">
<h3>Breaking API Changes<a class="headerlink" href="#id245" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http, finagle-http: Removed Apache Commons Lang dependency,
<cite>org.apache.commons.lang3.time.FastDateFormat</cite> now is <cite>java.time.format.DateTimeFormatter</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D121479</span></code></p></li>
<li><p>finagle-base-http: <cite>c.t.f.http.Message.headerMap</cite> is now an abstract method.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D120931</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.ssl.server.SslServerSessionVerifier</cite> no longer uses the unauthenticated
host information from <cite>SSLSession</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D124815</span></code></p></li>
<li><p>finagle-memcached: <cite>ConcurrentLoadBalancerFactory</cite> was removed and its behavior
was replaced by a Stack.Param inside finagle-core’s <cite>LoadBalancerFactory</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D119394</span></code></p></li>
<li><p>finagle-netty4: <cite>Netty4ClientEngineFactory</cite> and <cite>Netty4ServerEngineFactory</cite> were finalized.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D128708</span></code></p></li>
<li><p>finagle-thrift, finagle-thriftmux: Remove <cite>ReqRep</cite> specific methods. Since the “ReqRep”
builders are now subclasses of their non-“ReqRep” counterparts their is no longer a
need to expose “ReqRep” specific methods. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D123341</span></code></p></li>
</ul>
</section>
<section id="id246">
<h3>Deprecations<a class="headerlink" href="#id246" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-exp: <cite>c.t.f.exp.BackupRequestFilter</cite> has been deprecated. Please use
<cite>c.t.f.client.BackupRequestFilter</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D122344</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.http.Request.multipart</cite> has been deprecated.
Use <cite>c.t.f.http.exp.MultipartDecoder</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D126013</span></code></p></li>
</ul>
</section>
</section>
<section id="id247">
<h2>17.12.0<a class="headerlink" href="#id247" title="Permalink to this headline">¶</a></h2>
<section id="id248">
<h3>New Features<a class="headerlink" href="#id248" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Expose Tunables for MethodBuilder timeout configuration. Update
the http.MethodBuilder and thriftmux.MethodBuilder to accept Tunables for
configuring total and per-request timeouts. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D118114</span></code></p></li>
<li><p>finagle-thrift, finagle-thriftmux: Add support for Scrooge
<cite>ReqRepServicePerEndpoint</cite> functionality. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D107397</span></code></p></li>
<li><p>finagle-thriftmux: Add support for Scrooge <cite>ServicePerEndpoint</cite> and
<cite>ReqRepServicePerEndpoint</cite> functionality to <cite>thriftmux.MethodBuilder</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D116081</span></code></p></li>
</ul>
</section>
<section id="id249">
<h3>Breaking API Changes<a class="headerlink" href="#id249" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: Remove deprecated <cite>[Request|Response].[encode|decode][Bytes|String]</cite>
methods. Use c.t.f.h.codec.HttpCodec methods instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D116350</span></code></p></li>
<li><p>finagle-memcached: <cite>ConcurrentLoadBalancerFactory</cite> was removed and its behavior
was replaced by a Stack.Param inside finagle-core’s <cite>LoadBalancerFactory</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D119394</span></code></p></li>
<li><p>finagle-serversets: Removed Guava dependency which broke some APIs. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D119555</span></code></p>
<ul>
<li><p><cite>c.t.f.common.zookeeper.ServerSets.TO_ENDPOINT</cite> is now a <cite>java.util.function.Function</cite>.</p></li>
<li><p><cite>c.t.f.common.net.pool.DynamicHostSet.HostChangeMonitor.onChange</cite> now takes a <cite>java.util.Set</cite>.</p></li>
<li><p><cite>c.t.f.common.zookeeper.ZooKeeperUtils.OPEN_ACL_UNSAFE</cite> is is now a <cite>java.util.List</cite>.</p></li>
<li><p><cite>c.t.f.common.zookeeper.ZooKeeperUtils.EVERYONE_READ_CREATOR_ALL</cite> is is now a <cite>java.util.List</cite>.</p></li>
<li><p><cite>c.t.f.common.zookeeper.ZooKeeperClient</cite> constructor now takes a <cite>java.util.Optional</cite>.</p></li>
</ul>
</li>
<li><p>finagle-thrift: Move <cite>ThriftRichClient</cite> and <cite>ThriftRichServer</cite> to
<cite>c.t.finagle.thrift</cite> package. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D115284</span></code></p></li>
</ul>
</section>
<section id="id250">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id250" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Remove <cite>NackAdmissionControl</cite> from the default client stack.
Add it to the finagle-{http,mux} client stacks; note that it is added to
finagle-http2 via finagle-http and finagle-thriftmux via finalge-mux. It is
no longer part of the finagle-{memcached,mysql,redis} client stacks.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D116722</span></code></p></li>
<li><p>finagle-core: The “pipelining/pending” stat has been removed from protocols
using <cite>c.t.f.dispatch.PipeliningClientDispatcher</cite>. Refer to the “pending” stat
for the number of outstanding requests. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D113424</span></code></p></li>
<li><p>finagle-thrift,thriftmux: Tracing of RPC method names has been removed. This
concern has moved into Scrooge. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D115294</span></code></p></li>
</ul>
</section>
<section id="id251">
<h3>Deprecations<a class="headerlink" href="#id251" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.BackupRequestLost</cite> has been deprecated. Please use a
<cite>c.t.f.Failure</cite> flagged <cite>c.t.f.Failure.Ignorable</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D113466</span></code></p></li>
</ul>
</section>
</section>
<section id="id252">
<h2>17.11.0<a class="headerlink" href="#id252" title="Permalink to this headline">¶</a></h2>
<section id="id253">
<h3>New Features<a class="headerlink" href="#id253" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Add <cite>ResponseClassifier`s, RetryOnTimeout and RetryOnChannelClosed,
for exceptions that are commonly retried when building from ClientBuilder but had
no MethodBuilder equivalents. ``PHAB_ID=D106706`</cite></p></li>
<li><p>finagle-netty4: <cite>Netty4Transporter</cite> and <cite>Netty4Listener</cite> are now accessible, which
allows external users to create their own protocols for use with Finagle on Netty 4.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D105627</span></code></p></li>
</ul>
</section>
<section id="id254">
<h3>Bug Fixes<a class="headerlink" href="#id254" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-exp: Fix race condition in <cite>LatencyHistogram</cite> which could lead to the wrong
value returned for <cite>quantile</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D106330</span></code></p></li>
</ul>
</section>
<section id="id255">
<h3>Breaking API Changes<a class="headerlink" href="#id255" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Numerous overloads of <cite>c.t.f.Server.serve</cite> have been marked final.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D107280</span></code></p></li>
<li><p>finagle-thrift: Correctly send <cite>mux.Request#contexts</cite> in all cases. There were some
cases in which <cite>mux.Request#contexts</cite> were not always propagated. The contexts are
now always written across the transport. Note that there may be duplicated contexts
between “local” context values and “broadcast” context values. Local values will
precede broadcast values in sequence. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D107921</span></code></p></li>
</ul>
</section>
</section>
<section id="id256">
<h2>17.10.0<a class="headerlink" href="#id256" title="Permalink to this headline">¶</a></h2>
<section id="release-version-format">
<h3>Release Version Format<a class="headerlink" href="#release-version-format" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>From now on, release versions will be based on release date in the format of
YY.MM.x where x is a patch number. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D101244</span></code></p></li>
</ul>
</section>
<section id="id257">
<h3>New Features<a class="headerlink" href="#id257" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: DeadlineFilter may now be created from the class and used as a
regular Filter in addition to a stack module as before. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D94517</span></code></p></li>
<li><p>finagle-mysql: Add ability to toggle the <cite>CLIENT_FOUND_ROWS</cite> flag. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D91406</span></code></p></li>
<li><p>finagle-http: Separated the DtabFilter.Extractor from the ServerContextFilter into
a new module: ServerDtabContextFilter. While this is still enabled in the default
Http server stack, it can be disabled independently of the ServerContextFilter.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D94306</span></code></p></li>
</ul>
</section>
<section id="id258">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id258" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-netty4: <cite>Netty4ClientEngineFactory</cite> and <cite>Netty4ServerEngineFactory</cite> now
validate loaded certificates in all cases to ensure that the current date
range is within the validity range specified in the certificate. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D88664</span></code></p></li>
<li><p>finagle-netty4: <cite>TrustCredentials.Insecure</cite> now works with native SSL/TLS engines.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D103766</span></code></p></li>
<li><p>finagle-http2: Upgraded to the new netty http/2 API in netty version 4.1.16.Final,
which fixes several long-standing bugs but has some bugs around cleartext http/2.
One of the work-arounds modifies the visibility of a private field, so it’s incompatible
with security managers.  This is only true for http/2–all other protocols will be unaffected.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D98069</span></code></p></li>
<li><p>finagle-http: Netty 3 <cite>HeaderMap</cite> was replaced with our own implementation.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D99127</span></code></p></li>
</ul>
</section>
<section id="id259">
<h3>Deprecations<a class="headerlink" href="#id259" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-base-http: With the intention to make <cite>c.t.f.http.Cookie</cite> immutable,
<cite>set</cite> methods on <cite>c.t.f.http.Cookie</cite> have been deprecated:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>comment_=</cite></p></li>
<li><p><cite>commentUrl_=</cite></p></li>
<li><p><cite>domain_=</cite></p></li>
<li><p><cite>maxAge_=</cite></p></li>
<li><p><cite>path_=</cite></p></li>
<li><p><cite>ports_=</cite></p></li>
<li><p><cite>value_=</cite></p></li>
<li><p><cite>version_=</cite></p></li>
<li><p><cite>httpOnly_=</cite></p></li>
<li><p><cite>isDiscard_=</cite></p></li>
<li><p><cite>isSecure_=</cite></p></li>
</ul>
</div></blockquote>
<p>Use the <cite>c.t.f.http.Cookie</cite> constructor to set <cite>domain</cite>, <cite>maxAge</cite>, <cite>path</cite>, <cite>value</cite>, <cite>httpOnly</cite>,
and <cite>secure</cite>. <cite>comment</cite>, <cite>commentUrl</cite>, <cite>ports</cite>, <cite>version</cite>, and <cite>discard</cite> have been removed
per RFC-6265. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D82164</span></code>.</p>
<p>Alternatively, use the <cite>domain</cite>, <cite>maxAge</cite>, <cite>path</cite>, <cite>httpOnly</cite>, and <cite>secure</cite> methods to create a
new <cite>Cookie</cite> with the existing fields set, and the respective field set to a given value.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D83226</span></code></p>
</li>
<li><p>finagle-base-http: <cite>c.t.f.http.Cookie.isSecure</cite> and <cite>c.t.f.http.Cookie.isDiscard</cite>
have been deprecated. Use <cite>c.t.f.http.Cookie.secure</cite> for <cite>c.t.f.http.Cookie.isSecure</cite>.
<cite>isDiscard</cite> has been removed per RFC-6265. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D82164</span></code></p></li>
</ul>
</section>
<section id="id260">
<h3>Breaking API Changes<a class="headerlink" href="#id260" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-mysql: Moved <cite>Cursors.cursor</cite> method to <cite>Client</cite> trait, and removed <cite>Cursors</cite> trait.
This allows cursor queries to used with transactions.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D91789</span></code></p></li>
<li><p>finagle-mux: Expose transport contexts in mux.Request and mux.Response. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D92998</span></code></p></li>
<li><p>finagle-mux: The “leased” gauge has been removed from the mux client implementation since the
metric is reported as the sum of the value over all clients which is unlikely to be useful.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D100357</span></code></p></li>
</ul>
</section>
</section>
<section id="id261">
<h2>7.1.0<a class="headerlink" href="#id261" title="Permalink to this headline">¶</a></h2>
<section id="id262">
<h3>New Features<a class="headerlink" href="#id262" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: If a <cite>c.t.u.tunable.Tunable</cite> request or total timeout has been configured
on a client which uses a <cite>c.t.f.client.DynamicTimeout</cite> filter, the current value of tunable will
be used in the case of no dynamic timeout set for a request. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D81886</span></code></p></li>
<li><p>finagle-core: <cite>FailFastException</cite> now captures the throwable that caused it. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D86396</span></code></p></li>
<li><p>finagle-redis: finagle interface for redis DBSIZE command. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D85305</span></code></p></li>
</ul>
</section>
<section id="id263">
<h3>Bug Fixes<a class="headerlink" href="#id263" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Unregister <cite>ServerRegistry</cite> entry on <cite>StackServer#close</cite>. A
StackServer entry is registered in the <cite>ServerRegistry</cite> on serve of the
server but never unregistered. It is now unregistered on close of
the StackServer. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D83200</span></code></p></li>
<li><p>finagle-mux: Fix two issues with mux leases. In one bug, a new lease wouldn’t be sent to
the client if it was issued within 1 second of when the existing lease was set to expire.
In a second bug, the server would only nack if the issued lease was 0, but didn’t consider
whether the lease had expired. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D91645</span></code></p></li>
<li><p>finagle-netty4: <cite>Netty4ClientEngineFactory</cite> and <cite>Netty4ServerEngineFactory</cite> now
properly load all chain certificates when the <cite>SslClientConfiguration</cite> or
<cite>SslServerConfiguration</cite> uses <cite>KeyCredentials.CertKeyAndChain</cite> instead of just the
first one in the file. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D82414</span></code></p></li>
<li><p>finagle-thrift/thriftmux: Thrift/ThriftMux servers and clients now can be configured
with <cite>withMaxReusableBufferSize</cite> to specify the max size of the reusable buffer for
Thrift responses. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D83190</span></code></p></li>
</ul>
</section>
<section id="id264">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id264" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-stats: Verbosity levels are now respected: debug-metrics aren’t exported
by default.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D85278</span></code></p></li>
<li><p>finagle-netty4: <cite>ChannelTransport</cite> no longer considers the <cite>Channel.isWritable</cite> result
when determining status. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D82670</span></code></p></li>
</ul>
</section>
<section id="id265">
<h3>Deprecations<a class="headerlink" href="#id265" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-base-http: Encoding/decoding methods on <cite>c.t.f.http.Request</cite> and <cite>c.t.f.http.Response</cite>
to/from Strings and arrays of bytes have been deprecated. Use the methods on
<cite>c.t.f.http.codec.HttpCodec</cite> instead:</p>
<blockquote>
<div><ul class="simple">
<li><p>For <cite>c.t.f.http.Request.encodeString</cite>, use <cite>c.t.f.Http.codec.HttpCodec.encodeRequestToString</cite></p></li>
<li><p>For <cite>c.t.f.http.Request.encodeBytes</cite>, use <cite>c.t.f.Http.codec.HttpCodec.encodeRequestToBytes</cite></p></li>
<li><p>For <cite>c.t.f.http.Request.decodeString</cite>, use <cite>c.t.f.Http.codec.HttpCodec.decodeStringToRequest</cite></p></li>
<li><p>For c.t.f.http.Request.decodeBytes`, use <cite>c.t.f.Http.codec.HttpCodec.decodeBytesToRequest</cite></p></li>
<li><p>For <cite>c.t.f.http.Response.encodeString</cite>, use <cite>c.t.f.Http.codec.HttpCodec.encodeResponseToString</cite></p></li>
<li><p>For <cite>c.t.f.http.Response.decodeString</cite>, use <cite>c.t.f.Http.codec.HttpCodec.decodeStringToResponse</cite></p></li>
<li><p>For <cite>c.t.f.http.Response.decodeBytes</cite>, use <cite>c.t.f.Http.codec.HttpCodec.decodeBytesToResponse</cite></p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">PHAB_ID=D81341</span></code></p>
</li>
</ul>
</section>
<section id="id266">
<h3>Breaking API Changes<a class="headerlink" href="#id266" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Remove deprecated method <cite>httpProxyTo(String, Option[Transporter.Credentials])</cite>.
Use <cite>httpProxyTo(String, Transporter.Credentials]</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D84077</span></code></p></li>
<li><p>finagle-*-http: Netty 3 specific HTTP transport related code has been moved into its own
project, finagle-netty3-http, in preparation for removing it from Finagle.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D84101</span></code></p></li>
<li><p>finagle-memcached: Remove deprecated method <cite>BaseClient.release()</cite>. Use
<cite>BaseClient.close()</cite> instead. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D83168</span></code></p></li>
</ul>
</section>
<section id="id267">
<h3>Deprecations<a class="headerlink" href="#id267" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-memcached: Move <cite>c.t.f.memcached.java.Client</cite> to <cite>c.t.f.memcached.JavaClient</cite>,
<cite>c.t.f.memcached.java.ClientBase</cite> to <cite>c.t.f.memcached.JavaClientBase</cite>, and
<cite>c.t.f.memcached.java.ResultWithCAS</cite> to <cite>c.t.f.memcached.ResultWithCAS</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D83719</span></code></p></li>
<li><p>finagle-core: Added a new type member <cite>Context</cite> to <cite>Transport</cite>, and a method that
returns a context, which has most of the methods currently directly on <cite>Transport</cite>.
Also deprecates most of those methods–please start using the context instead of the
<cite>Transport</cite> directly.  Also added type parameters to <cite>Transporter</cite>, <cite>Listener</cite>, and
type members to <cite>StackClient</cite> and <cite>StackServer</cite>.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D83972</span></code></p></li>
<li><p>finagle-core: <cite>com.twitter.finagle.loadbalancer.DeterministicOrdering</cite> was renamed
to <cite>com.twitter.finagle.loadbalancer.ProcessCoordinate</cite> and the internal <cite>Coord</cite> ADT
was changed as well. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D84452</span></code></p></li>
<li><p>finagle-thrift: Move <cite>Thrift.Server.param.MaxReusableBufferSize</cite> to
<cite>Thrift.param.MaxReusableBufferSize</cite> for both server and client use. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D83190</span></code></p></li>
</ul>
</section>
</section>
<section id="id268">
<h2>7.0.0<a class="headerlink" href="#id268" title="Permalink to this headline">¶</a></h2>
<section id="id269">
<h3>New Features<a class="headerlink" href="#id269" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: A <cite>StackClient</cite> can be configured with a <cite>c.t.u.tunable.Tunable</cite>
request timeout using <cite>.withRequestTimeout(tunable)</cite>; this facilitates changing
the timeout at runtime, without server restart.
See <a class="reference external" href="https://twitter.github.io/finagle/guide/Configuration.html#tunables">https://twitter.github.io/finagle/guide/Configuration.html#tunables</a> for details.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D80751</span></code>.</p></li>
<li><p>finagle-core: <cite>SslClientSessionVerifier</cite> and <cite>SslServerSessionVerifier</cite> have been added
as <cite>Stack</cite> params for executing custom SSL/TLS <cite>Session</cite> verification logic on the
establishment of an SSL/TLS <cite>Session</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D63256</span></code></p></li>
<li><p>finagle-core: <cite>tls</cite> methods which take an <cite>SslClientSessionVerifier</cite> have
been added to <cite>ClientBuilder</cite> and <cite>ClientTransportParams</cite>
(withTransport.tls). <cite>tls</cite> methods which take an <cite>SslServerSessionVerifier</cite>
have been added to <cite>ServerBuilder</cite> and <cite>ServerTransportParams</cite>
(withTransport.tls). <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D68645</span></code></p></li>
<li><p>finagle-core: Timer tasks submitted to the <cite>c.t.f.util.DefaultTimer</cite> can have their
execution time monitored. Slow executing tasks may result in a log message at level WARN
and a counter of slow tasks is kept under <cite>finagle/timer/slow</cite>. This can be enabled using
the global flag <cite>c.t.f.util.defaultTimerProbeSlowTasks</cite> and the maximum allowed runtime
and minimum duration between log messages can be tuned using the global flags
<cite>c.t.f.util.defaultTimerSlowTaskMaxRuntime</cite>, and
<cite>c.t.f.util.defaultTimerSlowTaskLogMinInterval</cite>, respectively. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D70279</span></code></p></li>
<li><p>finagle-core: The JVM metrics for GC, allocations, memory, and more have moved
here from TwitterServer. See the new JVM section in the user guide for details:
<a class="reference external" href="https://twitter.github.io/finagle/guide/Metrics.html">https://twitter.github.io/finagle/guide/Metrics.html</a>
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D80883</span></code></p></li>
<li><p>finagle-http, finagle-thriftmux: <cite>MethodBuilder</cite> has been promoted out of experimental.
<cite>MethodBuilder</cite> is a collection of APIs for client configuration at a higher level than
the Finagle 6 APIs while improving upon the deprecated <cite>ClientBuilder</cite>.
See the user guide for details: <a class="reference external" href="https://twitter.github.io/finagle/guide/MethodBuilder.html">https://twitter.github.io/finagle/guide/MethodBuilder.html</a>
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D60032</span></code></p></li>
<li><p>finagle-http: add <cite>withNoAutomaticContinue</cite> api to disable automatically sending 100 CONTINUE
responses. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D80017</span></code></p></li>
<li><p>finagle-http: The nack related logic in the <cite>c.t.f.h.c.HttpClientDispatcher</cite> has been
moved into a filter, <cite>c.t.f.h.f.ClientNackFilter</cite> which has been added to the client
stack and can now be removed based on its <cite>Stack.Role</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D78902</span></code></p></li>
<li><p>finagle-init: Introduce a module to support service-loading initialization
code. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D75950</span></code></p></li>
<li><p>finagle-memcached: Added support for partitioned backends in finagle client. Introducing
the new PartitioningService (<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D75143</span></code>), KetamaPartitioningService (<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D77499</span></code>)
and MemcachedPartitioningService (<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D78927</span></code>), which provide this support at different
levels of abstraction. The c.t.f.Memcached util, that is used for creating new memcached
clients, now creates a new partitioning client that utilizes these new services for the
Memcached protocol. The new memcached client can be enabled by setting the toggle
“com.twitter.finagle.memcached.UsePartitioningMemcachedClient” to 1.0. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D80352</span></code></p></li>
<li><p>finagle-mux: Default to new more efficient decoder. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D80225</span></code></p></li>
<li><p>finagle-mysql: <cite>IsolationLevel</cite> support was added with
<cite>Transactions.transactionWithIsolation</cite> method, so the default level can be overridden
at the transaction level. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D68944</span></code></p></li>
<li><p>finagle-mysql: Add support for unsigned integers. When enabled, unsigned integers that do
not fit into the existing signed representation are widened. For example an unsigned
Int32 is represented as a Java Long, etc. Because this changes the <cite>c.t.f.mysql.Value</cite>
variant returned by the row, it is disabled by default and must be enabled with the param
<cite>c.t.f.Mysql.param.UnsignedColumns</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D78721</span></code></p></li>
<li><p>finagle-netty4: Adds support for passing a chain file to the default TLS implementation.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D59531</span></code></p></li>
<li><p>finagle-netty4: Netty 4 transports now use pooled allocators by default. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D75014</span></code></p></li>
<li><p>finagle-netty4: <cite>KeyCredentials.CertKeyAndChain</cite> is now available to use with
<cite>Netty4ServerEngineFactory</cite>. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D80494</span></code></p></li>
<li><p>finagle-netty4: <cite>c.t.f.netty4.trackReferenceLeaks</cite> is now a CLI flag (default: disabled)
rather than a toggle. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D80654</span></code></p></li>
<li><p>finagle-stats: Metrics now report verbosity levels via <cite>MetricsView.verbosity</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D78150</span></code></p></li>
<li><p>finagle-stats: <cite>JsonExporter</cite> now respects verbosity levels (current default behavior is
to keep exporting “debug” metrics). Adjust <cite>com.twitter.finagle.stats.verbose</cite> tunable
allowlist to change it.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D79571</span></code></p></li>
<li><p>finagle-tunable: <cite>StandardTunableMap</cite> is now public. Users can access file-based, in-memory,
and service-loaded tunable values using the map.
See <a class="reference external" href="https://twitter.github.io/finagle/guide/Configuration.html#tunables">https://twitter.github.io/finagle/guide/Configuration.html#tunables</a> for details.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D80751</span></code>.</p></li>
<li><p>finagle: Changed dependencies of Netty from 4.1.10 to 4.1.12. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D60438</span></code></p></li>
</ul>
</section>
<section id="id270">
<h3>Bug Fixes<a class="headerlink" href="#id270" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-mysql: Fix decoding error for medium length integers. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D78505</span></code></p></li>
</ul>
</section>
<section id="id271">
<h3>Breaking API Changes<a class="headerlink" href="#id271" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Finagle is now decoupled from Netty 3. Depend on <cite>finagle-netty3</cite>
explicitly if needed. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D65268</span></code></p></li>
<li><p>finagle-base-http: The HTTP message model has been refactored to remove backing
Netty 3 types. Additionally, the <cite>Request</cite> and <cite>Response</cite> classes now have private
constructors to enforce a more appropriate inheritance model: <cite>Request.Proxy</cite> and
<cite>Response.Proxy</cite> are now the point of entry for extending the HTTP model types. Along
with the model changes the InputStream generated <cite>.getInputStream()</cite> method of HTTP
messages no longer consumes the messages body. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D74519</span></code></p></li>
<li><p>finagle-core: The Framer type has been transformed into a specialized version of a
more generic abstraction, Decoder[T]. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D59495</span></code></p></li>
<li><p>finagle-core: Replace the <cite>c.t.f.context.RemoteInfo.Available</cite> constructor
which takes <cite>ClientId</cite> in favor of a version taking <cite>String</cite>. <cite>ClientId</cite> is
Twitter’s Thrift specific concept and this should be more generic.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D60136</span></code></p></li>
<li><p>finagle-core: Remove the ability to set a global address sort. This is no longer
necessary as setting this per client is sufficient. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D60698</span></code></p></li>
<li><p>finagle-core: Remove global flag <cite>com.twitter.finagle.tracing.debugTrace</cite>.
This functionality is better suited as a concrete <cite>Tracer</cite> implementation instead
of mixed into the generic code. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D63252</span></code></p></li>
<li><p>finagle-core: <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D63526</span></code></p>
<ul>
<li><p><cite>ClientBuilder.codec</cite> and <cite>ServerBuilder.codec</cite> have been removed. Use <cite>.stack</cite> instead.</p></li>
<li><dl class="simple">
<dt><cite>ClientBuilder.channelFactory</cite> and <cite>ServerBuilder.channelFactory</cite> have been removed.</dt><dd><p>Use <cite>.stack</cite> instead.</p>
</dd>
</dl>
</li>
</ul>
</li>
<li><p>finagle-core: LoadBalancerFactory now takes <cite>Stack.Params</cite> which allows a client to
more easily pass in the stack context. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D73129</span></code></p></li>
<li><p>finagle-memcached: Add <cite>c.t.util.Closable</cite> trait to <cite>c.t.f.memcached.BaseClient</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D63970</span></code></p></li>
<li><p>finagle-mysql: A number of implementation details were made private such as specific
<cite>Row</cite> implementations and <cite>ResultSet</cite> builder functions that consume raw packets.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D78721</span></code></p></li>
<li><p>finagle-netty4-http: HTTP/1.1 implementation based on Netty 4 is no longer experimental
and is moved out of the <cite>exp</cite> package. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D80181</span></code></p></li>
<li><p>finagle-serversets: Remove <cite>ZkMetaData.AddressOrdering`</cite>, it is no longer used.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D60698</span></code></p></li>
<li><p>finagle-stats: <cite>c.t.f.stats.MetricsStatsReceiver</cite> no longer has constructor variants
which take a <cite>c.t.u.events.Sink</cite> as util-events is now deprecated. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D64437</span></code></p></li>
<li><p>finagle-thrift: The Netty3 thrift implementation has been removed.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D63670</span></code></p></li>
<li><p>finagle-zipkin-core: <cite>c.t.f.zipkin.core.SamplingTracer</cite> no longer has constructor
which takes a <cite>c.t.u.events.Sink</cite> as util-events is now deprecated. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D64437</span></code></p></li>
<li><p>finagle-zipkin: Zipkin Tracer now exports only three counters: <cite>requests</cite>, <cite>failures</cite>,
<cite>success</cite>.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D71965</span></code></p></li>
</ul>
</section>
<section id="id272">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id272" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The <cite>AsyncSemaphore</cite> which sequences dispatches in <cite>GenSerialClientDispatcher</cite>
is now failed with a retryable <cite>Failure</cite> so that the retry logic knows that requests that
which failed to acquire the semaphore are safe to retry. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D78904</span></code></p></li>
<li><p>finagle-http: <cite>serverErrorsAsFailuresV2</cite> toggle is turned into a flag <cite>serverErrorsAsFailures</cite>.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D73265</span></code></p></li>
<li><p>finagle-http: Dispatcher stats are now exported under the client scope like
all other client stats.``PHAB_ID=D72265``</p></li>
<li><p>finagle-http: It’s now possible to send a response from the HTTP server that has a
Content-Length header so long as the ‘Transfer-Encoding: chunked’ isn’t set on the response.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D80087</span></code></p></li>
<li><p>finagle-http: Non-streaming servers strip ‘expect’ headers when a 100 CONTINUE
response is sent. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D80017</span></code></p></li>
<li><p>finagle-serversets: <cite>Stabilizer</cite> is no longer exporting <cite>pending_tasks</cite> and <cite>deviation_ms</cite>
stats. See <cite>notify_ms</cite> instead.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D65571</span></code></p></li>
<li><p>finagle-stats, finagle-zipkin-core: No longer publishing <cite>c.t.u.events</cite> as util-events
is now deprecated. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D64437</span></code></p></li>
<li><p>finagle-stats: No longer backed by commons metrics, now its own thing.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D73497</span></code></p></li>
<li><p>finagle-netty4: Unset Netty’s default timeout (10 seconds) for SSL handshake on clients.
Use <cite>.withSession.acquisitionTimeout</cite> instead.  <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D78500</span></code></p></li>
</ul>
</section>
</section>
<section id="id273">
<h2>6.45.0<a class="headerlink" href="#id273" title="Permalink to this headline">¶</a></h2>
<section id="id274">
<h3>New Features<a class="headerlink" href="#id274" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Changed dependencies of Netty from 4.1.9 to 4.1.10 and tcnative
from 2.0.0 to 2.0.1. <code class="docutils literal notranslate"><span class="pre">RB_ID=916056</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.n.ssl.SslConnectHandler</cite> is no longer exported publicly.
It has also been renamed to <cite>c.t.f.n.ssl.client.SslClientConnectHandler</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=916932</span></code></p></li>
<li><p>finagle-core: c.t.f.factory.ServiceFactoryCache is now exported publicly.
<code class="docutils literal notranslate"><span class="pre">RB_ID=915064</span></code></p></li>
<li><p>finagle-core: Allow customization of load balancer behavior when no nodes
are <cite>Status.Open</cite>. See the user guide for details:
<a class="reference external" href="https://twitter.github.io/finagle/guide/Clients.html#behavior-when-no-nodes-are-available">https://twitter.github.io/finagle/guide/Clients.html#behavior-when-no-nodes-are-available</a>
<code class="docutils literal notranslate"><span class="pre">RB_ID=916145</span></code></p></li>
<li><p>finagle-core: The global <cite>c.t.f.naming.NameInterpreter</cite> can be optionally set using
service loader. <code class="docutils literal notranslate"><span class="pre">RB_ID=917082</span></code></p></li>
<li><p>finagle-redis: Support scanning over sets and sorted sets with SSCAN and ZSCAN.
<code class="docutils literal notranslate"><span class="pre">RB_ID=916484</span></code></p></li>
</ul>
</section>
<section id="id275">
<h3>Bug Fixes<a class="headerlink" href="#id275" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-mux: Disable Netty4RefCountingControl decoder when message fragmentation
is enabled. <code class="docutils literal notranslate"><span class="pre">PHAB_ID=D58153</span></code></p></li>
<li><p>finagle: Fixed Java API for <cite>withStack</cite> for Client and Server implementations.
Java users now get the correct types for calls such as <cite>c.t.f.Http.client().withStack</cite>
and <cite>c.t.f.Http.server().withStack</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=915440</span></code></p></li>
<li><p>finagle-thrift, finagle-thriftmux: Clients created using <cite>newServiceIface</cite> now use the
configured <cite>c.t.f.service.ResponseClassifier</cite> (or <cite>c.t.f.service.ResponseClassifier.Default</cite> if
not configured) for per-method stats and usage in <cite>c.t.f.liveness.FailureAccrualFactory</cite> and
<cite>c.t.f.stats.StatsFilter</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=917010</span></code></p></li>
</ul>
</section>
<section id="id276">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id276" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Add a floor of 8 to the default values of the flags <cite>c.t.f.netty3.numWorkers</cite>
and <cite>c.t.f.netty4.numWorkers</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=916465</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.util.DefaultTimer</cite> is decoupled from Netty 3 and is loaded via the
<cite>LoadService</cite> machinery. If no timers are available on the class path, the <cite>JavaTimer</cite>
instead is used instead. This ony affects direct usages of <cite>DefaultTimer</cite> as all Finagle
protocols are using Netty 4 <cite>HashedWheelTimer</cite> at this point. <code class="docutils literal notranslate"><span class="pre">RB_ID=915924</span></code></p></li>
<li><p>finagle-core: The load balancer implementations no longer close the endpoint
resources when they are closed. Instead, they treat them as externally
managed resources and expect the layers above to manage them. No change
is required if using the Balancers in the context of a Finagle client.
If that’s not the case, however, managing the life cycle of the passed
in endpoints is necessary. <code class="docutils literal notranslate"><span class="pre">RB_ID=916415</span></code></p></li>
<li><p>finagle-core: Aperture load balancers now expire idle sessions which fall
out of the aperture window. <code class="docutils literal notranslate"><span class="pre">RB_ID=916508</span></code></p></li>
<li><p>finagle-http: Uses Netty 4 as the default transport implementation.
Use <cite>.configured(Http.Netty3Impl)</cite> to switch implementation over to Netty 3.
<code class="docutils literal notranslate"><span class="pre">PHAB_ID=D58698</span></code> <code class="docutils literal notranslate"><span class="pre">RB_ID=917936</span></code></p></li>
<li><p>finagle-memcached: If the client decoder detects a protocol failure, the ClientTransport
will close the connection. <code class="docutils literal notranslate"><span class="pre">RB_ID=917685</span></code></p></li>
<li><p>finagle-netty4: <cite>poolReceiveBuffers</cite> toggle is removed (suppressed by <cite>UsePooling</cite>).
<code class="docutils literal notranslate"><span class="pre">RB_ID=917912</span></code></p></li>
<li><p>finagle-http: To conform to RFC 2616, a message body is NO LONGER sent when 1xx, 204
and 304 responses are returned. To conform with RFC 7230, a Content-Length header field
is NOT sent for 1xx and 204 responses. Both rules are enforced even if users intentionally
add body data or the header field for these responses. If violation of these rules is
detected then an error message is logged. <code class="docutils literal notranslate"><span class="pre">RB_ID=917827</span></code></p></li>
</ul>
</section>
<section id="id277">
<h3>Breaking API Changes<a class="headerlink" href="#id277" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle: <cite>$protocol.Client.params/stack</cite> and <cite>$protocol.Server.params/stack</cite> are removed,
use similar methods on instances instead: <cite>$protocol.client.params/stack</cite> and
<cite>$protocol.server.params/stack</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=915703</span></code></p></li>
<li><p>finagle-core: Remove deprecated <cite>c.t.f.builder.ClientBuilder.tracerFactory</cite>.
Use <cite>c.t.f.builder.ClientBuilder.tracer</cite> instead. Remove deprecated
<cite>c.t.f.tracing.Tracer.Factory</cite>. Use <cite>c.t.f.tracing.Tracer</cite> instead.
<code class="docutils literal notranslate"><span class="pre">RB_ID=915481</span></code></p></li>
<li><p>finagle-core: Remove deprecated <cite>c.t.f.Deadline</cite>. Use <cite>c.t.f.context.Deadline</cite> instead.
<code class="docutils literal notranslate"><span class="pre">RB_ID=915550</span></code></p></li>
<li><p>finagle-core: Remove deprecated <cite>c.t.f.builder.ClientBuilder.cluster</cite> and
<cite>c.t.f.builder.ClientBuilder.group</cite>. Use <cite>c.t.f.builder.ClientBuilder.dest</cite> instead.
<code class="docutils literal notranslate"><span class="pre">RB_ID=915098</span></code></p></li>
<li><p>finagle-core: Remove deprecated <cite>c.t.f.tracing.Trace.recordRpcName</cite>. Use
<cite>c.t.f.tracing.Trace.recordRpc</cite> and <cite>c.t.f.tracing.Trace.recordServiceName</cite> instead.
<code class="docutils literal notranslate"><span class="pre">RB_ID=916426</span></code></p></li>
<li><p>finagle-core: Remove deprecated <cite>c.t.f.builder.Cluster</cite>. Use <cite>com.twitter.finagle.Name</cite> to
represent clusters instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=916162</span></code></p></li>
<li><p>finagle-core: LoadBalancerFactory now takes an EndpointFactory which is an
extension of ServiceFactory that carries an address and has the ability to
be rebuilt. <code class="docutils literal notranslate"><span class="pre">RB_ID=916956</span></code></p></li>
<li><p>finagle-base-http: Remove deprecated <cite>c.t.f.http.Message.ContentTypeWwwFrom</cite>.
Use <cite>c.t.f.http.Message.ContentTypeWwwForm</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=915543</span></code></p></li>
<li><p>finagle-exception: Remove deprecated <cite>c.t.f.exception.Reporter.clientReporter</cite> and
<cite>c.t.f.exception.Reporter.sourceReporter</cite>. Use <cite>c.t.f.exception.Reporter.monitorFactory</cite>
instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=916403</span></code></p></li>
<li><p>finagle-http: Remove deprecated <cite>c.t.f.http.HttpMuxer.pattern</cite>. Specify a route
using <cite>c.t.f.http.HttpMuxer.route(pattern, this)</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=915551</span></code></p></li>
<li><p>finagle-http: Remove deprecated <cite>c.t.f.http.filter.ValidateRequestFilter</cite>. Create a custom
filter if this behavior is needed. <code class="docutils literal notranslate"><span class="pre">RB_ID=915548</span></code></p></li>
<li><p>finagle-kestrel: Remove deprecated methods on <cite>c.t.f.kestrel.MultiReader</cite>:
- <cite>apply(cluster: Cluster[SocketAddress], queueName: String)</cite>
- <cite>apply(clients: Seq[Client], queueName: String)</cite>
- <cite>apply(handles: ju.Iterator[ReadHandle])</cite>
- <cite>newBuilder(cluster: Cluster[SocketAddress], queueName: String)</cite>
- <cite>merge(readHandleCluster: Cluster[ReadHandle])</cite>
Use the <cite>c.t.f.Var[Addr]</cite>-based <cite>apply</cite> methods on <cite>c.t.f.kestrel.MultiReaderMemcache</cite> or <cite>c.t.f.kestrel.MultiReaderThriftMux</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=914910</span></code></p></li>
<li><p>finagle-kestrel: Removed from the project. <code class="docutils literal notranslate"><span class="pre">RB_ID=915221</span></code>
<a class="reference external" href="https://finagle.github.io/blog/2017/04/06/announce-removals/">https://finagle.github.io/blog/2017/04/06/announce-removals/</a></p></li>
<li><p>finagle-mdns: Removed from the project. <code class="docutils literal notranslate"><span class="pre">RB_ID=915216</span></code>
<a class="reference external" href="https://finagle.github.io/blog/2017/04/06/announce-removals/">https://finagle.github.io/blog/2017/04/06/announce-removals/</a></p></li>
<li><p>finagle-memcached: Remove deprecated <cite>c.t.f.memcached.BaseClient.cas</cite> methods.
Use <cite>c.t.f.memcached.BaseClient.checkAndSet</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=914678</span></code></p></li>
<li><p>finagle-memcached: <cite>c.t.f.memcached.protocol.text.Encoder</cite> object is now private.
<code class="docutils literal notranslate"><span class="pre">RB_ID=917214</span></code></p></li>
<li><p>finagle-memcached: Make memcached Response subtypes with no fields case objects.
<code class="docutils literal notranslate"><span class="pre">RB_ID=917137</span></code></p></li>
<li><p>finagle-mysql: Remove deprecated methods on <cite>c.t.f.Mysql</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>withCredentials</cite>; use <cite>c.t.f.Mysql.client.withCredentials</cite> instead</p></li>
<li><p><cite>withDatabase</cite>; use <cite>c.t.f.Mysql.client.withDatabase</cite> instead</p></li>
<li><p><cite>withCharset</cite>; use <cite>c.t.f.Mysql.client.withCharset</cite> instead</p></li>
<li><p><cite>configured</cite>; use <cite>c.t.f.Mysql.client.configured</cite> instead</p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">RB_ID=916418</span></code></p>
</li>
<li><p>finagle-native: Removed from the project. <code class="docutils literal notranslate"><span class="pre">RB_ID=915204</span></code>
<a class="reference external" href="https://finagle.github.io/blog/2017/04/06/announce-removals/">https://finagle.github.io/blog/2017/04/06/announce-removals/</a></p></li>
<li><p>finagle-netty4: <cite>AnyToHeapInboundHandler</cite> is gone. Use <cite>BufCodec</cite> while designing
new Finagle protocols. <code class="docutils literal notranslate"><span class="pre">RB_ID=915251</span></code></p></li>
<li><p>finagle-ostrich4: Removed from the project. <code class="docutils literal notranslate"><span class="pre">RB_ID=915327</span></code>
<a class="reference external" href="https://finagle.github.io/blog/2017/04/06/announce-removals/">https://finagle.github.io/blog/2017/04/06/announce-removals/</a></p></li>
<li><p>finagle-redis: <cite>ChannelBuffer</cite> methods and converters are removed. Use <cite>Buf</cite>-based API
instead. Removed APIs: <code class="docutils literal notranslate"><span class="pre">RB_ID=916015</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p><cite>c.t.f.redis.NettyConverters</cite></p></li>
<li><p><cite>c.t.f.redis.util.StringToChannelBuffer</cite></p></li>
<li><p><cite>c.t.f.redis.Client.watch(Seq[ChannelBuffer])</cite></p></li>
</ul>
</div></blockquote>
</li>
<li><p>finagle-stream: Removed from the project. <code class="docutils literal notranslate"><span class="pre">RB_ID=915200</span></code>
<a class="reference external" href="https://finagle.github.io/blog/2017/04/06/announce-removals/">https://finagle.github.io/blog/2017/04/06/announce-removals/</a></p></li>
<li><p>finagle-thrift: Remove deprecated <cite>c.t.f.thrift.transport.netty3.ThriftServerBufferedCodec</cite>
and <cite>c.t.f.thrift.transport.netty3.ThriftServerBufferedCodecFactory</cite>. Use the <cite>c.t.f.Thrift</cite>
object to build a server. <code class="docutils literal notranslate"><span class="pre">RB_ID=915656</span></code></p></li>
<li><p>finagle-thriftmux: Remove deprecated <cite>c.t.f.ThrifMux.withClientId</cite>. Use
<cite>c.t.f.ThriftMux.client.withClientId</cite>. Remove deprecated <cite>c.t.f.ThrifMux.withProtocolFactory</cite>.
Use <cite>c.t.f.ThriftMux.client.withProtocolFactory</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=915655</span></code></p></li>
</ul>
</section>
</section>
<section id="id278">
<h2>6.44.0<a class="headerlink" href="#id278" title="Permalink to this headline">¶</a></h2>
<section id="id279">
<h3>New Features<a class="headerlink" href="#id279" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-thriftmux: Allow ThriftMux.Servers to be filtered, also add <cite>withStack</cite>
method to server side as well. <code class="docutils literal notranslate"><span class="pre">RB_ID=915095</span></code></p></li>
<li><p>finagle-core: FailureAccrual is now production ready. It has been promoted out of
experimental and moved from com.twitter.finagle.service.exp to
com.twitter.finagle.liveness. <code class="docutils literal notranslate"><span class="pre">RB_ID=914662</span></code></p></li>
<li><p>finagle-core: SSL/TLS APIs have been changed to include methods which work
based on an SSL configuration, and an SSL configuration and an SSL engine factory.
<code class="docutils literal notranslate"><span class="pre">RB_ID=911209</span></code></p></li>
<li><p>finagle-core: LoadBalancerFactory now exposes a mechanism to order the collection
of endpoints passed to the balancer implementations. This allows a consistent ordering
of endpoints across process boundaries. <code class="docutils literal notranslate"><span class="pre">RB_ID=910372</span></code></p></li>
<li><p>finagle-core: Introduce <cite>c.t.f.client.EndpointerStackClient</cite>, a mechanism for
making clients that don’t need a transporter and dispatcher. This simplifies
making non-netty clients. <code class="docutils literal notranslate"><span class="pre">RB_ID=912889</span></code></p></li>
<li><p>finagle-http2: Add support for liveness detection via pings.  It can be configured
the same way as it is in mux. <code class="docutils literal notranslate"><span class="pre">RB_ID=913341</span></code></p></li>
<li><p>finagle-toggle: Standard toggles now track the last value produced from <cite>apply</cite>.
These values are visible via TwitterServer’s /admin/toggles endpoint. <code class="docutils literal notranslate"><span class="pre">RB_ID=913925</span></code></p></li>
</ul>
</section>
<section id="id280">
<h3>Breaking API Changes<a class="headerlink" href="#id280" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-mysql: Support for Netty 3 has been removed, making Netty 4 the only transport
implementation. <code class="docutils literal notranslate"><span class="pre">RB_ID=914661</span></code></p></li>
<li><p>finagle-core: com.twitter.finagle.service.exp.FailureAccrualPolicy has been promoted to
com.twitter.finagle.liveness.FailureAccrualPolicy</p></li>
<li><p>finagle-commons-stats: Remove finagle-commons-stats, which was a compatibility layer
for a deprecated stats library.  Please move to finagle-stats instead.  <code class="docutils literal notranslate"><span class="pre">RB_ID=910964</span></code></p></li>
<li><p>finagle-core: SSL/TLS stack params for Finagle running Netty 4 have changed.</p>
<ul class="simple">
<li><p>The <cite>TlsConfig</cite> param in <cite>Transport</cite> has been removed.</p></li>
<li><p>For client engines, the same two parameters as Finagle running Netty 3 are now used:</p>
<ul>
<li><p><cite>ClientSsl</cite> in <cite>Transport</cite>, which is used for configuring a client <cite>Engine</cite>’s hostname,
key credentials, trust credentials, cipher suites, protocols, and application protocols.</p></li>
<li><p><cite>SslClientEngineFactory</cite> in <cite>SslClientEngineFactory</cite>, which determines how the <cite>Engine</cite>
is created based off of an <cite>Address</cite> and an <cite>SslClientConfiguration</cite>.</p></li>
</ul>
</li>
<li><p>For server engines, the same two parameters as Finagle running Netty 3 are now used:</p>
<ul>
<li><p><cite>ServerSsl</cite> in <cite>Transport</cite>, which is used for configuring a server <cite>Engine</cite>’s key
credentials, trust credentials, cipher suites, protocols, application protocols, and
where the server supports or requires client authentication.</p></li>
<li><p><cite>SslServerEngineFactory</cite> in <cite>SslServerEngineFactory</cite>, which determines how the <cite>Engine</cite>
is created based off of an <cite>SslServerConfiguration</cite>.</p></li>
</ul>
</li>
<li><p>Note: Not all client and server configurations work with all engine factories. Each engine
factory should document what is not supported by that specific engine factory.</p></li>
<li><p>Note: By default, Finagle on Netty 4 will use the <cite>Netty4ClientEngineFactory</cite> and
<cite>Netty4ServerEngineFactory</cite> respectively.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">RB_ID=910500</span></code></p>
</li>
<li><p>finagle-core: Change the API to LoadBalancerFactory to a more concrete
<cite>Activity[IndexedSeq[ServiceFactory[Req, Rep]]]</cite> since the majority of the
load balancer implementations don’t need the properties of a Set but instead
need ordering guarantees and efficient random access. <code class="docutils literal notranslate"><span class="pre">RB_ID=910372</span></code></p></li>
<li><p>finagle-core: Balancers.aperture now has a new parameter <cite>useDeterministicOrdering</cite>,
which is set to false by default. This feature is still experimental and under
construction. This will break the Java API and require the additional param to
be passed in explicitly.  <code class="docutils literal notranslate"><span class="pre">RB_ID=911541</span></code></p></li>
<li><p>finagle-core: The logic for tracking sessions that was in StdStackServer has been lifted into
a new template, ListeningStackServer where implementations define the creation of a
ListeningServer from a ServiceFactory, SocketAddress, and a function that tracks accepted
sessions. <code class="docutils literal notranslate"><span class="pre">RB_ID=914124</span></code></p></li>
<li><p>finagle-core: Change the AddressOrdering param to no longer take a StatsReceiver,
since orderings were simplified and are no longer composite. <code class="docutils literal notranslate"><span class="pre">RB_ID=914113</span></code></p></li>
<li><p>finagle-core: Remove deprecated methods on <cite>c.t.f.Client</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p>newClient(dest: Group[SocketAddress])</p></li>
<li><p>newService(dest: Group[SocketAddress])</p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">RB_ID=914787</span></code></p>
</li>
<li><p>finagle-core: <cite>c.t.f.ListeningServer</cite> no longer extends <cite>c.t.f.Group</cite>. Use
<cite>c.t.f.ListeningServer.boundAddress</cite> to extract the address from the server.
<code class="docutils literal notranslate"><span class="pre">RB_ID=914693</span></code></p></li>
<li><p>finagle-core: Remove deprecated <cite>c.t.f.group.StabilizingGroup</cite>. Use
<cite>c.t.f.addr.StabilizingAddr</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=914823</span></code></p></li>
<li><p>finagle-core: Constructors for <cite>c.t.f.ChannelException</cite> and its subclasses now have
overloads that take <cite>Option</cite>s instead of allowing <cite>null</cite>. While the existing
constructors remain, and forward to the new ones, this can still cause compilation
failures when the arguments are ambiguous. <code class="docutils literal notranslate"><span class="pre">RB_ID=914800</span></code></p></li>
<li><p>finagle-core: Remove MimimumSetCluster since it has been deperecated for quite
some time. Instead, use finagle logical destinations via <cite>Name`s. ``RB_ID=914849`</cite></p></li>
<li><p>finagle-core: Remove deprecated <cite>c.t.f.Resolver.resolve</cite>. Use <cite>c.t.f.Resolver.bind</cite>
instead. Remove deprecated <cite>c.t.f.BaseResolver.resolve</cite>. Use <cite>c.t.f.Resolver.eval</cite>
instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=914986</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.http.Http</cite> codec has disappeared as part of Netty 4 migration. Use
<cite>c.t.f.Http.client</cite> or <cite>c.t.f.Http.server</cite> stacks instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=912427</span></code></p></li>
<li><p>finagle-kestrel: Remove <cite>c.t.f.kestrel.param.KestrelImpl.</cite> Kestrel clients and servers
now use Netty 4 and cannot be configured for Netty 3. <code class="docutils literal notranslate"><span class="pre">RB_ID=911031</span></code></p></li>
<li><p>finagle-memcached: Remove <cite>c.t.f.memcached.param.MemcachedImpl.</cite> Memcached clients and servers
now use Netty 4 and cannot be configured for Netty 3. <code class="docutils literal notranslate"><span class="pre">RB_ID=911031</span></code></p></li>
<li><p>finagle-kestrel: Remove commands that are not supported by the client:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>com.twitter.finagle.kestrel.protocol.DumpConfig</cite></p></li>
<li><p><cite>com.twitter.finagle.kestrel.protocol.DumpStats</cite></p></li>
<li><p><cite>com.twitter.finagle.kestrel.protocol.FlushAll</cite></p></li>
<li><p><cite>com.twitter.finagle.kestrel.protocol.Reload</cite></p></li>
<li><p><cite>com.twitter.finagle.kestrel.protocol.ShutDown</cite></p></li>
<li><p><cite>com.twitter.finagle.kestrel.protocol.Stats</cite></p></li>
<li><p><cite>com.twitter.finagle.kestrel.protocol.Version</cite></p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">RB_ID=911206</span></code></p>
</li>
<li><p>finagle-memcached: Remove deprecated <cite>c.t.f.memcached.KetamaClientBuilder</cite>. Use
<cite>c.t.f.Memcached.client</cite> to create a Memcached client. <code class="docutils literal notranslate"><span class="pre">RB_ID=907352</span></code></p></li>
<li><p>finagle-memcached: Remove deprecated <cite>c.t.f.memcached.replication.ReplicationClient</cite>. Use
<cite>c.t.f.memcached.replication.BaseReplicationClient</cite> with clients created using
<cite>c.t.f.Memcached.client</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=907352</span></code></p></li>
<li><p>finagle-memcached: Remove deprecated methods on <cite>c.t.f.memcached.Client</cite>:
- <cite>apply(name: Name)</cite>
- <cite>apply(host: String)</cite></p>
<p>Use <cite>c.t.f.Memcached.client</cite> to create a Memcached client. <code class="docutils literal notranslate"><span class="pre">RB_ID=908442</span></code></p>
</li>
<li><p>finagle-memcached: Remove deprecated <cite>c.t.f.memcached.protocol.text.Memcached</cite> object.
Use <cite>c.t.f.Memcached.client</cite> to create Memcached clients. <code class="docutils literal notranslate"><span class="pre">RB_ID=908442</span></code></p></li>
<li><p>finagle-memcached: Remove deprecated <cite>c.t.f.memcached.Server</cite> class. Use
<cite>c.t.f.memcached.integration.TestMemcachedServer</cite> for a quick test server.
<code class="docutils literal notranslate"><span class="pre">RB_ID=914827</span></code></p></li>
<li><p>Remove deprecated <cite>c.t.f.memcached.PartitionedClient</cite> object. Use
<cite>c.t.f.memcached.CacheNodeGroup.apply</cite> instead of
<cite>c.t.f.memcached.PartitionedClient.parseHostWeights</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=914827</span></code></p></li>
<li><p>Remove deprecated <cite>c.t.f.memcached.util.ParserUtils.DIGITS</cite>. Use “^\d+$” instead.
Remove deprecated <cite>c.t.f.memcached.util.ParserUtils.DigitsPattern</cite>. Use Pattern.compile(^\d+$)
instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=914827</span></code></p></li>
<li><p>finagle-memcached: Remove old <cite>c.t.f.memcached.replicated.BaseReplicationClient</cite> and
<cite>c.t.f.memcached.migration.MigrationClient</cite>, and most <cite>c.t.f.memcached.CachePoolCluster</cite>
methods. <code class="docutils literal notranslate"><span class="pre">RB_ID=910986</span></code></p></li>
<li><p>finagle-memcached: Remove old <cite>c.t.f.memcached.migration.DarkRead</cite>, and
<cite>c.t.f.memcached.migration.DarkWrite</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=911367</span></code></p></li>
<li><p>finagle-memcached: Remove <cite>c.t.f.memcached.CachePoolConfig</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=914623</span></code></p></li>
<li><p>finagle-mux: Netty 3 implementation of Mux is removed. Default is
Netty 4. <code class="docutils literal notranslate"><span class="pre">RB_ID=914239</span></code></p></li>
<li><p>finagle-netty4: <cite>DirectToHeapInboundHandler</cite> was renamed to <cite>AnyToHeapInboundHandler</cite>
and now copies any inbound buffer (not just directs) on heap.  <code class="docutils literal notranslate"><span class="pre">RB_ID=913984</span></code></p></li>
<li><p>finagle-thrift, finagle-thriftmux: Remove rich client/server support for prior
versions of Scrooge generated code. <code class="docutils literal notranslate"><span class="pre">RB_ID=911515</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.client.Transporter</cite> no longer has a close method, which
was introduced in 6.43.0.  It was sort of a hack, and we saw the opportunity
to do it properly. <code class="docutils literal notranslate"><span class="pre">RB_ID=912889</span></code></p></li>
<li><p>finagle-core, finagle-mux: Move FailureDetector from <cite>c.t.f.mux</cite> to <cite>c.t.f.liveness</cite>.
This also means that the <cite>sessionFailureDetector</cite> flag is now
<cite>c.t.f.liveness.sessionFailureDetector</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=912337</span></code></p></li>
</ul>
</section>
<section id="id281">
<h3>Bug Fixes<a class="headerlink" href="#id281" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-exp: <cite>DarkTrafficFilter</cite> now respects the log level when <cite>HasLogLevel</cite>,
and otherwise defaults the level to <cite>warning</cite> instead of <cite>error</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=914805</span></code></p></li>
<li><p>finagle-netty4: Fixed connection stall on unsuccessful proxy handshakes in Finagle clients
configured with HTTP proxy (<cite>Transporter.HttpProxyTo</cite>).  <code class="docutils literal notranslate"><span class="pre">RB_ID=913358</span></code></p></li>
</ul>
</section>
<section id="id282">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id282" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-netty4: Finagle is no longer logging the failed proxy handshake response.
<code class="docutils literal notranslate"><span class="pre">RB_ID=913358</span></code></p></li>
<li><p>finagle-netty4: SOCKS5 proxies are now bypassed if the connect destination is
localhost. This matches Finagle’s prior behavior from when Netty 3 was the default
transport implementation. <code class="docutils literal notranslate"><span class="pre">RB_ID=914494</span></code></p></li>
</ul>
</section>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-memcached: Remove dependency on com.twitter.common:io-json. <code class="docutils literal notranslate"><span class="pre">RB_ID=914623</span></code></p></li>
</ul>
</section>
</section>
<section id="id283">
<h2>6.43.0<a class="headerlink" href="#id283" title="Permalink to this headline">¶</a></h2>
<section id="id284">
<h3>New Features<a class="headerlink" href="#id284" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: <cite>c.t.f.http.Message</cite> now has a Java friendly method to set the
HTTP version: <cite>Message.version(Version)</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=906946</span></code></p></li>
<li><p>finagle-base-http: Added Java friendly methods to the HTTP model including
<cite>c.t.f.http.Message.contentLength(Long)</cite>, <cite>c.t.f.http.Message.contentLengthOrElse(Long): Long</cite>,
and <cite>c.t.f.http.Request.method(Method)</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=907501</span></code></p></li>
<li><p>finagle-base-http: <cite>c.t.f.http.HeaderMap</cite> now has a method, <cite>HeaderMap.newHeaderMap</cite> for
creating new empty <cite>HeaderMap</cite> instances. <code class="docutils literal notranslate"><span class="pre">RB_ID=907397</span></code></p></li>
<li><p>finagle-core: SSL/TLS client and server configurations and engine factories have
been added for finer grained control when using TLS with Finagle. <code class="docutils literal notranslate"><span class="pre">RB_ID=907191</span></code></p></li>
<li><p>finagle-netty4: Introducing a new toggle <cite>com.twitter.finagle.netty4.UsePooling</cite> that
enables byte buffers pooling in Netty 4 pipelines. <code class="docutils literal notranslate"><span class="pre">RB_ID=912789</span></code></p></li>
</ul>
</section>
<section id="id285">
<h3>Breaking API Changes<a class="headerlink" href="#id285" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-base-http: <cite>c.t.f.http.MapHeaderMap</cite> has been made private. Please use
<cite>HeaderMap.apply</cite> or <cite>HeaderMap.newHeaderMap</cite> to construct a new <cite>HeaderMap</cite> instance.
<code class="docutils literal notranslate"><span class="pre">RB_ID=907397</span></code></p></li>
<li><p>finagle-base-http: <cite>c.t.f.http.Version</cite> is no longer represented by case objects
and has been replaced by val instances of a case class. <code class="docutils literal notranslate"><span class="pre">RB_ID=906946</span></code></p></li>
<li><p>finagle-base-http: The common HTTP methods are no longer modeled by case objects but
as instances of a single c.t.f.http.Method class. The string representation of the HTTP
method is now available via the <cite>Method.name</cite> method. <code class="docutils literal notranslate"><span class="pre">RB_ID=906697</span></code></p></li>
<li><p>finagle-core: Move the <cite>java.net.SocketAddress</cite> argument from the <cite>apply</cite> method
on <cite>com.twitter.finagle.client.Transporter</cite> to the <cite>newTransporter</cite> method of
<cite>com.twitter.finagle.client.StackClient</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=907544</span></code></p></li>
<li><p>finagle-core: Load Balancer implementations no longer mix-in the OnReady trait and
OnReady was removed. <code class="docutils literal notranslate"><span class="pre">RB_ID=908863</span></code></p></li>
<li><p>finagle-core: HeapBalancer, ApertureLoadBalancer, and RoundRobinBalancer classes were
made package private. To construct load balancers for use within a Finagle client,
use the <cite>com.twitter.finagle.loadbalancer.Balancers</cite> object. <code class="docutils literal notranslate"><span class="pre">RB_ID=909245</span></code></p></li>
<li><p>finagle-core: The <cite>aperture</cite> constructor on the <cite>Balancers</cite> object no longer takes
a Timer since it was unused. <code class="docutils literal notranslate"><span class="pre">RB_ID=909245</span></code></p></li>
<li><p>finagle-core: The load balancer algorithm is now further scoped under “algorithm”.
<code class="docutils literal notranslate"><span class="pre">RB_ID=909309</span></code></p></li>
<li><p>finagle-core: Remove <cite>Ring</cite> from Finagle core’s util since it is unused
internally. <code class="docutils literal notranslate"><span class="pre">RB_ID=909718</span></code></p></li>
<li><p>finagle-core: SSL/TLS stack params for Finagle running Netty 3 have changed.</p>
<blockquote>
<div><ul class="simple">
<li><p>The <cite>TLSClientEngine</cite> param in <cite>Transport</cite> has been replaced by two parameters:</p>
<ul>
<li><p><cite>ClientSsl</cite> in <cite>Transport</cite>, which is used for configuring a client <cite>Engine</cite>’s hostname,
key credentials, trust credentials, cipher suites, protocols, and application protocols.</p></li>
<li><p><cite>SslClientEngineFactory</cite> in <cite>SslClientEngineFactory</cite>, which determines how the <cite>Engine</cite>
is created based off of an <cite>Address</cite> and an <cite>SslClientConfiguration</cite>.</p></li>
</ul>
</li>
<li><p>The <cite>TLSHostname</cite> param in <cite>Transporter</cite> has been removed. Hostnames should be set as
part of the <cite>SslClientConfiguration</cite> now.</p></li>
<li><p>The <cite>TLSServerEngine</cite> param in <cite>Transport</cite> has been replaced by two parameters:</p>
<ul>
<li><p><cite>ServerSsl</cite> in <cite>Transport</cite>, which is used for configuring a server <cite>Engine</cite>’s key
credentials, trust credentials, cipher suites, protocols, application protocols, and
whether the server supports or requires client authentication.</p></li>
<li><p><cite>SslServerEngineFactory</cite> in <cite>SslServerEngineFactory</cite>, which determines how the <cite>Engine</cite>
is created based off of an <cite>SslServerConfiguration</cite>.</p></li>
</ul>
</li>
<li><p>Note: Not all client and server configurations work with all engine factories. Each engine
factory should document what is not supported by that specific engine factory.</p></li>
<li><p>Note: Users using Finagle-Native should in the short term use <cite>LegacyServerEngineFactory</cite>
and in the long term move to using <cite>Netty4ServerEngineFactory</cite>.</p></li>
<li><p>Note: With this change, private keys are expected to explicitly be PKCS#8 PEM-encoded keys.
Users using PKCS#1 keys should in the short term use <cite>LegacyKeyServerEngineFactory</cite> and in
the longer term switch to using PKCS#8 keys, or use your own <cite>SslServerEngineFactory</cite> which
can explicitly handle those type of keys.</p></li>
<li><p>Note: By default, Finagle on Netty 3 will use the <cite>JdkClientEngineFactory</cite> and
<cite>JdkServerEngineFactory</cite> respectively.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">RB_ID=907923</span></code></p>
</div></blockquote>
</li>
<li><p>finagle-core: <cite>withLoadBalancer.connectionsPerEndpoint</cite> was removed and moved
into finagle-memcached, which was the only client that uses the feature. <code class="docutils literal notranslate"><span class="pre">RB_ID=908354</span></code></p></li>
<li><p>finagle-core: <cite>ClientBuilder.expHttpProxy</cite> and <cite>ClientBuilder.expSocksProxy</cite> are removed.
Use <cite>$Protocol.withTransport.httpProxyTo</cite> instead (requires Netty 4 transport). <code class="docutils literal notranslate"><span class="pre">RB_ID=909739</span></code></p></li>
<li><p>finagle-kestrel: Remove the deprecated <cite>codec</cite> method on <cite>c.t.f.kestrel.MultiReaderMemcache</cite>.
Use <cite>.stack(Kestrel.client)</cite> on the configured <cite>c.t.f.builder.ClientBuilder</cite> instead.
<code class="docutils literal notranslate"><span class="pre">RB_ID=907184</span></code></p></li>
<li><p>finagle-kestrel: Removed <cite>c.t.f.kestrel.Server</cite>. A local Kestrel server is preferred for
testing. <code class="docutils literal notranslate"><span class="pre">RB_ID=907334</span></code></p></li>
<li><p>finagle-kestrel: Removed deprecated <cite>c.t.f.kestrel.protocol.Kestrel</cite>. To create a Finagle
Kestrel client, use <cite>c.t.f.Kestrel.client</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=907422</span></code></p></li>
<li><p>finagle-serversets: Removed the unapply method and modified the signature of
fromAddrMetadata method in <cite>c.t.f.serverset2.addr.ZkMetadata</cite>. Instead of pattern
matching use the modified fromAddrMetadata method. <code class="docutils literal notranslate"><span class="pre">RB_ID=908186</span></code></p></li>
<li><p>finagle-stats: Remove the <cite>com.twitter.finagle.stats.exportEmptyHistograms</cite> toggle
which has defaulted to 0.0 for quite some time. Change the default value of the
<cite>com.twitter.finagle.stats.includeEmptyHistograms</cite> flag to false to retain the
behavior. <code class="docutils literal notranslate"><span class="pre">RB_ID=907186</span></code></p></li>
<li><p>finagle-thrift: <cite>ThriftServiceIface</cite> was refactored to be in terms of <cite>ThriftMethod.Args</cite>
to <cite>ThriftMethod.SuccessType</cite> instead of <cite>ThriftMethod.Args</cite> to <cite>ThriftMethod.Result</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=908846</span></code></p></li>
<li><p>finagle-redis: Remove pendingCommands from <cite>c.t.f.finagle.redis.SentinelClient.Node</cite> and
add linkPendingCommands for compatibility with redis 3.2 and newer.
<code class="docutils literal notranslate"><span class="pre">RB_ID=913516</span></code></p></li>
</ul>
</section>
<section id="id286">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id286" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Responses with a server error status code (500s) are now classified
as a failure. This effects success rate metrics and failure accrual.
See the <cite>com.twitter.finagle.http.serverErrorsAsFailuresV2</cite> toggle for opting
out of this behavior. <code class="docutils literal notranslate"><span class="pre">RB_ID=909315</span></code></p></li>
<li><p>finagle-netty4: Servers no longer set SO_LINGER=0 on sockets. <code class="docutils literal notranslate"><span class="pre">RB_ID=907325</span></code></p></li>
</ul>
</section>
<section id="id287">
<h3>Deprecations<a class="headerlink" href="#id287" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-base-http: The <cite>c.t.f.http.Response</cite> methods <cite>getStatusCode()</cite> and <cite>setStatusCode()</cite>
have been deprecated. Use the methods <cite>statusCode</cite> and <cite>statusCode(Int)</cite> instead.
<code class="docutils literal notranslate"><span class="pre">RB_ID=908409</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.builder.ClientBuilder.group</cite> and <cite>c.t.f.builder.ClientBuilder.cluster</cite>
have been deprecated. Use <cite>c.t.f.builder.ClientBuilder.dest</cite> with a <cite>c.t.f.Name</cite> instead.
<code class="docutils literal notranslate"><span class="pre">RB_ID=914879</span></code></p></li>
<li><p>finagle-http: Now that <cite>c.t.f.http.Method</cite> and <cite>c.t.f.http.Version</cite> are represented by
instances and thus easier to use from Java, the Java helpers <cite>c.t.f.http.Versions</cite>,
<cite>c.t.f.http.Statuses</cite>, and <cite>c.t.f.http.Methods</cite> have been deprecated. <code class="docutils literal notranslate"><span class="pre">RB_ID=907680</span></code></p></li>
<li><p>finagle-memcached: <cite>c.t.f.memcached.replication.ReplicationClient</cite> is now deprecated. Use
<cite>c.t.f.memcached.replication.BaseReplicationClient</cite> with clients created using
<cite>c.t.f.Memcached.client</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=907384</span></code></p></li>
<li><p>finagle-thrift: As part of the Netty 4 migration, all <cite>c.t.f.Codec</cite> and <cite>c.t.f.CodecFactory</cite>
types in finagle-thrift are now deprecated. Use the <cite>c.t.f.Thrift</cite> object to make clients
and servers. <code class="docutils literal notranslate"><span class="pre">RB_ID=907626</span></code></p></li>
</ul>
</section>
<section id="id288">
<h3>Bug Fixes<a class="headerlink" href="#id288" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Fix <cite>ConcurrentModificationException</cite> thrown by calling <cite>close()</cite> on
<cite>c.t.f.factory.ServiceFactoryCache</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=910407</span></code></p></li>
<li><p>finagle-http: The HTTP/1.x Client will no longer force-close the socket after receiving
a response that lacks content-length and transfer-encoding headers but is required per
RFC 7230 to not have a body. <code class="docutils literal notranslate"><span class="pre">RB_ID=908593</span></code></p></li>
<li><p>finagle-redis: The HSCAN and SCAN commands take an optional argument for pattern matching.
This argument has been fixed to use the correct name of ‘MATCH’ instead of the incorrect
‘PATTERN’. <code class="docutils literal notranslate"><span class="pre">RB_ID=908817</span></code></p></li>
<li><p>finagle-thrift: Properly locate sub-classed MethodIface services to instantiate for serving
BaseServiceIface implemented thrift services. <code class="docutils literal notranslate"><span class="pre">RB_ID=907608</span></code></p></li>
<li><p>finagle-redis: The SentinelClient will no longer throw an NoSuchElementException when
initializing connections to a redis 3.2 or greater sentinel server. <code class="docutils literal notranslate"><span class="pre">RB_ID=913516</span></code></p></li>
</ul>
</section>
<section id="id289">
<h3>Dependencies<a class="headerlink" href="#id289" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Bump guava to 19.0. <code class="docutils literal notranslate"><span class="pre">RB_ID=907807</span></code></p></li>
</ul>
</section>
</section>
<section id="id290">
<h2>6.42.0<a class="headerlink" href="#id290" title="Permalink to this headline">¶</a></h2>
<section id="id291">
<h3>New Features<a class="headerlink" href="#id291" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-commons-stats: Provide a TwitterServer exporter for commons stats.
This simplifies migration for folks who don’t want to switch to
commons metrics and TwitterServer in one go.  It will export stats on the
/vars.json endpoint.  <code class="docutils literal notranslate"><span class="pre">RB_ID=902921</span></code></p></li>
<li><p>finagle-http: Introduce <cite>HeaderMap.getOrNull(header)</cite>, a Java-friendly variant of
<cite>HeaderMap.get(header).orNull</cite>.  <code class="docutils literal notranslate"><span class="pre">RB_ID=904093</span></code></p></li>
</ul>
</section>
<section id="id292">
<h3>Breaking API Changes<a class="headerlink" href="#id292" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle: finagle-http-compat has been removed as part of migration off Netty 3. Use
finagle-http types/APIs directly. <code class="docutils literal notranslate"><span class="pre">RB_ID=903647</span></code></p></li>
<li><p>finagle: finagle-spdy has been removed as part of the migration off Netty 3. Please
use finagle-http2 as a replacement. <code class="docutils literal notranslate"><span class="pre">RB_ID=906033</span></code></p></li>
<li><p>finagle-base-http: <cite>Message.write(ChannelBuffer)</cite> has been replaced with a method that
receives a <cite>Buf</cite>. The semantics of calling the <cite>write</cite> method on chunked messages has
changed from potentially throwing an exception based on the state of the <cite>Writer</cite> to
always throwing an <cite>IllegalStateException</cite>. Existing users of the <cite>write(..)</cite> methods
on chunked messages should use the <cite>Writer</cite> directly. <code class="docutils literal notranslate"><span class="pre">RB_ID=900091</span></code></p></li>
<li><p>fingle-base-http: <cite>HeaderMap.getAll(key)</cite> now returns a <cite>Seq[String]</cite> as opposed to a
<cite>Iterable[String]</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=905019</span></code></p></li>
<li><p>finagle-core: The ChannelTransport implementations which transforms a Netty pipeline into
a finagle Transport[Req, Rep] have been specialized to Transport[Any, Any] to avoid the
illusion of a runtime checked cast. Transport.cast has been changed to receive either a
Class[T] or an implicit Manifest[T] in order to check the inbound cast at runtime. For users
of the ChannelTransport types, use the Transport.cast method to get a Transport of the right
type. <code class="docutils literal notranslate"><span class="pre">RB_ID=902053</span></code></p></li>
<li><dl class="simple">
<dt>finagle-memcached: Remove deprecated methods on <cite>c.t.f.memcached.Client</cite>:</dt><dd><ul class="simple">
<li><p><cite>apply(group: Group[SocketAddress])</cite></p></li>
<li><p><cite>apply(cluster: Cluster[SocketAddress])</cite></p></li>
</ul>
</dd>
</dl>
<p>Use <cite>c.t.f.Memcached.client</cite> to create a Memcached client. <code class="docutils literal notranslate"><span class="pre">RB_ID=899331</span></code></p>
</li>
<li><p>finagle-toggle: <cite>ToggleMap</cite> <cite>Toggles</cite> now rehash the inputs to
<cite>apply</cite> and <cite>isDefinedAt</cite> in order to promote a relatively even
distribution even when the inputs do not have a good distribution.
This allows users to get away with using a poor hashing function
such as <cite>String.hashCode</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=899195</span></code></p></li>
</ul>
</section>
<section id="id293">
<h3>Deprecations<a class="headerlink" href="#id293" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-base-http: Deprecate <cite>c.t.f.http.MapHeaderMap</cite> as it will
soon be private. Use <cite>c.t.f.http.HeaderMap.apply(..)</cite> to get a HeaderMap
instance. <code class="docutils literal notranslate"><span class="pre">RB_ID=906497</span></code></p></li>
<li><p>finagle-base-http: Deprecate <cite>c.t.f.http.HeaderMap += (String, Date)</cite>.
Use <cite>c.t.f.http.HeaderMap.set(String, Date)</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=906497</span></code></p></li>
<li><p>finagle-base-http: Deprecate <cite>c.t.f.http.Message.ContentTypeWwwFrom</cite>.
Use <cite>c.t.f.http.Message.ContentTypeWwwForm</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=901041</span></code></p></li>
<li><p>finagle-base-http: Deprecate <cite>c.t.f.http.Message.headers()</cite>. Use
<cite>c.t.f.http.Message.headerMap</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=905019</span></code></p></li>
<li><p>finagle-base-http: Deprecate the lazy <cite>response: Response</cite> field on the Request type.
This field is potentially hazardous as it’s not necessarily the Response that will
be returned by a Service but it is often used as such. Construct a Response using
the static constructor methods. <code class="docutils literal notranslate"><span class="pre">RB_ID=899983</span></code></p></li>
<li><p>finagle-base-http: Numerous protected[finagle] methods on <cite>http.Request</cite> and
<cite>http.Response</cite> that deal in Netty 3 types have been deprecated as part of the
migration to Netty 4. <code class="docutils literal notranslate"><span class="pre">RB_ID=905761</span></code></p></li>
<li><p>finagle-http: Deprecate ValidateRequestFilter which now has limited utility.
See entry in Runtime Behavior Changes. If this is still needed, copy the remaining
behavior into a new filter. <code class="docutils literal notranslate"><span class="pre">RB_ID=899895</span></code></p></li>
<li><dl class="simple">
<dt>finagle-memcached: Deprecate methods on <cite>c.t.f.memcached.Client</cite>:</dt><dd><ul class="simple">
<li><p><cite>apply(name: Name)</cite></p></li>
<li><p><cite>apply(host: String)</cite></p></li>
</ul>
</dd>
</dl>
<p>Use <cite>c.t.f.Memcached.client</cite> to create a Memcached client. <cite>RB_ID=899331`</cite></p>
</li>
<li><p>finagle-memcached: Deprecate <cite>c.t.f.memcached.protocol.text.Memcached</cite> object.
Use <cite>c.t.f.Memcached.client</cite> to create Memcached clients. <code class="docutils literal notranslate"><span class="pre">RB_ID=899009</span></code></p></li>
<li><dl class="simple">
<dt>finagle-memcached: Deprecations on <cite>c.t.f.memcached.util.ParserUtils</cite>:</dt><dd><ul class="simple">
<li><p>For <cite>isDigits(ChannelBuffer)</cite> use <cite>ParserUtils.isDigits(Buf)</cite> instead.</p></li>
<li><p><cite>DIGITS</cite></p></li>
<li><p><cite>DigitsPattern</cite></p></li>
</ul>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">RB_ID=905253</span></code></p>
</li>
</ul>
</section>
<section id="id294">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id294" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: The HTTP client will no longer emit a Netty 3/4 <cite>TooLongFrameException</cite> when
a response exceeds the specified MaxResponseSize parameter, and instead emits a Finagle
specific <cite>TooLongMessageException</cite> which wraps the Netty exception. <code class="docutils literal notranslate"><span class="pre">RB_ID=905567</span></code></p></li>
<li><p>finagle-http: ValidateRequestFilter doesn’t look for the uri “/bad-http-request” which
had been indicative of the netty3 http codec giving up on decoding a http request. These
events are caught lower in the pipeline and should not bubble up to the level of this
filter. <code class="docutils literal notranslate"><span class="pre">RB_ID=899895</span></code></p></li>
<li><p>finagle-netty4: DirectToHeapHandler is now aware of <cite>ByteBufHolder</cite> types hence can copy
them on to heap. <code class="docutils literal notranslate"><span class="pre">RB_ID=906602</span></code></p></li>
<li><p>finagle-redis: Transport implementation is now based on Netty 4 (instead of Netty 3).
<code class="docutils literal notranslate"><span class="pre">RB_ID=895728</span></code></p></li>
</ul>
</section>
<section id="id295">
<h3>Bug Fixes<a class="headerlink" href="#id295" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Properly compute length when converting a <cite>Buf.ByteArray</cite>
to a Netty 4 <cite>ByteBuf</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=901605</span></code></p></li>
<li><p>finagle-memcached: AtomicMap change lock function to synchronize on map
object. <code class="docutils literal notranslate"><span class="pre">DIFF_ID=D18735</span></code></p></li>
<li><p>finagle-netty4: Fixed connection stall in Finagle clients configured with
both HTTP proxy (<cite>Transporter.HttpProxyTo</cite>) and TLS/SSL enabled. <code class="docutils literal notranslate"><span class="pre">RB_ID=904831</span></code></p></li>
<li><p>finagle-netty4: Fixed connection stall in Finagle clients configured with
both HTTP proxy (<cite>Transporter.HttpProxy</cite>) and TLS/SSL enabled. <code class="docutils literal notranslate"><span class="pre">RB_ID=904803</span></code></p></li>
</ul>
</section>
</section>
<section id="id296">
<h2>6.41.0<a class="headerlink" href="#id296" title="Permalink to this headline">¶</a></h2>
<section id="id297">
<h3>New Features<a class="headerlink" href="#id297" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Added stat “pending_requests/rejected” for the number of requests
rejected by <cite>c.t.f.PendingRequestFilter</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=898184</span></code></p></li>
</ul>
</section>
<section id="id298">
<h3>Breaking API Changes<a class="headerlink" href="#id298" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core:  Remove the <cite>Filter#andThen(Req1 =&gt; Future[Rep1]): Req2 =&gt; Future[Rep2]</cite>
method.  This overload is no longer usable in scala 2.12, because <cite>Service</cite>
is a SAM.  Because of the order in which SAMs get resolved, literal
functions in scala will get confused about which method they should use.
Instead of passing a Function directly, wrap the Function with a Service.mk.
<code class="docutils literal notranslate"><span class="pre">RB_ID=896524</span></code></p></li>
<li><p>finagle-core: <cite>CancelledWriteException</cite> was removed as it is no longer used.
<code class="docutils literal notranslate"><span class="pre">RB_ID=896757</span></code></p></li>
<li><p>finagle-core: The structure of Context and its subtypes, LocalContext and
MarshalledContext, have been significantly refined, eliminating StackOverflowErrors
and memory leaks while also refining the API. The <cite>letClear()</cite> method, which cleared all
items from the context, has been renamed to <cite>letClearAll</cite> to avoid confusion with other
<cite>letClear</cite> methods which clear individual keys. The bulk <cite>letClear</cite> method now takes
a collection of <cite>Key[_]`s, making it usable from Java. Bulk `let</cite> operations can now be
done using a collection of <cite>KeyValuePair`s. ``RB_ID=896663`</cite></p></li>
<li><p>finagle-kestrel: The <cite>codec</cite> method has been removed from the kestrel
MultiReader object. Configure a ClientBuilder protocol using the default
thrift StackClient, Thrift.client, via the <cite>stack</cite> method of ClientBuilder.
<code class="docutils literal notranslate"><span class="pre">RB_ID=894297</span></code></p></li>
<li><p>finagle-memcached: Remove deprecated <cite>cluster</cite> method on <cite>c.t.f.memcached.KetamaClientBuilder</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=898365</span></code></p></li>
</ul>
</section>
<section id="id299">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id299" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-core: <cite>c.t.f.builder.ClientBuilder</cite> remove deprecated methods.
The same functionality is available through the Stack-based APIs or
<cite>ClientBuilder.configured</cite>, with the exception of <cite>channelFactory</cite>, which
has no analog because it exposes a Netty 3 API. <code class="docutils literal notranslate"><span class="pre">RB_ID=893147</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p><cite>channelFactory</cite></p></li>
<li><p><cite>expHostConnectionBufferSize</cite></p></li>
<li><p><cite>hostConnectionIdleTime</cite></p></li>
<li><p><cite>hostConnectionMaxIdleTime</cite></p></li>
<li><p><cite>hostConnectionMaxLifeTime</cite></p></li>
<li><p><cite>hostConnectionMaxWaiters</cite></p></li>
<li><p><cite>readerIdleTimeout</cite></p></li>
<li><p><cite>recvBufferSize</cite></p></li>
<li><p><cite>sendBufferSize</cite></p></li>
<li><p><cite>writerIdleTimeout</cite></p></li>
</ul>
</div></blockquote>
</li>
<li><p>finagle-core: Lower logging level used in <cite>c.t.f.util.DefaultMonitor</cite> for expected
exceptions: <cite>CancelledRequestException</cite>, <cite>TooManyWaitersException</cite>,
<cite>CancelledConnectionException</cite>, <cite>FailedFastException</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=895702</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.util.DefaultMonitor</cite> now logs most exceptions at
<cite>WARNING</cite> level instead of <cite>FATAL</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=895983</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.util.DefaultMonitor</cite> works harder to find the appropriate
log level by walking the exception’s causes to find <cite>c.t.util.TimeoutExceptions</cite>
and <cite>c.t.logging.HasLogLevel</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=896695</span></code></p></li>
<li><p>finagle-core: The <cite>c.t.f.service.Retries</cite> module will now flag a response as
<cite>NonRetryable</cite> if either the retry limit is reached or the retry budget is exhausted.
<code class="docutils literal notranslate"><span class="pre">RB_ID=897800</span></code></p></li>
<li><p>finagle-mdns: Uses only one implementation backed by jmdns instead of trying
to use a platform specific implementation of DDNS if present. <code class="docutils literal notranslate"><span class="pre">RB_ID=897917</span></code></p></li>
<li><p>finagle-netty4: Client initiated TLS/SSL session renegotiations are now rejected
by default. <code class="docutils literal notranslate"><span class="pre">RB_ID=895871</span></code></p></li>
<li><p>finagle-netty4: <cite>ChannelTransport</cite> no longer interrupts netty write operations
in order to temporarily unblock rollout of netty4. This reverts netty4 back
to netty3 semantics for writes. <code class="docutils literal notranslate"><span class="pre">RB_ID=896757</span></code></p></li>
</ul>
</section>
<section id="id300">
<h3>Deprecations<a class="headerlink" href="#id300" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-kestrel: Deprecate the <cite>codec</cite> method on <cite>c.t.f.kestrel.MultiReaderMemcache</cite>.
Use <cite>.stack(Kestrel.client)</cite> on the configured <cite>c.t.f.builder.ClientBuilder</cite> instead.
<code class="docutils literal notranslate"><span class="pre">RB_ID=895989</span></code></p></li>
</ul>
</section>
</section>
<section id="id301">
<h2>6.40.0<a class="headerlink" href="#id301" title="Permalink to this headline">¶</a></h2>
<section id="id302">
<h3>New Features<a class="headerlink" href="#id302" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Most libraries (excluding finagle-thrift{,mux}) no longer need to
add an additional resolver that points to maven.twttr.com. <code class="docutils literal notranslate"><span class="pre">RB_ID=878967</span></code></p></li>
<li><p>finagle: Introducing a new Finagle module <cite>finagle-base-http</cite> that provides
a common ground for both Netty 3 (<cite>finagle-http</cite>) and Netty 4 (<cite>finagle-netty4-http</cite>)
HTTP implementations. Netty 3 is still a default transport used in Finagle’s
<cite>Http.client</cite> and <cite>Http.server</cite>. <code class="docutils literal notranslate"><span class="pre">`RB_ID=884614</span></code></p></li>
<li><p>finagle-core: Introduce the <cite>c.t.f.client.DynamicTimeout</cite> module allowing clients
to specify call-site specific timeouts. <code class="docutils literal notranslate"><span class="pre">RB_ID=885005</span></code></p></li>
<li><p>finagle-core: A new module, <cite>c.t.f.service.DeadlineFilter</cite>, can be added to stack-based servers
and clients, which rejects requests with expired deadlines <code class="docutils literal notranslate"><span class="pre">RB_ID=895820</span></code></p></li>
<li><p>finagle-memcached: Introduce <cite>c.t.f.memcached.CasResult.replaced: Boolean</cite>
to help transition usage off of the deprecated <cite>cas</cite> client method to
<cite>checkAndSet</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=891628</span></code></p></li>
<li><p>finagle-thrift: We now depend on a fork of libthrift hosted in the Central Repository.
The new package lives in the ‘com.twitter’ organization. This removes the necessity of
depending on maven.twttr.com. This also means that eviction will not be automatic and
using a newer libthrift library requires manual eviction if artifacts are being pulled
in transitively. <code class="docutils literal notranslate"><span class="pre">RB_ID=885879</span></code></p></li>
</ul>
</section>
<section id="id303">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id303" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>Monitor</cite> logging is improved in Finagle. <code class="docutils literal notranslate"><span class="pre">RB_ID=878890</span></code></p>
<ul>
<li><p>All exceptions caught in the stack are now logged by Finagle’s <cite>DefaultMonitor</cite>
(previously Util’s <cite>RootMonitor</cite>) such that Twitter’s logging
framework is used instead of JDK logging.</p></li>
<li><p><cite>DefaultMonitor</cite> is now installed implicitly such that it will be composed
(via <cite>orElse</cite>) with the monitor passed by a user through the stack param.
The logic behind this compostion is quite straightforward: exceptions that
are’t handled by a user-defined monitor propagated to the default monitor.</p></li>
<li><p><cite>DefaultMonitor</cite> now logs upstream socket address, downstream socket address,
and a client/server label if those are available.</p></li>
<li><p><cite>RootMonitor</cite> is still used to handle fatal exceptions from pending side-effect-only
closures (i.e., <cite>onFailure</cite>, <cite>onSuccess</cite>) on a service future/promise.</p></li>
</ul>
</li>
<li><p>finagle-core: <cite>c.t.f.service.DeadlineStatsFilter</cite> has been removed from the
server stack, along with all related stats.
The “admission_control/deadline/transit_latency_ms” stat has been moved to
<cite>c.t.f.filter.ServerStatsFilter</cite> and re-scoped as “transit_latency_ms”
<code class="docutils literal notranslate"><span class="pre">RB_ID=895820</span></code></p></li>
<li><p>finagle-mux: <cite>com.twitter.finagle.Failures</cite> are now sent over the wire with
their flags intact via <cite>com.twitter.finagle.mux.transport.MuxFailure</cite> in the
previously unused Rdispatch context. This allows for greater signaling along
a chain of services. See the “MuxFailure Flags” section of the mux protocol
spec in finagle-mux/src/main/scala/c/t/f/mux/package.scala <code class="docutils literal notranslate"><span class="pre">RB_ID=882431</span></code></p></li>
<li><p>finagle-netty4: The netty4 listener + transporter no longer manage direct byte
buffers by default. c.t.f.netty4.channel.DirectToHeapInboundHandler is introduced
to help protocol builders manage them. <code class="docutils literal notranslate"><span class="pre">RB_ID=881648</span></code></p></li>
<li><p>finagle-stats: Changed the default behavior of empty histograms to only export
the count. Thus the <cite>com.twitter.finagle.stats.exportEmptyHistograms</cite> toggle
now defaults to <cite>0.0</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=882522</span></code></p></li>
</ul>
</section>
<section id="id304">
<h3>Breaking API Changes<a class="headerlink" href="#id304" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: Some APIs around configuring TLS/SSL on Finagle clients have changed to
unblock Netty 4 adoption. <code class="docutils literal notranslate"><span class="pre">RB_ID=890935</span></code></p>
<ul>
<li><p><cite>c.t.f.Http.client.withTls(Netty3TransporterTLSConfig)</cite> is removed. Use
variations of <cite>c.t.f.Http.client.withTransport.tls</cite> instead.</p></li>
<li><p><cite>c.t.f.netty3.Netty3TransporterTLSConfig</cite> is removed.</p></li>
</ul>
</li>
<li><p>finagle: Some APIs around configuring TLS/SSL on Finagle servers have changed to
unblock Netty 4 adoption. <code class="docutils literal notranslate"><span class="pre">RB_ID=891270</span></code></p>
<ul>
<li><p><cite>c.t.f.Http.server.withTls(Netty3ListenerTLSConfig)</cite> is removed. Use
variations of <cite>c.t.f.Http.server.withTransport.tls</cite> instead.</p></li>
<li><p><cite>c.t.f.netty3.Netty3ListenerTLSConfig</cite> is removed.</p></li>
</ul>
</li>
<li><p>finagle-core: Removed the protected and unused method <cite>read(permit: Permit): Future[Rep]</cite>
from <cite>SerialClientDispatcher</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=881978</span></code></p></li>
<li><p>finagle-core: Removed a gauge, <cite>idle</cite>, from <cite>c.t.f.factory.ServiceFactoryCache</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=884210</span></code></p></li>
<li><p>finagle-core: <cite>ServiceTimeoutException</cite> now extends <cite>NoStackTrace</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=886809</span></code></p></li>
<li><p>finagle-core: Marked <cite>com.twitter.finagle.util.ConcurrentRingBuffer</cite> as
private.  It doesn’t fit the typical programming model we encourage for
users of finagle, and so we found it was rarely used.  <code class="docutils literal notranslate"><span class="pre">RB_ID=888801</span></code></p></li>
<li><p>finagle-core: Marked <cite>transform</cite> in <cite>com.twitter.finagle.Stack</cite> as protected. It is
too powerful and unnecessary for users, and should be used by implementors only.</p></li>
<li><p>finagle-core: Removed the <cite>StatsReceiver</cite> argument from <cite>TimeoutFilter</cite>.  <code class="docutils literal notranslate"><span class="pre">RB_ID=891380</span></code></p></li>
<li><p>finagle-core: Stopped exporting a few metrics related to deadlines, and replaced with a simpler
one.  There was a per-<cite>TimeoutFilter</cite> one named <cite>timeout/expired_deadline_ms</cite>, and a per-server
one named <cite>admission_control/deadline/deadline_budget_ms</cite>.  We added instead a per-server one
named <cite>admission_control/deadline/exceeded_ms</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=891380</span></code></p></li>
<li><p>finagle-http: HttpMuxer now takes in a Seq[Route] instead of a
Seq[(String, Service[Request, Response])]. <code class="docutils literal notranslate"><span class="pre">RB_ID=886829</span></code></p></li>
<li><p>finagle-http: As part of the first step towards restructuring Finagle HTTP modules
required for Netty 4 adoption, HTTP params are moved from the inner object <cite>c.t.f.Http.param</cite>
into their own package <cite>c.t.f.http.param</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=885155</span></code></p></li>
<li><p>finagle-redis: A couple of methods had to be renamed (and return type changed) to
unblock Netty 4 adoption. <code class="docutils literal notranslate"><span class="pre">RB_ID=882622</span></code></p>
<ul>
<li><p><cite>Command.toChannelBuffer</cite> renamed to <cite>Command.toBuf</cite> and return
type changed from N3 <cite>ChannelBuffer</cite> to Finagle <cite>Buf</cite>.</p></li>
<li><p><cite>Command.toByteArray</cite> is removed.</p></li>
<li><p>Both <cite>Command.key</cite> and <cite>Command.value</cite> now implemented in terms of <cite>Buf`s
(no `ChannelBuffers</cite>).</p></li>
</ul>
</li>
<li><p>finagle-redis: An API around <cite>c.t.f.redis.protocol.Command</cite> was modernized as part of
major restructuring required for the Netty 4 adoption. <code class="docutils literal notranslate"><span class="pre">RB_ID=885811</span></code></p>
<ul>
<li><p><cite>RedisMessage</cite> (a common parent for both <cite>Command</cite> and <cite>Reply</cite>) has been removed.</p></li>
<li><p>The encoding machinery was restructured to eliminate duplicated and dead code.</p></li>
</ul>
</li>
<li><p>finagle-thrift: Removed deprecated <cite>ThriftRichClient.newServiceIface</cite> methods
which did not take a label. Use the versions that take a String label.
<code class="docutils literal notranslate"><span class="pre">RB_ID=891004</span></code></p></li>
<li><p>finagle-thrift: Removed deprecated <cite>ThriftRichClient.newIface</cite> methods based
on <cite>Groups</cite>. Use the versions that a <cite>dest</cite> or <cite>Name</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=891004</span></code></p></li>
<li><p>finagle-thriftmux: Removed deprecated classes <cite>ThriftMuxClient</cite>, <cite>ThriftMuxClientLike</cite>,
<cite>ThriftMuxServer</cite>, and <cite>ThriftMuxServerLike</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=880924</span></code></p></li>
</ul>
</section>
<section id="id305">
<h3>Bug Fixes<a class="headerlink" href="#id305" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The <cite>withTlsWithoutValidation</cite> and <cite>tlsWithoutValidation</cite>
APIs have been fixed for an issue on Java 8 where certificate validation
was being attempted instead of bypassed. <code class="docutils literal notranslate"><span class="pre">RB_ID=881660</span></code></p></li>
<li><p>finagle-http: The toggle implementation for <cite>com.twitter.finagle.http.serverErrorsAsFailures</cite>
had a bug when toggled on. That toggle is no longer used and is superseded by
<cite>com.twitter.finagle.http.serverErrorsAsFailuresV2</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=882151</span></code></p></li>
<li><p>finagle-netty4: Connecting to a Socks 5 proxy using Finagle with Netty 4
now works properly. This previously resulted in a timeout and
<cite>ProxyConnectException</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=884344</span></code></p></li>
<li><p>finagle-netty4: Don’t swallow bind failures. <code class="docutils literal notranslate"><span class="pre">RB_ID=892217</span></code></p></li>
</ul>
</section>
<section id="id306">
<h3>Deprecations<a class="headerlink" href="#id306" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-core: <cite>c.t.f.builder.ClientBuilder</cite> deprecate some seldom used methods.
The same functionality is available through the Stack-based APIs or
<cite>ClientBuilder.configured</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=881612</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p><cite>hostConnectionIdleTime</cite></p></li>
<li><p><cite>hostConnectionMaxIdleTime</cite></p></li>
<li><p><cite>hostConnectionMaxLifeTime</cite></p></li>
<li><p><cite>hostConnectionMaxWaiters</cite></p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
</section>
<section id="id307">
<h2>6.39.0<a class="headerlink" href="#id307" title="Permalink to this headline">¶</a></h2>
<section id="id308">
<h3>New Features<a class="headerlink" href="#id308" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>com.twitter.finagle.Failure</cite> has a new flag, <cite>NonRetryable</cite>,
which signifies that a request should not be retried. The flag is respected by
all of Finagle’s retry mechanisms. <code class="docutils literal notranslate"><span class="pre">RB_ID=878766</span></code></p></li>
<li><p>finagle-thriftmux: Allow ThriftMux.Clients to be filtered. This is supported
in the the StdStackClient but ThriftMux.Client is a StackBasedClient. <code class="docutils literal notranslate"><span class="pre">RB_ID=874560</span></code></p></li>
<li><p>finagle-netty4: Add boolean flag <cite>com.twitter.finagle.netty4.poolReceiveBuffers</cite> that
enables/disables pooling of receive buffers (disabled by default). When enabled, lowers
the CPU usage and allocation rate (GC pressure) with the cost of increased memory
footprint at the startup. <code class="docutils literal notranslate"><span class="pre">RB_ID=872940</span></code></p></li>
<li><p>finagle-netty4: Add new histogram <cite>receive_buffer_bytes</cite> (only enabled with pooling)
to keep track of the receive buffer sizes (useful for tuning pooling). <code class="docutils literal notranslate"><span class="pre">RB_ID=877080</span></code></p></li>
</ul>
</section>
<section id="id309">
<h3>Deprecations<a class="headerlink" href="#id309" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.builder.ClientBuilder</cite> deprecate some seldom used methods.
The same functionality is available through the Stack-based APIs or
<cite>ClientBuilder.configured</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=878009</span></code></p>
<ul>
<li><p><cite>readerIdleTimeout</cite></p></li>
<li><p><cite>writerIdleTimeout</cite></p></li>
<li><p><cite>recvBufferSize</cite></p></li>
<li><p><cite>sendBufferSize</cite></p></li>
<li><p><cite>channelFactory</cite></p></li>
<li><p><cite>expHostConnectionBufferSize</cite></p></li>
</ul>
</li>
<li><p>finagle-kestrel: Deprecate <cite>c.t.f.kestrel.protocol.Kestrel()</cite>,
<cite>c.t.f.kestrel.protocol.Kestrel(failFast)</cite>, and <cite>c.t.f.kestrel.protocol.Kestrel.get()</cite>.
To create a Kestrel client using ClientBuilder, use <cite>.stack(c.t.f.Kestrel.client)</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=870686</span></code></p></li>
</ul>
</section>
<section id="id310">
<h3>Breaking API Changes<a class="headerlink" href="#id310" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The constructors for both <cite>c.t.f.netty3.Netty3Listener</cite> and
<cite>c.t.f.netty3.Netty3Transporter</cite> now take <cite>Stack.Params</cite> instead of
individual parameters. <code class="docutils literal notranslate"><span class="pre">RB_ID=871251</span></code></p></li>
<li><p>finagle-thrift: The c.t.f.thrift.legacy package has been removed which included
the public types <cite>ThriftCall</cite>, <cite>ThriftReply</cite>, and <cite>ThriftCallFactory</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=873982</span></code></p></li>
</ul>
</section>
<section id="id311">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id311" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Tolerate TraceIds that are greater than 64 bits in preparation of
moving to 128 bit ids. <code class="docutils literal notranslate"><span class="pre">RB_ID=874365</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.http.service.HttpResponseClassifier.ServerErrorsAsFailures</cite> now
classifies a retryable nack as a <cite>ResponseClass.RetryableFailure</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=869182</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.Http.{Client,Server}</cite> is moving towards treating HTTP
5xx status codes as failures via
<cite>c.t.f.http.service.HttpResponseClassifier.ServerErrorsAsFailures</cite>. This can
be disabled by setting the toggle “com.twitter.finagle.http.serverErrorsAsFailures”
to <cite>0.0</cite> or explicitly setting it using <cite>withResponseClassifier</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=869303</span></code>, <code class="docutils literal notranslate"><span class="pre">RB_ID=875367</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.http.HttpServerDispatcher</cite> now removes the bodies from responses
to HEAD requests in order to avoid a HTTP protocol error and logs the event at level
error. Associated with this, the <cite>c.t.f.http.filter.HeadFilter</cite> will now strip the body
from a chunked response, but in these cases the <cite>Writer</cite> associated with the response
will receive a <cite>ReaderDiscarded</cite> exception if a write is attempted after the filter has
run. <code class="docutils literal notranslate"><span class="pre">RB_ID=872106</span></code></p></li>
<li><p>finagle-thrift: Also track response failures in the
<cite>c.t.finagle.thrift.ThriftServiceIface#statsFilter</cite> in addition to successful
responses that encode an Error or Exception. <code class="docutils literal notranslate"><span class="pre">RB_ID=879075</span></code></p></li>
</ul>
</section>
<section id="id312">
<h3>Bug Fixes<a class="headerlink" href="#id312" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Fix issue in <cite>c.t.finagle.http.RequestBuilder</cite> when the URI host contains
underscores. <code class="docutils literal notranslate"><span class="pre">RB_ID=870978</span></code></p></li>
<li><p>finagle-http: A connection for HTTP/1.0 or non-keep-alive requests is now closed
gracefully so that all requests that have been issued received responses.
<code class="docutils literal notranslate"><span class="pre">RB_ID=868767</span></code></p></li>
<li><p>finagle-http: The HTTP/1.x server dispatcher no longer clobbers ‘Connection: close’
headers set by a service, resulting in the graceful shutdown of the connection.
<code class="docutils literal notranslate"><span class="pre">RB_ID=880007</span></code></p></li>
<li><p>finagle-netty4: <cite>ChannelTransport</cite> now drains messages before reading more data off the
transport which should reduce memory pressure in streaming protocols. <code class="docutils literal notranslate"><span class="pre">RB_ID=872639</span></code></p></li>
</ul>
</section>
</section>
<section id="id313">
<h2>6.38.0<a class="headerlink" href="#id313" title="Permalink to this headline">¶</a></h2>
<section id="id314">
<h3>New Features<a class="headerlink" href="#id314" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: <cite>HttpNackFilter</cite> now handles both retryable and non-retryable nacks via a new
header: “finagle-http-nonretryable-nack”. These are converted to non-retryable <cite>c.t.f.Failures</cite>
and counted by a new counter “nonretryable_nacks”. <code class="docutils literal notranslate"><span class="pre">RB_ID=865468</span></code></p></li>
<li><p>finagle-toggle: Is no longer considered experimental. <code class="docutils literal notranslate"><span class="pre">RB_ID=868819</span></code></p></li>
</ul>
</section>
<section id="id315">
<h3>Breaking API Changes<a class="headerlink" href="#id315" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-kestrel: <cite>c.t.f.kestrel.protocol.ResponseToEncoding</cite> is now private[finagle].
<code class="docutils literal notranslate"><span class="pre">RB_ID=866612</span></code></p></li>
<li><p>finagle-memcached: <cite>c.t.f.memcached.protocol.text.{CommandToEncoding, ResponseToEncoding}</cite>,
<cite>c.t.f.memcached.protocol.text.client.{AbstractDecodingToResponse, ClientTransport, DecodingToResponse}</cite> are now private[finagle]. <code class="docutils literal notranslate"><span class="pre">RB_ID=866612</span></code></p></li>
<li><p>finagle-netty4: Move <cite>numWorkers</cite> flag out of the package object so it gets a
user friendly name: <cite>c.t.f.netty4.numWorkers</cite> instead of <cite>c.t.f.netty4$.package$.numWorkers</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=123567</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.netty3.WorkerPool</cite> is no longer visible outside of <cite>c.t.f.netty3</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=123567</span></code></p></li>
<li><p>finagle-core: The <cite>content</cite> parameter of the <cite>ClientSslContext</cite> and
<cite>ClientSslContextAndHostname</cite> <cite>TlsConfig</cite> options has been renamed to <cite>context</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=868791</span></code></p></li>
</ul>
</section>
<section id="id316">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id316" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-thriftmux: Removed “&lt;server_label&gt;/thriftmux/downgraded_connections” and
“&lt;server_label&gt;/thriftmux/connections” gauges. Counters are still available at
“&lt;server_label&gt;/thrifmux/connects” and “&lt;server_label&gt;thriftmux/downgraded_connects”.
<code class="docutils literal notranslate"><span class="pre">RB_ID=867459</span></code></p></li>
</ul>
</section>
</section>
<section id="id317">
<h2>6.37.0<a class="headerlink" href="#id317" title="Permalink to this headline">¶</a></h2>
<section id="id318">
<h3>Deprecations<a class="headerlink" href="#id318" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.Deadline</cite> is deprecated in favor of <cite>c.t.f.context.Deadline</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=864148</span></code></p></li>
</ul>
</section>
<section id="id319">
<h3>Breaking API Changes<a class="headerlink" href="#id319" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-core: As part of a move away from encoding/decoding in the Netty pipeline, removed
<cite>FrameEncoder</cite> and <cite>FrameDecoder</cite> types, found in <cite>c.t.f.codec</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=847716</span></code></p></li>
<li><p>finagle-core: Delete IdleConnectionFilter, which is no longer hooked up in the server, and
no longer seems to be useful.  <code class="docutils literal notranslate"><span class="pre">RB_ID=856377</span></code></p></li>
<li><p>finagle-core: Remove deprecated methods from <cite>c.t.f.builder.ClientBuilder</cite> <code class="docutils literal notranslate"><span class="pre">RB_ID=864622</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p><cite>connectionTimeout</cite>, use <cite>tcpConnectTimeout</cite></p></li>
<li><p><cite>expFailFast</cite>, use <cite>failFast</cite></p></li>
<li><p><cite>buildFactory</cite>, use other <cite>buildFactory</cite> methods</p></li>
<li><p><cite>build</cite>, use other <cite>build</cite> methods</p></li>
</ul>
</div></blockquote>
</li>
<li><p>finagle-exp: Abstract out parts of the DarkTrafficFilter for potential re-use.
We also canonicalize the DarkTrafficFilter stats scope which changes from
“darkTrafficFilter” to “dark_traffic_filter”. E.g.:
“dark_traffic_filter/forwarded”, “dark_traffic_filter/skipped”, and
“dark_traffic_filter/failed”. <code class="docutils literal notranslate"><span class="pre">RB_ID=852548</span></code></p></li>
<li><p>finagle-mysql: Mysql has been promoted out of experimental. Please change all
references of com.twitter.finagle.exp.{M,m}ysql to com.twitter.finagle.{M,m}ysql</p></li>
<li><p>finagle-redis: Server-side support for Redis is removed. See this finaglers&#64; thread
(<a class="reference external" href="https://groups.google.com/forum/#!topic/finaglers/dCyt60TJ7eM">https://groups.google.com/forum/#!topic/finaglers/dCyt60TJ7eM</a>) for discussion.
Note that constructors for Redis commands no longer accept raw byte arrays.
<code class="docutils literal notranslate"><span class="pre">RB_ID=848815</span></code></p></li>
<li><p>finagle-redis: Redis codec (i.e., <cite>c.t.f.Codec</cite>) is removed. Use <cite>c.t.f.Redis.client</cite>
instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=848815</span></code></p></li>
</ul>
</section>
<section id="id320">
<h3>New Features<a class="headerlink" href="#id320" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Expose metrics on util’s default <cite>FuturePool</cite> implementations
<cite>unboundedPool</cite> and <cite>interruptibleUnboundedPool</cite>:
“finagle/future_pool/pool_size”, “finagle/future_pool/queue_size”,
“finagle/future_pool/active_tasks”, and “finagle/future_pool/completed_tasks”.
<code class="docutils literal notranslate"><span class="pre">RB_ID=850652</span></code></p></li>
<li><p>finagle-core: Mux Clients now propagate the number of times the client retried
the request in the request’s c.t.f.context.Context, available via
c.t.f.context.Retries. <code class="docutils literal notranslate"><span class="pre">RB_ID=862640</span></code></p></li>
<li><p>finagle-http: HTTP Clients now propagate the number of times the client retried
the request in the request’s c.t.f.context.Context, available via
c.t.f.context.Retries. <code class="docutils literal notranslate"><span class="pre">RB_ID=864852</span></code></p></li>
<li><p>finagle-thrift: maxThriftBufferSize is now tunable via parameter for Thrift
servers. It previously only was for ThriftMux servers. <code class="docutils literal notranslate"><span class="pre">RB_ID=860102</span></code></p></li>
</ul>
</section>
<section id="id321">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id321" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: HttpTransport now eagerly closes client connection after
processing non-keepalive requests.</p></li>
<li><p>finagle-redis: <cite>c.t.f.redis.Client</cite> now uses the pipelining dispatcher. <code class="docutils literal notranslate"><span class="pre">RB_ID=848815</span></code></p></li>
<li><p>finagle-serversets: <cite>c.t.f.serverset2.Stabilizer</cite> no longer uses a timer to implement
stabilization periods if the periods are 0 seconds long. <code class="docutils literal notranslate"><span class="pre">RB_ID=861561</span></code></p></li>
<li><p>finagle-core: ‘c.t.f.Failure’ has a new flag, Rejected, to indicate that a given request was
rejected. All Failures generated with the Failure.rejected constructor are flagged Rejected and
Restartable. <code class="docutils literal notranslate"><span class="pre">RB_ID=863356</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.FixedInetResolver</cite> now optionally retries failed DNS
lookups with provided backoff, and <cite>c.t.f.serverset2.Zk2Resolver</cite> uses this
retry functionality infinitely, exponentially backing off from 1 second to
5 minutes. <code class="docutils literal notranslate"><span class="pre">RB_ID=860058</span></code></p></li>
</ul>
</section>
</section>
<section id="id322">
<h2>6.36.0<a class="headerlink" href="#id322" title="Permalink to this headline">¶</a></h2>
<section id="id323">
<h3>Deprecations<a class="headerlink" href="#id323" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Removed DtabFilter.Finagle in favor of DtabFilter.Extractor.
<code class="docutils literal notranslate"><span class="pre">RB_ID=840600</span></code></p></li>
<li><p>finagle-zipkin: Deprecate <cite>ZipkinTracer</cite> in favor of <cite>ScribeZipkinTracer</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=840494</span></code></p></li>
</ul>
</section>
<section id="id324">
<h3>Breaking API Changes<a class="headerlink" href="#id324" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle: Builds are now only for Java 8 and Scala 2.11. See the
<a class="reference external" href="https://finagle.github.io/blog/2016/04/20/scala-210-and-java7/">blog post</a>
for details. <code class="docutils literal notranslate"><span class="pre">RB_ID=828898</span></code></p></li>
<li><p>finagle: Finagle is no longer depending on Twitter’s clone of JSR166e, JDK 8
API is used instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=833652</span></code></p></li>
<li><p>finagle-cacheresolver: package contents merged into finagle-memcached.
<code class="docutils literal notranslate"><span class="pre">RB_ID=833602</span></code></p></li>
<li><p>finagle-core: Renamed DeadlineFilter to DeadlineStatsFilter, which now only
records stats for the number of requests with exceeded deadlines, the
remaining deadline budget, and the transit latency of requests. It no longer
rejects requests and has no configuration. We have decided not to pursue
Deadline Admission Control at this time. <code class="docutils literal notranslate"><span class="pre">RB_ID=829372</span></code></p></li>
<li><p>finagle-core: <cite>ClientBuilder.socksProxy(SocketAddress)</cite> is removed.
Use command line flags (see <cite>c.t.f.socks.SocksProxyFlags.scala</cite>) instead.
<code class="docutils literal notranslate"><span class="pre">RB_ID=834634</span></code></p></li>
<li><p>finagle-core: Removed “closechans” and “closed” counters from <cite>ChannelStatsHandler</cite>.
<code class="docutils literal notranslate"><span class="pre">RB_ID=835194</span></code></p></li>
<li><p>finagle-core: Removed the “load” gauge from <cite>StatsFilter</cite> as it was duplicated
by the “pending” gauge. <code class="docutils literal notranslate"><span class="pre">RB_ID=835199</span></code></p></li>
<li><p>finagle-core: <cite>c.t.finagle.NoStacktrace</cite> is removed. Use <cite>scala.util.control.NoStackTrace</cite>
instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=833188</span></code></p></li>
<li><p>finagle-core: <cite>c.t.finagle.Failure.withStackTrace</cite> is removed. Use system property
<cite>scala.control.noTraceSuppression</cite> instead to fill stacktraces in Finagle’s failures.
<code class="docutils literal notranslate"><span class="pre">RB_ID=833188</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.filter.RequestSerializingFilter</cite> is removed.
Use <cite>c.t.f.filter.RequestSemaphoreFilter</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=839372</span></code></p></li>
<li><p>finagle-core: <cite>SessionParams</cite> no longer contains <cite>acquisitionTimeout</cite>. Instead, it
was extracted into <cite>ClientSessionParams</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=837726</span></code></p></li>
<li><p>finagle-core: Changed visibility of PipeliningDispatcher to private[finagle].  Clients should
not be affected, since it’s not a part of the end-user API. <code class="docutils literal notranslate"><span class="pre">RB_ID=843153</span></code>.</p></li>
<li><p>finagle-core: Simplified and unified the constructors for FailureAccrualFactory into
a single constructor. <code class="docutils literal notranslate"><span class="pre">RB_ID=849660</span></code></p></li>
<li><p>finagle-http: Deprecate channelBufferUsageTracker in favor of maxRequestSize.
<code class="docutils literal notranslate"><span class="pre">RB_ID=831233</span></code></p></li>
<li><p>finagle-http: HttpClientDispatcher, HttpServerDispatcher, and
ConnectionManager are no longer public. <code class="docutils literal notranslate"><span class="pre">RB_ID=830150</span></code></p></li>
<li><p>finagle-redis: Deprecated methods have been removed from the client API.
<code class="docutils literal notranslate"><span class="pre">RB_ID=843455</span></code></p></li>
<li><p>finagle-redis: <cite>c.t.f.redis.*Commands</cite> traits are now package-private.
<code class="docutils literal notranslate"><span class="pre">RB_ID=843455</span></code></p></li>
<li><p>finagle-redis: Replace <cite>ChannelBuffer</cite> with <cite>Buf</cite> in client’s:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>HashCommands</cite>: <code class="docutils literal notranslate"><span class="pre">RB_ID=843596</span></code></p></li>
<li><p><cite>ListCommands</cite>: <code class="docutils literal notranslate"><span class="pre">RB_ID=844596</span></code></p></li>
<li><p><cite>BtreeSortedSetCommands</cite>: <code class="docutils literal notranslate"><span class="pre">RB_ID=844862</span></code></p></li>
<li><p><cite>HyperLogLogCommands</cite>: <code class="docutils literal notranslate"><span class="pre">RB_ID=844945</span></code></p></li>
<li><p><cite>PubSubCommands</cite>: <code class="docutils literal notranslate"><span class="pre">RB_ID=845087</span></code></p></li>
<li><p><cite>SetCommands</cite>: <code class="docutils literal notranslate"><span class="pre">RB_ID=845578</span></code></p></li>
<li><p><cite>SortedSetCommands</cite>: <code class="docutils literal notranslate"><span class="pre">RB_ID=846074</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p>finagle-thrift: As part of the migration off of <cite>Codec</cite>, remove
<cite>c.t.f.thrift.ThriftClientBufferedCodec</cite> and <cite>c.t.f.thrift.ThriftClientBufferedCodecFactory</cite>
which were used by <cite>ClientBuilder.codec</cite> and <cite>ServerBuilder.codec</cite>. Replace usage
with <cite>ClientBuilder.stack(Thrift.client.withBufferedTransport)</cite>
or <cite>ServerBuilder.stack(Thrift.server.withBufferedTransport)</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=838146</span></code></p></li>
<li><p>finagle-memcached: <cite>c.t.f.memcached.Client</cite> now uses <cite>c.t.bijection.Bijection</cite>
instead of <cite>c.t.u.Bijection</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=834383</span></code></p></li>
<li><p>finagle-zipkin: Moved case classes and companion objects <cite>Span</cite>, <cite>ZipkinAnnotation</cite>,
<cite>BinaryAnnotation</cite>, <cite>Endpoint</cite>, <cite>Sampler</cite> and <cite>SamplingTracer</cite> to finagle-zipkin-core.
<code class="docutils literal notranslate"><span class="pre">RB_ID=840494</span></code></p></li>
<li><p>finagle-mysql: Removed <cite>c.t.f.exp.mysql.transport.MysqlTransporter</cite>, as it was not useful for it
to be public. <code class="docutils literal notranslate"><span class="pre">RB_ID=840718</span></code></p></li>
</ul>
</section>
<section id="id325">
<h3>Bug Fixes<a class="headerlink" href="#id325" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: PipeliningDispatcher now serializes “write and enqueue Promise” so it’s no longer
possible for the wrong response to be given to a request. <code class="docutils literal notranslate"><span class="pre">RB_ID=834927</span></code></p></li>
<li><p>finagle-http: Servers which aggregate content chunks (streaming == false) now return a 413
response for streaming clients who exceed the servers’ configured max request size.
<code class="docutils literal notranslate"><span class="pre">RB_ID=828741</span></code></p></li>
<li><p>finagle-mysql: <cite>c.t.f.exp.mysql.PreparedCache</cite> now closes prepared statements when no one holds
a reference to the cached future any longer.  This fixes a race condition where the cached
future could be evicted and the prepared statement closed while a user tries to use that
prepared statement.  <code class="docutils literal notranslate"><span class="pre">RB_ID=833970</span></code></p></li>
<li><p>finagle-netty4-http: Servers now see the correct client host address for requests. <code class="docutils literal notranslate"><span class="pre">RB_ID=844076</span></code></p></li>
</ul>
</section>
<section id="id326">
<h3>New Features<a class="headerlink" href="#id326" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Added gauge, “scheduler/blocking_ms” measuring how much time,
in milliseconds, the <code class="docutils literal notranslate"><span class="pre">com.twitter.concurrent.Scheduler</span></code> is spending doing blocking
operations on threads that have opted into tracking. This also moves the
“scheduler/dispatches” gauge out of TwitterServer into Finagle. <code class="docutils literal notranslate"><span class="pre">RB_ID=828289</span></code></p></li>
<li><p>finagle-core: Added a FailureAccrualPolicy that marks an endpoint
dead when the success rate in a specified time window is under the
required threshold. <code class="docutils literal notranslate"><span class="pre">RB_ID=829984</span></code></p></li>
<li><p>finagle-core: <cite>StackServer</cite> now installs an <cite>ExpiringService</cite> module by default. This
allows servers to have control over session lifetime and brings the <cite>StackServer</cite> to
feature parity with <cite>ServerBuilder</cite>.  <code class="docutils literal notranslate"><span class="pre">RB_ID=837726</span></code></p></li>
<li><p>finagle-exp: Changed DarkTrafficFilter to forward interrupts to dark service. <code class="docutils literal notranslate"><span class="pre">RB_ID=839286</span></code></p></li>
<li><p>finagle-http: ContextFilter and Dtab-extractor/injector logic has been moved from
the http dispatchers into the client and server stacks. <code class="docutils literal notranslate"><span class="pre">RB_ID=840600</span></code></p></li>
<li><p>finagle-mysql: Added a <cite>withMaxConcurrentPreparedStatements</cite> method to the client which lets you
specify how many prepared statements you want to cache at a time.  <code class="docutils literal notranslate"><span class="pre">RB_ID=833970</span></code></p></li>
<li><p>finagle-redis: Adds support for scripting commands. <code class="docutils literal notranslate"><span class="pre">RB_ID=837538</span></code></p></li>
<li><p>finagle-netty4: SOCKS5 proxy support. <code class="docutils literal notranslate"><span class="pre">RB_ID=839856</span></code></p></li>
<li><p>finagle-zipkin-core: A new module containing most of the functionality
from finagle-zipkin, leaving finagle-zipkin with only Scribe specific code
and a service loader. This allows for other transports to be implemented
in separate modules. For example the upcoming finagle-zipkin-kafka.
<code class="docutils literal notranslate"><span class="pre">RB_ID=840494</span></code></p></li>
<li><p>finagle-thriftmux: Introduce a Netty4 implementation of mux and thrift-mux.
<code class="docutils literal notranslate"><span class="pre">RB_ID=842869</span></code></p></li>
</ul>
</section>
<section id="id327">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id327" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: For SSLEngine implementations supplied via configuration or
created by Finagle, the setEnableSessionCreation method is no longer called.
The supplied value, true, is the default for JSSE implementations, and for
other engines this can be an unsupported operation. <code class="docutils literal notranslate"><span class="pre">RB_ID=845765</span></code></p></li>
<li><p>finagle-core: Pipelined protocols (memcached, redis) no longer prevent
connections from being cut by interrupts.  Instead, interrupts are masked
until a subsequent ten second timeout has expired without a response in the
pipeline. <code class="docutils literal notranslate"><span class="pre">RB_ID=843153</span></code></p></li>
<li><p>finagle-core: MonitorFilter now installs the parameterized monitor, and will
no longer fail the request automatically if any exception is thrown
synchronously (like if an exception is thrown in an onSuccess or onFailure
block).  This removes a race, and makes Finagle more deterministic.
<code class="docutils literal notranslate"><span class="pre">RB_ID=832979</span></code></p></li>
</ul>
</section>
</section>
<section id="id328">
<h2>6.35.0<a class="headerlink" href="#id328" title="Permalink to this headline">¶</a></h2>
<section id="id329">
<h3>Deprecations<a class="headerlink" href="#id329" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle: remove unused finagle-validate and finagle-testers packages. <code class="docutils literal notranslate"><span class="pre">RB_ID=818726</span></code></p></li>
</ul>
</section>
<section id="id330">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id330" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: DeadlineFilter is now per-connection, so the max rejection percentage
is not shared across clients. This prevents a single client from exceeding the rejection
budget. <code class="docutils literal notranslate"><span class="pre">RB_ID=813731</span></code>.</p></li>
<li><p>finagle-core: The use of keytool in PEMEncodedKeyManager has been removed and instead the
keystore is being loaded from the pkcs12 file. <code class="docutils literal notranslate"><span class="pre">RB_ID=832070</span></code></p></li>
<li><p>finagle-http: Local Dtabs are now encoded into the <cite>Dtab-Local</cite> header.  <cite>X-Dtab</cite> headers
may still be read but should be considered deprecated. <code class="docutils literal notranslate"><span class="pre">RB_ID=815092</span></code></p></li>
<li><p>finagle-thrift: Removed duplicate “thrift” label on Thrift/ThriftMux scrooge-related
server stats. <code class="docutils literal notranslate"><span class="pre">RB_ID=816825</span></code></p></li>
</ul>
</section>
<section id="id331">
<h3>Breaking API Changes<a class="headerlink" href="#id331" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-redis: Deprecated ChannelBuffer exposing apis for string commands. <code class="docutils literal notranslate"><span class="pre">RB_ID=817766</span></code>.</p></li>
<li><p>finagle-core: DefaultClient has been removed. Implementors should prefer <cite>c.t.f.StackClient</cite>
<code class="docutils literal notranslate"><span class="pre">RB_ID=812681</span></code>.</p></li>
<li><p>finagle-core: When a client is created, its server set resolution is started eagerly.
<code class="docutils literal notranslate"><span class="pre">RB_ID=806940</span></code></p></li>
<li><p>finagle-core: Dentry now takes a Dentry.Prefix instead of a Path. <code class="docutils literal notranslate"><span class="pre">RB_ID=813914</span></code></p></li>
<li><p>finagle-core: Remove <cite>*.client.withTransport.socksProxy</cite> param as part of the initiative to
move to CLI flags based configuration for SOCKS. <code class="docutils literal notranslate"><span class="pre">RB_ID=842512</span></code></p></li>
<li><p>finagle-thrift/thriftmux: Thrift servers constructed using <cite>Thrift.serveIface</cite> now use
<cite>Thrift.server.serveIface</cite>. ThriftMux servers constructed using <cite>ThriftMux.serveIface</cite> now use
<cite>ThriftMux.server.serveIface</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=824865</span></code></p></li>
<li><p>finagle-cache-resolver: <cite>c.t.f.cacheresolver.ZookeeperCacheNodeGroup</cite> has been removed from the
API since we no longer check for the zookeeper data for the cache pool size to refresh for the
changes in the serverset. <code class="docutils literal notranslate"><span class="pre">RB_ID=811190</span></code></p></li>
</ul>
</section>
<section id="id332">
<h3>New Features<a class="headerlink" href="#id332" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: http 1.1 running on netty4 is configurable via <cite>c.t.finagle.netty4.http.exp.Netty4Impl</cite>.
It has not been tested in production and should be considered beta software. <code class="docutils literal notranslate"><span class="pre">RB_ID=828188</span></code></p></li>
<li><p>finagle-core: Multi-line Dtabs may now contain line-oriented comments beginning with ‘#’.
Comments are omitted from parsed Dtabs. <code class="docutils literal notranslate"><span class="pre">RB_ID=818752</span></code></p></li>
<li><p>finagle-http: new stack params MaxChunkSize, MaxHeaderSize, and MaxInitialLineLength
are available to configure the http codec. <code class="docutils literal notranslate"><span class="pre">RB_ID=811129</span></code></p></li>
<li><p>finagle-mux: Mux now has support for fragmenting Tdispatch and Rdispatch payloads.
This helps with head-of-line blocking in the presence of large payloads and allows
long transmissions to be interrupted. <code class="docutils literal notranslate"><span class="pre">RB_ID=794641</span></code>.</p></li>
<li><p>finagle-core: Dtabs allow wildcard path elements in prefixes. <code class="docutils literal notranslate"><span class="pre">RB_ID=813914</span></code></p></li>
<li><p>finagle-netty4: HTTP proxy support for any Finagle Netty 4 client. <code class="docutils literal notranslate"><span class="pre">RB_ID=819752</span></code></p></li>
<li><p>finagle-core: Gauge for dns resolutions awaiting lookups. <code class="docutils literal notranslate"><span class="pre">RB_ID=822410</span></code></p></li>
</ul>
</section>
<section id="id333">
<h3>Bug Fixes<a class="headerlink" href="#id333" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Ensure that service closure is delayed until chunked response bodies
have been processed. <code class="docutils literal notranslate"><span class="pre">RB_ID=813110</span></code></p></li>
<li><p>finagle-stats: Ensure that histogram snapshotting does not fall behind if snapshot()
is not called at least once per interval. <code class="docutils literal notranslate"><span class="pre">RB_ID=826149</span></code></p></li>
</ul>
</section>
</section>
<section id="id334">
<h2>6.34.0<a class="headerlink" href="#id334" title="Permalink to this headline">¶</a></h2>
<section id="id335">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id335" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: GenSerialClientDispatcher fails pending and subsequent requests when
its underlying transport closes. <code class="docutils literal notranslate"><span class="pre">RB_ID=807590</span></code></p></li>
</ul>
</section>
<section id="id336">
<h3>New Features<a class="headerlink" href="#id336" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Include upstream/downstream addresses/client ids and request trace id
in exceptions that extend <cite>c.t.f.HasRemoteInfo</cite> (including <cite>c.t.f.SourcedException</cite>),
accessible via the <cite>remoteInfo</cite> value. <code class="docutils literal notranslate"><span class="pre">RB_ID=797082</span></code></p></li>
<li><p>finagle-core: Introduce <cite>c.t.f.service.ResponseClassifier</cite> for HTTP servers,
which allows developers to give Finagle the additional application specific knowledge
necessary in order to properly classify responses.``RB_ID=800179``</p></li>
<li><p>finagle: Export two new histograms: <cite>request_payload_bytes</cite> and <cite>response_payload_bytes</cite>
for the following protocols: HTTP (non-chunked), Mux, ThriftMux and Thrift. <code class="docutils literal notranslate"><span class="pre">RB_ID=797821</span></code></p></li>
<li><p>finagle-core: Define <cite>c.t.f.Address</cite> to represent an endpoint’s physical location.
Resolvers and namers may attach metadata such as weight to individual endpoint addresses.
<code class="docutils literal notranslate"><span class="pre">RB_ID=792209</span></code></p></li>
<li><p>finagle-http: Introduce convenience extractors to pattern match <cite>c.t.f.http.Response.status</cite>
against the different categories. <code class="docutils literal notranslate"><span class="pre">RB_ID=802953</span></code></p></li>
<li><p>finagle-http: Add <cite>toBoolean</cite> method in <cite>StringUtil</cite> to parse strings to boolean consistently.
<code class="docutils literal notranslate"><span class="pre">RB_ID=804056</span></code></p></li>
<li><p>finagle-http: Servers now actually decompress requests when decompression is turned on.
<code class="docutils literal notranslate"><span class="pre">RB_ID=810629</span></code></p></li>
<li><p>finagle-redis: Add support for SENTINEL commands. <code class="docutils literal notranslate"><span class="pre">RB_ID=810663</span></code></p></li>
<li><p>finagle-redis: Support for Pub/Sub. <code class="docutils literal notranslate"><span class="pre">RB_ID=810610</span></code></p></li>
</ul>
</section>
<section id="id337">
<h3>Breaking API Changes<a class="headerlink" href="#id337" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-core: <cite>c.t.f.Codec.prepareConnFactory(ServiceFactory)</cite> is marked <cite>final</cite>, override
<cite>c.t.f.Codec.prepareConnFactory(ServiceFactory, Stack.Params)</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=797821</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.Codec.newClientDispatcher(Transport)</cite> is marked <cite>final</cite>, override
<cite>c.t.f.Codec.newClientDispatcher(Transport, Stack.Params)</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=797821</span></code></p></li>
<li><p>finagle-core: Removed deprecations: <code class="docutils literal notranslate"><span class="pre">RB_ID=800974</span></code>
- Removed <cite>c.t.f.Service.release</cite>, replace usage with <cite>Service.close()</cite>.
- Removed <cite>c.t.f.ServiceFactory.make</cite>, replace usage with <cite>ServiceFactory.apply</cite>.
- Removed <cite>c.t.f.ProxyServiceFactory</cite>, replace usage with <cite>ServiceFactoryProxy</cite>.
- Removed deprecated <cite>c.t.f.service.FailureAccrualFactory</cite> constructor.
- Removed <cite>c.t.f.netty3.ChannelBufferBuf.apply</cite>, replace usage with <cite>ChannelBufferBuf.Owned.apply</cite>.
- Removed <cite>c.t.f.util.InetAddressUtil.Loopback</cite>, replace usage with <cite>java.net.InetAddress.getLoopbackAddress</cite>.
- Removed <cite>c.t.f.tracing.TracingFilter</cite>, replace usage with <cite>TraceInitializationFilter</cite> and <cite>(Client|Server)TracingFilter</cite>.</p></li>
<li><p>finagle-core: <cite>c.t.f.Addr.Bound.addr</cite> type changed from <cite>Set[SocketAddress]</cite> to
<cite>Set[c.t.f.Address]</cite>. We provide a migration guide below for the most common cases.</p>
<p>Callers of <cite>c.t.f.Addr.Bound.addr</cite> must handle <cite>Set[c.t.f.Address]</cite> instead of
<cite>Set[SocketAddresses]</cite>. If you do something with the <cite>SocketAddress</cite> and expect the underlying
type to be <cite>InetSocketAddress</cite>, use <cite>c.t.f.Address.Inet.addr</cite> to get the underlying
<cite>InetSocketAddress</cite>.</p>
<p><cite>c.t.f.Addr</cite> constructors and <cite>c.t.f.Name.bound</cite> method now accept <cite>c.t.f.Address</cite> instead
of <cite>SocketAddress</cite>. For most cases, wrapping the <cite>InetSocketAddress</cite> in an <cite>Address.Inet</cite>
will fix the compile error.</p>
<p>Any other <cite>SocketAddress</cite> subclass is currently incompatible with <cite>c.t.f.Address</cite>. Instead,
you should encode any additional information in the metadata field of <cite>c.t.f.Address.Inet</cite>
or <cite>c.t.f.exp.Address.ServiceFactory</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=792209</span></code></p>
</li>
<li><p>finagle-core: Delete <cite>c.t.f.ServiceFactorySocketAddress</cite> and replace usages with
<cite>c.t.f.exp.Address.ServiceFactory</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=792209</span></code></p></li>
<li><p>finagle-core: Delete <cite>c.t.f.WeightedSocketAddress</cite> and instead use
<cite>c.t.f.addr.WeightedAddress</cite> to represent address weights. <code class="docutils literal notranslate"><span class="pre">RB_ID=792209</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.builder.ClientBuilder.hosts</cite> takes a Seq of <cite>InetSocketAddress</cite> instead of
<cite>SocketAddress</cite>. If you get a compile error, change the static type to <cite>InetSocketAddress</cite> if
you can. Otherwise, cast it at runtime to <cite>InetSocketAddress</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=792209</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.client.Transporter.EndpointAddr</cite> takes a <cite>c.t.f.Address</cite> as its
parameter instead of <cite>SocketAddress</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=792209</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.service.FauilureAccrualFactory.Param(FailureAccrualPolicy)</cite> is removed -
it’s not safe to configure Failure Accrual with a shareable instance of the policy, use
<cite>() =&gt; FailureAccrualPolicy</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=802953</span></code></p></li>
<li><p>finagle-core: <cite>$Client.withSessionQualifier.failureAccrualPolicy</cite> has been removed from the API
since it enables an experimental feature (use Stack’s <cite>.configured</cite> API instead). <code class="docutils literal notranslate"><span class="pre">RB_ID=802953</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.service.exp.FailureAccrualPolicies</cite> (Java-friendly API) has been removed -
use <cite>c.t.f.service.exp.FailureAccrualPolicy</cite> instead.</p></li>
<li><p>finagle-core: DefaultServer is removed. Protocol implementors should use StackServer instead.
<code class="docutils literal notranslate"><span class="pre">RB_ID=811918</span></code></p></li>
<li><p>finagle-memcached: <cite>c.t.f.memcached.protocol.text.Memcached</cite> no longer takes a <cite>StatsReceiver</cite>,
pass it to a <cite>(Client/Server)Builder</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=797821</span></code></p></li>
<li><p>finagle-redis: <cite>c.t.f.redis.Redis</cite> no longer takes a <cite>StatsReceiver</cite>, pass it to a
<cite>(Client/Server)Builder</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=797821</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.http.MapHeaderMap</cite> no longer takes a <cite>mutable.Map[String, Seq[String]]</cite> as
a constructor parameter. <cite>apply</cite> method provides a similar functionality.</p></li>
</ul>
</section>
<section id="id338">
<h3>Bug Fixes<a class="headerlink" href="#id338" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Fixed <cite>getAll</cite> method on <cite>c.t.f.http.MapHeaderMap</cite>, now it is case insensitive.
<cite>apply</cite> method was altering the provided header names. This is fixed it is now possible to
iterate on the original header names.</p></li>
</ul>
</section>
</section>
<section id="id339">
<h2>6.33.0<a class="headerlink" href="#id339" title="Permalink to this headline">¶</a></h2>
<section id="id340">
<h3>New Features<a class="headerlink" href="#id340" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Introduce the <cite>c.t.f.service.PendingRequestFactory</cite> module in the client Stack.
The module allows clients to limit the number of pending requests per connection. It is disabled
by default. <code class="docutils literal notranslate"><span class="pre">RB_ID=795491</span></code></p></li>
<li><p>finagle-core: Introduce the <cite>c.t.f.filter.ServerAdmissionControl</cite> module in the server Stack,
which is enabled through the param <cite>c.t.f.param.EnableServerAdmissionControl</cite>. Users can define
their own admission control filters, which reject requests when the server operates beyond
its capacity. These rejections apply backpressure and allow clients to retry requests on
servers that may not be over capacity. The filter implementation should define its own logic
to determine over capacity. One or more admission control filters can be installed through
the <cite>ServerAdmissionControl.register</cite> method. <code class="docutils literal notranslate"><span class="pre">RB_ID=776385</span></code></p></li>
<li><p>finagle-core: Introduce <cite>c.t.f.service.ResponseClassifier</cite> which allows developers to
give Finagle the additional application specific knowledge necessary in order to properly
classify them. Without this, Finagle can only safely make judgements about transport
level failures. This is now used by <cite>StatsFilter</cite> and <cite>FailureAccrualFactory</cite> so that
application level failures can be used for both success metrics and failure accrual.
<code class="docutils literal notranslate"><span class="pre">RB_ID=772906</span></code></p></li>
<li><p>finagle-core: Added a new ‘Endpoints’ section on client pages, listing the weights, paths,
and resolved endpoints for each dtab.``RB_ID=779001``</p></li>
<li><p>finagle-core: Introduce discoverable stack params which are available on every client/server
via the <cite>with</cite>-prefixed methods. <code class="docutils literal notranslate"><span class="pre">RB_ID=781833</span></code></p></li>
<li><p>finagle-memcached: Added <cite>c.t.f.memcached.BaseClient.checkAndSet</cite> which exposes the difference
between a conflict and a not found result.</p></li>
<li><p>finagle-mux: Add a Wireshark dissector that can decode Mux messages. <code class="docutils literal notranslate"><span class="pre">RB_ID=779482</span></code></p></li>
<li><p>finagle-stats: Define flag <cite>c.t.f.stats.statsFilterFile</cite> as GlobalFlag[Set[File]] to take
comma-separated multiple files. <code class="docutils literal notranslate"><span class="pre">RB_ID=793397</span></code></p></li>
<li><p>finagle-mux: Tinit/Rinit are now available and permit feature negotiation. <code class="docutils literal notranslate"><span class="pre">RB_ID=793350</span></code></p></li>
</ul>
</section>
<section id="id341">
<h3>Deprecations<a class="headerlink" href="#id341" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-memcached: <cite>c.t.f.memcached.BaseClient.cas</cite> is deprecated in favor of the richer
<cite>checkAndSet</cite> method.</p></li>
</ul>
</section>
<section id="id342">
<h3>Breaking API Changes<a class="headerlink" href="#id342" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: All the deprecated exceptions from <cite>Exceptions.scala</cite> have been removed.
<code class="docutils literal notranslate"><span class="pre">RB_ID=774658</span></code></p></li>
<li><p>finagle-thrift: Remove the <cite>framed</cite> attributes from <cite>c.t.f.Thrift.Client</cite> and
<cite>c.t.f.Thrift.Server</cite>.  This behavior may now be controlled with <cite>c.t.f.Thrift.param.Framed</cite>.</p></li>
<li><p>finagle-core: Unused <cite>c.t.f.builder.NonShrinkingCluster</cite> has been removed.
<code class="docutils literal notranslate"><span class="pre">RB_ID=779001</span></code></p></li>
<li><p>finagle-thrift: <cite>c.t.f.ThriftRichClient</cite> has a new abstract protected method
<cite>responseClassifier: ResponseClassifier</cite>. If your implementation does not need
this, you can implement it with <cite>ResponseClassifier.Default</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=791470</span></code></p></li>
</ul>
</section>
<section id="id343">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id343" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-thrift,thriftmux: Deserialization of Thrift responses now happens as part
of service application which means that it will now be part of the latency reported by
<cite>StatsFilter</cite>. The actual latency as perceived by clients will not have changed, but
for clients that spend significant time deserializing and do not have higher level
metrics this may come as a surprise. <code class="docutils literal notranslate"><span class="pre">RB_ID=772931</span></code></p></li>
<li><p>finagle-mux,thriftmux: The default <cite>closeTimeout</cite> in ping based failure detection
is changed from Duration.Top to 4 seconds, to allow a session to be closed by default
when a ping response times out after 4 seconds. This allows sessions to be reestablished
when there may be a networking issue, so that it can choose an alternative networking
path instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=773649</span></code></p></li>
</ul>
</section>
<section id="id344">
<h3>Breaking API Changes<a class="headerlink" href="#id344" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-thrift: Remove the <cite>framed</cite> attributes from <cite>c.t.f.Thrift.Client</cite> and
<cite>c.t.f.Thrift.Server</cite>.  This behavior may now be controlled with <cite>c.t.f.Thrift.param.Framed</cite>.</p></li>
</ul>
</section>
</section>
<section id="id345">
<h2>6.32.0<a class="headerlink" href="#id345" title="Permalink to this headline">¶</a></h2>
<p>NOT RELEASED</p>
</section>
<section id="id346">
<h2>6.31.0<a class="headerlink" href="#id346" title="Permalink to this headline">¶</a></h2>
<section id="id347">
<h3>New Features<a class="headerlink" href="#id347" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.Server</cite> now has a <cite>serveAndAnnounce</cite> method that accepts a <cite>SocketAddress</cite>
as an address. <code class="docutils literal notranslate"><span class="pre">RB_ID=758862</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.service.Retries</cite> now supports adding delay between each automatic retry.
This is configured via the <cite>Retries.Budget</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=768883</span></code></p></li>
<li><p>finagle-core: FailureAccrualFactory now uses a FailureAccrualPolicy to determine when to
mark an endpoint dead. The default policy, FailureAccrualPolicy.consecutiveFailures(),
mimicks existing functionality, and FailureAccrualPolicy.successRate() operates on the
exponentially weighted average success rate over a window of requests.``RB_ID=756921``</p></li>
<li><p>finagle-core: Introduce <cite>c.t.f.transport.Transport.Options</cite> to configure transport-level options
(i.e., socket options <cite>TCP_NODELAY</cite> and <cite>SO_REUSEADDR</cite>). <code class="docutils literal notranslate"><span class="pre">RB_ID=773824</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.http.exp.Multipart</cite> now supports both in-memory and on-disk file uploads.
<code class="docutils literal notranslate"><span class="pre">RB_ID=RB_ID=769889</span></code></p></li>
<li><p>finagle-netty4: Hello World. Introduce a <cite>Listener</cite> for Netty 4.1. This is still considered beta.
<code class="docutils literal notranslate"><span class="pre">RB_ID=718688</span></code></p></li>
<li><p>finagle-netty4: Introduce <cite>ChannelTransport</cite> for Netty 4.1. <code class="docutils literal notranslate"><span class="pre">RB_ID=763435</span></code></p></li>
<li><p>finagle-thrift: <cite>c.t.f.ThriftRichClient</cite> implementations of <cite>newServiceIface</cite>
method that accept a <cite>label</cite> argument to pass to the <cite>ScopedStats</cite> instance. <code class="docutils literal notranslate"><span class="pre">RB_ID=760157</span></code></p></li>
<li><p>finagle-stats: Added <cite>c.t.f.stats</cite> now has a <cite>statsFilterFile</cite> flag which will read a denylist
of regex, newline-separated values. It will be used along with the <cite>statsFilter</cite> flag for stats
filtering. <code class="docutils literal notranslate"><span class="pre">RB_ID=764914</span></code></p></li>
</ul>
</section>
<section id="id348">
<h3>Deprecations<a class="headerlink" href="#id348" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: the #channelFactory method of <cite>c.t.f.builder.ServerBuilder</cite> has been deprecated
in favor of the <cite>c.t.f.netty3.numWorkers</cite> flag. <code class="docutils literal notranslate"><span class="pre">RB_ID=718688</span></code></p></li>
</ul>
</section>
<section id="id349">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id349" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: The behavior for <cite>c.t.f.util.DefaultMonitor</cite> has changed such that
unhandled exceptions are propagated to <cite>c.t.u.RootMonitor</cite> except for
<cite>c.t.f.Failures</cite> with a log <cite>Level</cite> below INFO. <code class="docutils literal notranslate"><span class="pre">RB_ID=758056</span></code></p></li>
<li><p>finagle-core: The metrics for requeues <cite>requeue/requeues</cite>, <cite>requeue/budget</cite> and
<cite>requeue/budget_exhausted</cite> have moved under retries. They are now <cite>retries/requeues</cite>,
<cite>retries/budget</cite> and <cite>retries/budget_exhausted</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=760213</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.service.RetryFilter</cite> and <cite>c.t.f.service.RetryExceptionsFilter</cite>
now default to using a <cite>RetryBudget</cite> to mitigate retry amplification on downstream
services. The previous behavior can be achieved by explicitly passing in
<cite>RetryBudget.Infinite</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=766302</span></code></p></li>
<li><p>finagle-core: <cite>c.t.f.factory.TrafficDistributor</cite> now suppresses changes when a bound
address is updated from a valid set to an error. Instead, it continues using stale
data until it gets a successful update.</p></li>
<li><p>finagle-http: Unhandled exceptions from user defined HTTP services are now converted
into very basic 500 responses so clients talking to those services see standard HTTP
responses instead of a dropped connection. <code class="docutils literal notranslate"><span class="pre">RB_ID=755846</span></code></p></li>
<li><p>finagle-memcached: Moved metrics from underlying <cite>KetamaPartitionedClient</cite> for Memcached clients
to share the same scope of the underlying finagle client. <code class="docutils literal notranslate"><span class="pre">RB_ID=771691</span></code></p></li>
<li><p>finagle-mux: <cite>com.twitter.finagle.mux.ThresholdFailureDetector</cite> is turned on by
default. <code class="docutils literal notranslate"><span class="pre">RB_ID=756213</span></code></p></li>
<li><p>finagle-serversets: The <cite>c.t.f.serverset2.Zk2Resolver</cite> now surfaces <cite>Addr.Pending</cite>
when it detects that its underlying ZooKeeper client is unhealthy. Unhealthy is defined
as non-connected for greater than its ‘unhealthyWindow’ (which defaults to 5 minutes).
<code class="docutils literal notranslate"><span class="pre">RB_ID=760771</span></code></p></li>
<li><p>finagle-serversets: The <cite>c.t.f.serverset2.ZkSession</cite> now uses an unbounded semaphore to
limit to 100 outstanding zookeeper requests at any one moment. <code class="docutils literal notranslate"><span class="pre">RB_ID=771399</span></code></p></li>
</ul>
</section>
<section id="id350">
<h3>Breaking API Changes<a class="headerlink" href="#id350" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>BackupRequestLost</cite> is no longer itself an <cite>Exception</cite>. Use
<cite>BackupRequestLost.Exception</cite> in its place. <code class="docutils literal notranslate"><span class="pre">RB_ID=758056</span></code></p></li>
<li><p>finagle-core: Replaced <cite>c.t.f.builder.ClientConfig.Retries</cite> with
<cite>c.t.f.service.Retries.Policy</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=760213</span></code></p></li>
<li><p>finagle-core: A deprecated <cite>c.t.f.CancelledReadException</cite> has been removed.
<code class="docutils literal notranslate"><span class="pre">RB=763435</span></code></p></li>
<li><p>finagle-http: <cite>c.t.f.http.exp.Multipart.decodeNonChunked</cite> has been removed from
the public API. Use <cite>c.t.f.http.Request.multipart</cite> instead. Also
<cite>c.t.f.http.exp.Multipart.FileUpload</cite> is no longer a case class, but base trait
for <cite>Multipart.InMemoryFileUpload</cite> and <cite>Multipart.OnDiskFileUpload</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=769889</span></code></p></li>
<li><p>finagle-mux: <cite>c.t.f.FailureDetector.apply</cite> method is changed to private scope,
to reduce API surface area. Using <cite>FailureDetector.Config</cite> is enough to config
session based failure detection behavior. <code class="docutils literal notranslate"><span class="pre">RB_ID=756833</span></code></p></li>
<li><p>finagle-mux: <cite>closeThreshold</cite> in <cite>c.t.f.mux.FailureDetector.ThresholdConfig</cite> is
changed to <cite>closeTimeout</cite>, from an integer that was used as a multiplier to time
duration. This makes it easier to config. <code class="docutils literal notranslate"><span class="pre">RB_ID=759406</span></code></p></li>
</ul>
</section>
<section id="id351">
<h3>Bug Fixes<a class="headerlink" href="#id351" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-thrift: <cite>c.t.f.ThriftRichClient</cite> scoped stats label is now threaded
properly through <cite>newServiceIface</cite> <code class="docutils literal notranslate"><span class="pre">RB_ID=760157</span></code></p></li>
</ul>
</section>
</section>
<section id="id352">
<h2>6.30.0<a class="headerlink" href="#id352" title="Permalink to this headline">¶</a></h2>
<section id="id353">
<h3>New Features<a class="headerlink" href="#id353" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>com.twitter.finagle.client.LatencyCompensator</cite> allows its
default Compensator value to be set via an API call. This allows
libraries to set defaults for clients that have not configured this module.
<code class="docutils literal notranslate"><span class="pre">RB_ID=750228</span></code></p></li>
<li><p>finagle-core: New Resolver <cite>com.twitter.finagle.FixedInetResolver</cite> extends
InetResolver by caching successful DNS lookups indefinitely. It’s scheme is ‘fixedinet’.
This is used by clients or resolvers that do not want or expect
host-&gt;ip map changes (such as the zk2 resolver and twemcache client).
<code class="docutils literal notranslate"><span class="pre">RB_ID=753712</span></code></p></li>
</ul>
</section>
<section id="id354">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id354" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>RetryPolicy.tries</cite> now uses jittered backoffs instead of
having no delay. <code class="docutils literal notranslate"><span class="pre">RB_ID=752629</span></code></p></li>
<li><p>finagle-core: <cite>FailureAccrualFactory</cite> uses jittered backoffs as the duration
to mark dead for, if <cite>markDeadFor</cite> is not configured. <code class="docutils literal notranslate"><span class="pre">RB_ID=746930</span></code></p></li>
<li><p>finagle-core: The transit latency (transit_latency_ms) and deadline budget
(deadline_budget_ms) stats are now only recorded for servers, not for
clients anymore, since they’re only meaningful for servers. <code class="docutils literal notranslate"><span class="pre">RB_ID=75268</span></code></p></li>
<li><p>finagle-http: Clients sending requests with payloads larger than the server
accepts (default 5MB) now receive a HTTP 413 response instead of a channel
closed exception.  <code class="docutils literal notranslate"><span class="pre">RB_ID=753664</span></code></p></li>
</ul>
</section>
<section id="id355">
<h3>Breaking API Changes<a class="headerlink" href="#id355" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>TimerFromNettyTimer</cite> is renamed to <cite>HashedWheelTimer</cite> and
the constructor accepting <cite>org.jboss.netty.util.Timer</cite> made private. For
compatibility, <cite>HashedWheelTimer</cite> has additional constructors to match
those provided by <cite>org.jboss.netty.util.HashedWheelTimer</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=748514</span></code></p></li>
<li><p>finagle-httpx / finagle-httpx-compat: Renamed to finagle-http and
finagle-http-compat respectively. This changes the package names, e.g.:
com.twitter.finagle.httpx to com.twitter.finagle.http. <code class="docutils literal notranslate"><span class="pre">RB_ID=751876</span></code></p></li>
<li><p>finagle-core: Marked <cite>HandletimeFilter</cite> private[finagle], and renamed it to
<cite>ServerStatsFilter</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=75268</span></code></p></li>
<li><p>finagle-zipkin: Drop <cite>c.t.zipkin.thrift.Annotation.duration</cite> and associated thrift field
<cite>c.t.f.thrift.thrift.Annotation.duration</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=751986</span></code></p></li>
<li><p>finagle-stress: Project has been removed from Finagle. <code class="docutils literal notranslate"><span class="pre">RB_ID=752201</span></code></p></li>
<li><p>finagle-swift: Project has been moved off of Finagle to
<a class="reference external" href="https://github.com/finagle/finagle-swift">https://github.com/finagle/finagle-swift</a> . <code class="docutils literal notranslate"><span class="pre">RB_ID=752826</span></code></p></li>
</ul>
</section>
</section>
<section id="id356">
<h2>6.29.0<a class="headerlink" href="#id356" title="Permalink to this headline">¶</a></h2>
<section id="id357">
<h3>Deprecations<a class="headerlink" href="#id357" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Deprecated in favour of finagle-httpx and now removed.</p></li>
</ul>
</section>
<section id="id358">
<h3>New Features<a class="headerlink" href="#id358" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Provides a <cite>RetryFilter</cite> which takes a
<cite>RetryPolicy[(Req, Try[Rep])]</cite> and allows you to retry on both “successful”
requests, such as HTTP 500s, as well as failed requests. The <cite>Req</cite>
parameterization facilitates using the request to determine if retrying is
safe (i.e. the request is idempotent).</p></li>
<li><p>finagle-httpx: Experimental support <cite>multipart/form-data</cite> (file uploads)
decoding via <cite>c.t.f.httpx.exp.Multipart</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=730102</span></code></p></li>
</ul>
</section>
<section id="id359">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id359" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>InetResolver.bind</cite> will now succeed if any hostname resolution
succeeds. Previous behavior required that all hosts are successfully resolved.
<code class="docutils literal notranslate"><span class="pre">RB_ID=737748</span></code></p></li>
<li><p>finagle-core: DNS lookups in InetResolver are no longer cached
within Finagle according to <cite>networkaddress.cache.ttl</cite>; we rely
instead on however caching is configured in the JVM and OS. <code class="docutils literal notranslate"><span class="pre">RB_ID=735006</span></code></p></li>
<li><p>finagle-core: After being revived, a <cite>FailureAccrualFactory</cite> enters a
‘probing’ state wherein it must successfully satisfy a request before
accepting more. If the request fails, it waits for the next <cite>markDeadFor</cite>
period. <code class="docutils literal notranslate"><span class="pre">RB_ID=747541</span></code></p></li>
<li><p>finagle-serversets: DNS lookups in Zk2Resolver are no longer
cached within Finagle according to <cite>networkaddress.cache.ttl</cite>;
instead they are cached indefinitely. <code class="docutils literal notranslate"><span class="pre">RB_ID=735006</span></code></p></li>
<li><p>finagle-redis: c.t.f.Redis now uses a pipelined dispatcher along with
a concurrent load balancer to help eliminate head-of-line blocking.</p></li>
</ul>
</section>
<section id="id360">
<h3>Breaking API Changes<a class="headerlink" href="#id360" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>RetryingFilter</cite>, which takes a RetryPolicy[Try[Nothing]]` and
is invoked only on exceptions, has been renamed to <cite>RetryExceptionsFilter</cite>.
<cite>RetryExceptionsFilter</cite> is a subclass of <cite>RetryFilter</cite>, which takes a
<cite>RetryPolicy[(Req, Try[Rep])]</cite> and allows you to retry on both “successful”
requests, such as HTTP 500s, as well as failed requests. The <cite>Req</cite>
parameterization facilitates using the request to determine if retrying is
safe (i.e. the request is idempotent).</p></li>
<li><p>finagle-core: Name.all is now private to <cite>com.twitter.finagle</cite>.</p></li>
<li><p>finagle-memcached: Unified stack-based construction APIs and cleanup internal
constructors. In particular, <cite>KetamaClient</cite> was removed and <cite>KetamaPartitionClient</cite>
and <cite>KetamaFailureAccrualFactory</cite> are now sealed inside Finagle. See
[[com.twitter.finagle.Memcached]] for how to construct a finagle-memcached client.</p></li>
<li><p>finagle-redis: Port the c.t.f.Redis protocol object to the StackClient API.
A redis client can now be constructed and configured like the rest of the
finagle subprojects.</p></li>
</ul>
</section>
</section>
<section id="id361">
<h2>6.28.0<a class="headerlink" href="#id361" title="Permalink to this headline">¶</a></h2>
<section id="id362">
<h3>New Features<a class="headerlink" href="#id362" title="Permalink to this headline">¶</a></h3>
</section>
<section id="id363">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id363" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Weights are no longer supported by the load balancers. They are moved
one level above and interpreted by a new module, the <cite>TrafficDistributor</cite>. This
frees the balancers to have non-linear load metrics. It also changes the semantics
of weights. They are now normalized by size of endpoints that share the same weight
and interpreted proportional to offered load (however, they can still be though of,
roughly, as multipliers for traffic). <code class="docutils literal notranslate"><span class="pre">RB_ID=677416</span></code></p></li>
<li><p>finagle-core: The RequestSemaphoreFilter now sheds load by dropping the tail of the queue
and failing it with a <cite>Failure.Restartable</cite>. Previously, the filter had an unbounded
queue but now the default size is 0 (i.e. no queueing). The dropped requests are in
turn requeued by Finagle clients with protocol support (e.g. Http, ThriftMux).
<code class="docutils literal notranslate"><span class="pre">RB_ID=696934</span></code></p></li>
<li><p>finagle-core: <cite>ServerBuilder.ServerConfig.BindTo</cite>, <cite>ServerBuilder.ServerConfig.MonitorFactory</cite>,
and <cite>ServerBuilder.ServerConfig.Daemonize</cite>, are now private to <cite>com.twitter.finagle.builder</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=730865</span></code></p></li>
<li><p>finagle-memcachedx: Renamed to finagle-memcached.</p></li>
<li><p>finagle-stats: Standard deviation (“$statName.stddev”) is no longer exported.
<code class="docutils literal notranslate"><span class="pre">RB_ID=726309</span></code> (follow up to <code class="docutils literal notranslate"><span class="pre">RB_ID=717647</span></code>)</p></li>
<li><p>finagle-serversets: <cite>namer/bind_latency_us</cite> stat now counts only
time in name resolution, not service acquisition.
<cite>namer/{dtabcache,namecache,nametreecache}/misstime_ms</cite> stats are
no longer exported. <code class="docutils literal notranslate"><span class="pre">RB_ID=730309</span></code></p></li>
</ul>
</section>
<section id="id364">
<h3>Breaking API Changes<a class="headerlink" href="#id364" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.jsr166y</cite> has been replaced with Java 7 API. finagle: Replace JSR166y
with Java 7 API. <code class="docutils literal notranslate"><span class="pre">RB_ID=720903</span></code></p></li>
<li><p>finagle-core: <cite>LoadBalancerFactory</cite> no longer takes endpoints with weights as
per the decoupling mentioned in runtime changes. <code class="docutils literal notranslate"><span class="pre">RB_ID=677416</span></code></p></li>
<li><p>finagle-core: <cite>RequestSemaphoreFilter.Param</cite> now accepts a <cite>com.twitter.concurrent.AsyncSemaphore</cite>
instead of an integer representing the max concurrency. <code class="docutils literal notranslate"><span class="pre">RB_ID=696934</span></code></p></li>
<li><p>finagle-core: removed <cite>c.t.f.asyncDns</cite> flag and <cite>c.t.f.SyncInetResolver</cite>; DNS resolution is
now always asynchronous. <code class="docutils literal notranslate"><span class="pre">RB_ID=734427</span></code></p></li>
<li><p>finagle-core: <cite>ClientBuilder.ClientConfig.DefaultParams</cite>, <cite>ClientBuilder.ClientConfig.DestName</cite>,
<cite>ClientBuilder.ClientConfig.GlobalTimeout</cite>, <cite>ClientBuilder.ClientConfig.Daemonize</cite>, and
<cite>ClientBuilder.ClientConfig.MonitorFactory</cite> are now private to <cite>com.twitter.finagle.builder</cite>.
<cite>ClientBuilder.ClientConfig.Retries</cite> is now private to <cite>com.twitter</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=727245</span></code></p></li>
<li><p>finagle-httpx: <cite>Method</cite> no longer has an extractor. To access the name of
custom methods, use <cite>toString</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=722913</span></code></p></li>
<li><p>finagle-mux: <cite>c.t.f.mux.exp.FailureDetector</cite> and <cite>c.t.f.mux.exp.sessionFailureDetector</cite> are
moved out of exp package into mux package. <code class="docutils literal notranslate"><span class="pre">RB_ID=725350</span></code></p></li>
</ul>
</section>
</section>
<section id="id365">
<h2>6.27.0<a class="headerlink" href="#id365" title="Permalink to this headline">¶</a></h2>
<section id="id366">
<h3>New Features<a class="headerlink" href="#id366" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-http: Support nacks between Finagle Http clients and servers. When a server fails
with retryable exceptions (exceptions wrapped by <cite>Failure.rejected</cite>), it sends back a “Nack”
response, i.e. 503 Response code with a new “finagle-http-nack” header. This allows clients
to safely retry failed requests, and keep connections open. <code class="docutils literal notranslate"><span class="pre">RB_ID=705948</span></code></p></li>
</ul>
</section>
<section id="id367">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id367" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: FailFast parameter renamed from <cite>onOrOff</cite> to <cite>enabled</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=720781</span></code></p></li>
<li><p>finagle-core: When evaluating NameTree unions, return components of the union in Ok state rather
than waiting for all components to be Ok. This enables resilience of unions when part of the
tree cannot be resolved. <code class="docutils literal notranslate"><span class="pre">RB_ID=697114</span></code></p></li>
<li><p>finagle-stats: Standard of deviation is no longer calculated. It is exported as a constant 0.0
for “$statName.stddev”. <code class="docutils literal notranslate"><span class="pre">RB_ID=717647</span></code></p></li>
</ul>
</section>
<section id="id368">
<h3>Breaking API Changes<a class="headerlink" href="#id368" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-stream: Introduce StreamRequest as a replacement for Netty’s
HttpRequest, and converted the rest of the public API to not leak
other Netty types (notably ChannelBuffer is replaced by Buf). <code class="docutils literal notranslate"><span class="pre">RB_ID=695896</span></code></p></li>
<li><p>finagle-core: Dtab does not implement the Namer interface anymore. Use
<cite>c.t.f.naming.DefaultInterpreter</cite> to bind a name via a Dtab. Support for Dtab entries starting
with /#/ has been removed. <cite>c.t.f.Namer.bindAndEval</cite> has been removed. Use
<cite>c.t.f.Namer.resolve</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=711681</span></code></p></li>
<li><p>finagle: <cite>LoadService</cite> and <cite>ThriftRichClient</cite> migrated off of deprecated <cite>ClassManifest</cite>
to <cite>ClassTag</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=720455</span></code></p></li>
</ul>
</section>
</section>
<section id="id369">
<h2>6.26.0<a class="headerlink" href="#id369" title="Permalink to this headline">¶</a></h2>
<section id="id370">
<h3>Deprecations<a class="headerlink" href="#id370" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-memcached: Deprecated in favor of finagle-memcachedx and now removed.</p></li>
</ul>
</section>
<section id="id371">
<h3>New Features<a class="headerlink" href="#id371" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-httpx: Support nacks between Finagle Http clients and servers. When a server fails
with retryable exceptions (exceptions wrapped by <cite>Failure.rejected</cite>), it sends back a “Nack”
response, i.e. 503 Response code with a new “finagle-http-nack” header. This allows clients
to safely retry failed requests, and keep connections open. <code class="docutils literal notranslate"><span class="pre">RB_ID=670046</span></code></p></li>
</ul>
</section>
<section id="id372">
<h3>Breaking API Changes<a class="headerlink" href="#id372" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Moved netty3 specific things into a netty3 namespace. For
these symbols, the namespace translation follows this pattern:
<cite>c.t.f.$MODULE._ =&gt; c.t.f.netty3.$MODULE._.</cite> <code class="docutils literal notranslate"><span class="pre">RB_ID=691746</span></code></p></li>
<li><p>finagle-core: Define <cite>WeightedSocketAddress</cite> as a case class. Add
<cite>WeightedSocketAddress.extract</cite> method to extract weight. <code class="docutils literal notranslate"><span class="pre">RB_ID=614228</span></code></p></li>
<li><p>finagle-core: Constructing a new Balancer that can be injected into a Finagle client
was unnecessarily complex and non-uniform. We removed the legacy constructors around
defining the collection of endpoints and simplified the interface to <cite>LoadBalancerFactory</cite>.
Now, <cite>com.twitter.finagle.loadbalancer.Balancers</cite> defines the collection of balancer
constructors. <code class="docutils literal notranslate"><span class="pre">RB_ID=660730</span></code></p></li>
<li><p>finagle-core: Aperture can no longer be enabled via command line flags. Configuring
per-client settings globally is generally not a good idea and we’re working to remove
these flags from Finagle. Use the constructors in <cite>com.twitter.finagle.loadbalancer.Balancers</cite>
to create an instance that can be injected into a client. <code class="docutils literal notranslate"><span class="pre">RB_ID=663194</span></code></p></li>
<li><p>finagle-core: The default load balancer has changed to p2c from heap. <code class="docutils literal notranslate"><span class="pre">RB_ID=693450</span></code></p></li>
<li><p>finagle-core: <cite>Service.isAvailable</cite> and <cite>ServiceFactory.isAvailable</cite> is finalized.
<cite>Service.status</cite> and <cite>ServiceFactory.status</cite> supersedes <cite>isAvailable</cite> usage since 6.24.0 release.
<code class="docutils literal notranslate"><span class="pre">RB_ID=678588</span></code></p></li>
<li><p>finagle-core: <cite>ClientBuilder.failureAccrual</cite> method is removed. Use <cite>ClientBuilder.failureAccrualFactory</cite>
instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=689076</span></code></p></li>
<li><p>finagle-core: Stack param <cite>ClientBuilder.ClientConfig.FailureAccrualFac</cite> is removed.
Use <cite>ClientBuilder.failureAccrualFactory</cite> instead. <code class="docutils literal notranslate"><span class="pre">RB_ID=689076</span></code></p></li>
<li><p>finagle-exception: <cite>com.twitter.finagle.exception.ExceptionReporter</cite> is no longer used
as the default <cite>com.twitter.finagle.util.ReporterFactory</cite>. <code class="docutils literal notranslate"><span class="pre">RB_ID=674646</span></code></p></li>
<li><p>finagle-kestrel: Replace deprecated finagle-kestrel package with finagle-kestrelx.
<code class="docutils literal notranslate"><span class="pre">RB_ID=667920</span></code></p></li>
<li><p>finagle-core: Add new method <cite>noFailureAccrual</cite> on <cite>ClientBuilder</cite> that completely disables
<cite>FailureAccrualFactory</cite> in the underlying stack. <code class="docutils literal notranslate"><span class="pre">RB_ID=689076</span></code></p></li>
</ul>
</section>
<section id="id373">
<h3>New Features<a class="headerlink" href="#id373" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-thrift: Support for finagle Services per thrift method.</p></li>
</ul>
</section>
</section>
<section id="id374">
<h2>6.25.0<a class="headerlink" href="#id374" title="Permalink to this headline">¶</a></h2>
<section id="id375">
<h3>Breaking API Changes<a class="headerlink" href="#id375" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.builder.Server</cite> now implements <cite>c.t.f.ListeningServer</cite>.</p></li>
<li><p>finagle-core: <cite>c.t.f.Server.serveAndAnnounce</cite> with a <cite>ServiceFactory</cite> had
its first argument renamed to <cite>name</cite> from <cite>forum</cite>.</p></li>
<li><p>finagle-core: Add an attribute map to <cite>c.t.f.Addr.Bound</cite>.</p></li>
<li><p>finagle-core: <cite>c.t.f.builder.ClientConfig.FailFast</cite> has moved to
<cite>c.t.f.FailFastFactory.FailFast</cite>.</p></li>
<li><p>finagle-core: NoBrokersAvailableException now has two Dtab constructor
arguments, both the base and local Dtabs.</p></li>
<li><p>finagle-core: <cite>c.t.f.Failure</cite> convenience constructors (e.g., <cite>Failure.Cause</cite>,
<cite>Failure.Rejected</cite>) were removed in favor of uniform flag treatment, and clean
separation of attributes from interpretation of those attributes.</p></li>
<li><p>finagle-core: <cite>ExitGuard</cite> usage is now private to finagle.</p></li>
<li><p>finagle-core: <cite>c.t.f.service.TimeoutFilter.module</cite> is now split into
<cite>TimeoutFilter.clientModule</cite> and <cite>TimeoutFilter.serverModule</cite>.</p></li>
<li><p>finagle-core: remove deprecated <cite>c.t.f.builder.ClientBuilder.stack</cite> taking a
<cite>Stack.Params =&gt; Client[Req1, Rep1]</cite>.</p></li>
<li><p>finagle-core: StackRegistry.Entry takes different constructor arguments, and the
name has been bundled in with the Stack.Params.  StackRegistry.Entry is only used
internally, so this should be relatively inexpensive.  Similarly, StackRegister#register
has also had a small change to its method signature along the same lines.</p></li>
<li><p>finagle-http: deprecated methods in <cite>c.t.f.http.HttpMessageProxy</cite> have been removed.</p></li>
<li><p>finagle-memcached / finagle-memcachedx: move TwitterCacheResolver
and related objects to new finagle-cacheresolver package.</p></li>
<li><p>finagle-memcached / finagle-memcachedx: failureAccrual param in ReplicationClient
is changed from type (Int, Duration) to (Int, () =&gt; Duration), to allow flexibility
to config duration. Also see <cite>markDeadFor</cite> change in finagle-core in the “New Features”
section below.</p></li>
<li><p>finagle-memcached / finagle-memcachedx: MigrationClientTest now uses
ServerCnxnFactory from com.twitter.zk rather than NIOServerCnxn.Factory from
org.apache.zookeeper.server.</p></li>
<li><p>finagle-mux: <cite>c.t.f.mux.RequestNackedException</cite> is removed in favor of a standard
Failure (<cite>c.t.f.Failure.Rejected</cite>).</p></li>
<li><p>finagle-ostrich4: Switched dependency to finagle-httpx from finagle-http.</p></li>
<li><p>finagle-serversets: ZkInstance in tests now uses ServerCnxnFactory from
com.twitter.zk rather than NIOServerCnxn.Factory from
org.apache.zookeeper.server.</p></li>
<li><p>finagle-stats: Switched dependency to finagle-httpx from finagle-http.</p></li>
<li><p>finagle-mysql: PreparedStatements are now more type-safe! The type signature of
PreparedStatements has changed from Seq[Any] =&gt; Future[Result] to Seq[Parameter] =&gt;
Future[Result]. Parameter represents objects that are serializable by finagle-mysql.
In most cases, scalac should transparently wrap your arguments in Parameter when
applying a PreparedStatement. However, in cases where this doesn’t happen you
can explicitly wrap them using <cite>Parameter.wrap</cite>.</p></li>
</ul>
</section>
<section id="id376">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id376" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>com.twitter.finagle.service.StatsFilter</cite> no longer requires a
<cite>com.twitter.finagle.stats.RollupStatsReceiver</cite> for correct behaviour, and
providing one will double count failures.</p></li>
<li><p>finagle-core: <cite>com.twitter.finagle.factory.TimeoutFactory</cite> will fail with
a retryable <cite>com.twitter.finagle.Failure</cite> when it times out.</p></li>
<li><p>finagle-core: <cite>com.twitter.finagle.pool.WatermarkPool</cite> will fail with
an interrupted <cite>com.twitter.finagle.Failure</cite> when it is interrupted while
waiting or trying to establish a connection.  It has previously failed with
a <cite>com.twitter.finagle.WriteException</cite> when trying to establish a
connection, but it’s incorrect to retry on an interruption.</p></li>
<li><p>finagle-core: <cite>com.twitter.fiangle.RetryPolicy</cite>’s <cite>RetryableWriteException</cite>
and <cite>WriteExceptionsOnly</cite> will not retry on <cite>com.twitter.finagle.Failure`s
that are marked `InterruptedBy</cite>, even if they are <cite>Retryable</cite>.</p></li>
<li><p>finagle-core: The error message provided by <cite>c.t.f.NoBrokersAvailableException</cite>
prints both the base and local Dtabs.</p></li>
<li><p>finagle-core: Stats produced by <cite>com.twitter.finagle.factory.BindingFactory</cite>
are now scoped with the “namer” prefix rather than “interpreter”. The total
latency associated with Name binding is now recorded in the “bind_latency_ms”
stat.</p></li>
<li><p>finagle-core: The “service_creation/service_acquisition_latency_ms” stat
produced by <cite>com.twitter.finagle.factory.StatsFactoryWrapper</cite> no longer
includes time spent in name resolution, which is now covered by
“namer/bind_latency_us” as discussed above.</p></li>
<li><p>finagle-core: added transit_latency_ms and deadline_budget_ms stats.</p></li>
<li><p>finagle-core: Automatic retries (requeues) are now credited as a ratio of
requests over a window of time, instead of a fixed limit. The stats scope
has also changed from “automatic” to “requeues”.</p></li>
</ul>
</section>
<section id="id377">
<h3>Deprecations<a class="headerlink" href="#id377" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.builder.Server.localAddress</cite> is deprecated in favor of
<cite>c.t.f.ListeningServer.boundAddress</cite>.</p></li>
</ul>
</section>
<section id="id378">
<h3>New Features<a class="headerlink" href="#id378" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-core: <a class="reference external" href="https://twitter.github.io/finagle/guide/FAQ.html#why-do-clients-see-com-twitter-finagle-failedfastexception-s">Fail fast</a>
is now <a class="reference external" href="https://twitter.github.io/finagle/guide/FAQ.html#configuring-finagle6">configurable</a>
on Stack-based clients via the <cite>com.twitter.finagle.FailFastFactory.FailFast</cite> param.</p></li>
<li><p>finagle-core: <cite>com.twitter.finagle.service.StatsFilter</cite> is now configurable with an
<cite>com.twitter.finagle.stats.ExceptionStatsHandler</cite> to customize how failures are recorded.</p></li>
<li><p>finagle-core: It should be safe to match on <cite>com.twitter.finagle.Failure.InterruptedBy</cite>
to tell if a <cite>com.twitter.util.Future</cite> failed due to being interrupted.</p></li>
<li><p>finagle-core: <cite>markDeadFor</cite> in c.t.f.service.FailureAccrualFactory.Param is changed from
Duration type to () =&gt; Duration. So it’s flexible for clients to pass in a function that
specifies Duration. For example, c.t.f.service.FailureAccrualFactory provides a function
that adds perturbation in durations. Stack-based API and c.t.f.builder.ClientBuilder
support both types for client configuration. For example,</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Thrift.client.configured(FailureAccrualFactory(5, () =&gt; 1.seconds))
// or
Thrift.client.configured(new FailureAccrualFactory(5, 1.seconds)).
</pre></div>
</div>
<p>c.t.f.client.DefaultClient does not support Duration type in failureAccrual anymore.</p>
</div></blockquote>
</li>
<li><p>finagle-core: improved Java compatiblity for <cite>c.t.f.Stack.Params</cite> / <cite>c.t.f.Stack.Parameterized</cite>.</p></li>
<li><p>finagle-core: Introduce the ability to add metadata to a bound <cite>com.twitter.finagle.Addr</cite>.</p></li>
<li><p>finagle-core: Introduce per-address latency compensation.  Clients may be configured with
a ‘Compensator’ function that uses the client’s address metadata to adjust connection and
request timeouts.  This can be used, for instance, to account for speed-of-light latency
between physical regions.</p></li>
<li><p>finagle-core: Introduce per-address stats scoping.  Clients may be configured with
a <cite>com.twitter.finagle.client.StatsScoping.Scoper</cite> function that uses the client’s
address metadata to adjust the scope of client stats. This can be used, for instance,
to properly scope client stats for a Name that resolves to a Union of distinct clusters.</p></li>
<li><p>finagle-core: A convenient method <cite>Client.newService(dest: String, label: String)</cite> was added.</p></li>
<li><p>finagle-core: ExitGuard now has an ‘explainGuards’ method to provide a human-readable
description of exit guards that are still active.</p></li>
<li><p>finagle-http(x): Two missing params were added: <cite>Decompression</cite> and <cite>CompressionLevel</cite>. Both
client and server may be configured with either <cite>configured</cite> method or <cite>withDecompression</cite>/
<cite>withCompressionLevel</cite>.</p></li>
<li><p>finagle-mysql: Add support for MySQL transactions.</p></li>
<li><p>finagle-stats: A new HostStatsReceiver type is added and used for per host stats.
It is loaded through LoadService and used by the Stack-based API as a default
param. Per host stats can be turned on through <cite>com.twitter.finagle.loadbalancer.perHostStats</cite>
flag, and is exported to the “/admin/per_host_metrics.json” route in twitter-server.</p></li>
<li><p>finagle-stats: Improved compatibility when migrating from
<a class="reference external" href="https://github.com/twitter/ostrich/">Ostrich</a> stats via two flags:
<code class="docutils literal notranslate"><span class="pre">com.twitter.finagle.stats.useCounterDeltas=true</span></code> and
<code class="docutils literal notranslate"><span class="pre">com.twitter.finagle.stats.format=ostrich</span></code>. If these flags are both set,
HTTP requests to <code class="docutils literal notranslate"><span class="pre">/admin/stats.json</span></code> with the <code class="docutils literal notranslate"><span class="pre">period=60</span></code> query string
parameter will replicate Ostrich’s behavior by computing deltas on counters
every minute and formatting histograms with the same labels Ostrich uses.</p></li>
<li><p>finagle-memcached(x): Add <cite>c.t.f.memcached.Memcached</cite> which provides a Stack
based Memcache client that uses pipelining.</p></li>
</ul>
</section>
<section id="id379">
<h3>Bug Fixes<a class="headerlink" href="#id379" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.Server.serveAndAnnounce</cite> for a <cite>Service</cite> had its usage
of <cite>name</cite> and <cite>addr</cite> transposed.</p></li>
</ul>
</section>
<section id="miscellaneous-cleanup">
<h3>Miscellaneous Cleanup<a class="headerlink" href="#miscellaneous-cleanup" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-protobuf: Move entire unused subproject to the <a class="reference external" href="https://github.com/finagle/finagle-protobuf">Finagle
organization on GitHub</a>.</p></li>
</ul>
</section>
</section>
<section id="id380">
<h2>6.24.0<a class="headerlink" href="#id380" title="Permalink to this headline">¶</a></h2>
<section id="id381">
<h3>Breaking API Changes<a class="headerlink" href="#id381" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>finagle-core: Remove <cite>c.t.f.client.StackClient.Role.loadBalancer</cite>, which
was unused and duplicated by <cite>c.t.f.loadbalancer.LoadBalancerFactory.role</cite>.</p></li>
<li><p>finagle-core: <cite>c.t.f.Namer.orElse</cite> was removed; composing Namers
may be accomplished by constructing an appropriate Dtab.</p></li>
<li><p>finagle-core: removed experimental <cite>enum</cite> / <cite>expand</cite> from
<cite>c.t.f.Namer</cite> and <cite>alt</cite> / <cite>union</cite> from <cite>c.t.f.Dtab</cite>.</p></li>
<li><p>finagle-http: Remove <cite>c.t.f.http.CheckRequestFilter</cite> along with
<cite>c.t.f.http.CheckHttpRequestFilter</cite>. The functionality has been
added to <cite>c.t.f.http.codec.HttpServerDispatcher</cite>. In addition,
the codecError in <cite>c.t.f.http.BadHttpRequest</cite> has been replaced
with the exception thrown by the HttpServerCodec.</p></li>
<li><p>finagle-httpx: Remove deprecated code, limited scope of access on internal
classes.</p></li>
<li><p>finagle-mux: <cite>c.t.f.mux.lease.exp.WindowedByteCounter</cite> no longer
calls <cite>Thread.start()</cite> in its constructor. This should be now be
done by the caller.</p></li>
<li><p>finagle-mux: The experimental session API is discontinued.</p></li>
<li><p>finagle-mux: Introduce new Request and Response types for mux services.
The new mux request includes a <cite>destination</cite> path so that, which corresponds
to the <cite>destination</cite> field in Tdispatch requests. Furthermore, these new
types expose <cite>c.t.io.Buf</cite> instead of Netty’s ChannelBuffers.</p></li>
<li><p>finagle-thrift,finagle-thriftmux: <cite>c.t.f.Thrift.Client</cite>, <cite>c.t.f.Thrift.Server</cite>,
<cite>c.t.f.ThriftMux.Client</cite> and <cite>c.t.f.ThriftMux.Server</cite> have their
<cite>TProtocolFactory</cite> configured via a <cite>c.t.f.thrift.param.ProtocolFactory</cite>
<cite>Stack.Param</cite>.</p></li>
<li><p>finagle-thriftmux: <cite>c.t.f.ThriftMux.Client</cite> now has its <cite>ClientId</cite>
configured via a <cite>c.t.f.thrift.param.ClientId</cite> <cite>Stack.Param</cite>.</p></li>
<li><p>Traces (<code class="docutils literal notranslate"><span class="pre">com.twitter.finagle.tracing.Trace</span></code>) lose their local-state mutating methods:
<code class="docutils literal notranslate"><span class="pre">Trace.clear</span></code>, <code class="docutils literal notranslate"><span class="pre">Trace.pushId</span></code>, <code class="docutils literal notranslate"><span class="pre">Trace.setId</span></code>, <code class="docutils literal notranslate"><span class="pre">Trace.setTerminalId</span></code>, <code class="docutils literal notranslate"><span class="pre">Trace.pushTracer</span></code>,
<code class="docutils literal notranslate"><span class="pre">Trace.pushTracerAndSetNextId</span></code>,
<code class="docutils literal notranslate"><span class="pre">Trace.state_=</span></code>, and <code class="docutils literal notranslate"><span class="pre">Trace.unwind</span></code>.
Let-bound versions of these are introduced in their stead.
This makes it simple to ensure that state changes are properly delimited;
further, these are always guaranteed to be delimited properly by Finagle.</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Trace.setTracer(tracer)
codeThatUsesTracer()

// Let-bound version:
Tracer.letTracer(tracer) {
  codeThatUsesTracer()
}
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Context handlers (<code class="docutils literal notranslate"><span class="pre">com.twitter.finagle.Context</span></code>) are removed.
They are replaced by the use of marshalled request contexts
(<code class="docutils literal notranslate"><span class="pre">com.twitter.finagle.context.Contexts.broadcast</span></code>).
Marshalled request contexts do not require the use of service loading,
so their use no longer requires build system coordination.
We show Finagle’s trace context:
the first version uses the old context handler mechanism;
the second uses <code class="docutils literal notranslate"><span class="pre">Contexts.broadcast</span></code>.</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>// The old context handler for Finagle&#39;s tracing context. Note that this
// also required the file
// finagle-core/src/main/resources/META-INF/services/com.twitter.finagle.ContextHandler
// to contain the fully qualifed class path of the below object.
class TraceContext extends ContextHandler {
  val key = Buf.Utf8(&quot;com.twitter.finagle.tracing.TraceContext&quot;)

  def handle(body: Buf) {
    // Parse &#39;body&#39; and mutate the trace state accordingly.
  }

  def emit(): Option[Buf] = {
    // Read the trace state and marshal to a Buf.
  }
}

// New definition. No service loading required.
private[finagle] val idCtx = new Contexts.broadcast.Key[TraceId] {
  val marshalId = Buf.Utf8(&quot;com.twitter.finagle.tracing.TraceContext&quot;)

  def marshal(id: TraceId): Buf = {
    // Marshal the given trace Id
  }

  def tryUnmarshal(body: Buf): Try[TraceId] = {
    // Try to marshal &#39;body&#39; into a trace id.
  }
}
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="id382">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id382" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-mux: Mark the ServiceFactory available again if the underlying
Service is no longer available.  This permits it to be closed and reused.</p></li>
<li><p>finagle-mux: Rename the “lease_counter” counter to “leased” on mux clients.</p></li>
</ul>
</section>
<section id="id383">
<h3>Deprecations<a class="headerlink" href="#id383" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Deprecated the mechanisms of FailureAccrual that use
factory Transformers.  It’s better to just use the Params to
configure the existing FailureAccrualFactory.  However, if you’ve
actually written your own failure accrual transformer that’s
significantly different, then you can do stack.replace() to swap it
in.</p></li>
<li><p>finagle-memcached: Have cas() operation return false on NotFound()
state instead of throw IllegalStateException</p></li>
</ul>
</section>
<section id="id384">
<h3>New Features<a class="headerlink" href="#id384" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: All <cite>Stack.Param`s used in `ClientBuilder</cite> and
<cite>ServerBuilder</cite> are now publicly exposed for configuration
parity.</p></li>
<li><p>finagle-mux: Drain mux servers properly, so that shutdowns can be
graceful.</p></li>
<li><p>finagle-core: Introduce <cite>Service.status</cite> which supersedes
<cite>Service.isAvailable</cite>. <cite>Service.status</cite> is a fine-grained
health indicator. The default definition of
<cite>Service.isAvailable</cite> is now defined in terms of
<cite>Service.status</cite>; this definition will soon be made
final.</p></li>
<li><p>finagle-mux: Inject bound residual paths into mux requests.</p></li>
<li><p><em>Request contexts.</em> Request contexts replace the direct use of
com.twitter.util.Local and of com.twitter.finagle.Context.
Request contexts are environments of request-local bindings;
they are guaranteed to be delimited by Finagle,
and their API admits only properly delimited binding.
They come in two flavors:
Contexts.local are always local to handling a single request;
bindings in Contexts.broadcast may be marshalled and transmitted across process
boundaries where there is protocol support.
Currently, both Thrift and Mux (and thus also ThriftMux)
support marshalled contexts.
See <cite>com.twitter.finagle.contexts.Context</cite> for more details.</p></li>
</ul>
</section>
</section>
<section id="id385">
<h2>6.23.0<a class="headerlink" href="#id385" title="Permalink to this headline">¶</a></h2>
<section id="id386">
<h3>Breaking API Changes<a class="headerlink" href="#id386" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: <cite>c.t.f.Stackable`s maintained state about which parameters were
accessed via `get</cite>. This was error prone and violated the assumption that <cite>Stack`s
are immutable data structures. We removed this in favor of annotating modules with
parameters. The abstract classes for Stackables were also simplified. Now we only have
`Module</cite> and <cite>ModuleN</cite> variants which are more convenient for most definitions.
Since this is an advanced API, it should not impact standard usage of finagle.</p></li>
<li><p>finagle-core: Update ConcurrentRingBuffer to use ClassTag instead of ClassManifest;
rename size argument to capacity.</p></li>
</ul>
</section>
<section id="id387">
<h3>Deprecations<a class="headerlink" href="#id387" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><cite>ServerBuilder.stack[Req1, Rep1](mk: Stack.Params =&gt; Server[Req1, Rep1])</cite> is
deprecated in favor of
<cite>ServerBuilder.stack[Req1, Rep1](server: Stack.Parameterized[Server[Req1, Rep1]])</cite></p></li>
</ul>
</section>
<section id="id388">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id388" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><cite>finagle</cite>: Improve allocation semantics for uses of Buf.</p></li>
</ul>
</section>
</section>
<section id="id389">
<h2>6.22.0<a class="headerlink" href="#id389" title="Permalink to this headline">¶</a></h2>
<section id="id390">
<h3>Breaking API Changes<a class="headerlink" href="#id390" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Removed unused <cite>com.twitter.finagle.service.ProxyService</cite>. It wasn’t
sufficiently general to be used outside of finagle, and was no longer used
in finagle.</p></li>
<li><p>Removed TLSEngine, and replaced it with two, TLSClientEngine, and
TLSServerEngine, where TLSServerEngine is the same as TLSEngine, and
TLSClientEngine takes a SocketAddress instead of (). Additionally,
the Netty3TransporterTLSConfig now takes a function SocketAddress =&gt; Engine,
instead of () =&gt; Engine.</p></li>
</ul>
</section>
<section id="id391">
<h3>New Features<a class="headerlink" href="#id391" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: BroadcastStatsReceiver, introduce specialized implementation</p></li>
<li><p>finagle-core: Introduce gauges in SummarizingStatsReceiver</p></li>
<li><p>finagle-core: Introduce Transport#copyToWriter</p></li>
<li><p>finagle-core: Make base Dtab used in BindingFactory a Stack.Param</p></li>
<li><p>finagle-core: Proper decay in experimental ewma load metric</p></li>
<li><p>finagle-core: Simplify Stack{Client, Server} and unify around them</p></li>
</ul>
</section>
<section id="id392">
<h3>Runtime Behavior Changes<a class="headerlink" href="#id392" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Add support for non-URLClassloaders to LoadService</p></li>
<li><p>finagle-core: clear locals before entering server dispatch loop</p></li>
<li><p>finagle-core: Defer DNS Resolution in InetResolver to FuturePool</p></li>
<li><p>finagle-core: for paths starting with /#/, skip rewrites where prefix is /</p></li>
<li><p>finagle-core: include name resolution in tracing request span</p></li>
<li><p>finagle-core: Properly wrap some IOException into ConnectionFailedException</p></li>
<li><p>finagle-core: Scope InetResolver’s stats properly</p></li>
<li><p>finagle-http: Send “Connection: close” header while dispatcher is closing</p></li>
<li><p>finagle-http: Set content length header when appropriate</p></li>
<li><p>finagle-memcached: Use interruptible future for the client request readiness</p></li>
<li><p>finagle-stats: Add content-type response header to JsonExporter</p></li>
<li><p>finagle-thrift: Add back connection_preparation_latency stat in Thrift</p></li>
<li><p>finagle-thriftmux: Record protocol as a gauge rather than a counter</p></li>
</ul>
</section>
<section id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Add Scaladocs for ChannelBufferBuf and BufChannelBuffer</p></li>
<li><p>finagle-core: link to the FAQ in FailedFastException</p></li>
<li><p>finagle-serversets: Defer DNS resolution for endpoints to InetResolver</p></li>
<li><p>finagle-thrift{,mux}: Clarified with* deprecation warning</p></li>
<li><p>Fix minor issues and missing code blocks in Finagle documentation</p></li>
</ul>
</section>
<section id="optimization">
<h3>Optimization<a class="headerlink" href="#optimization" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: GlobalFlag isn’t caching the property value</p></li>
<li><p>finagle-core: recursive-descent Path / NameTree / Dentry / Dtab parsers to reduce heap allocation</p></li>
</ul>
</section>
<section id="id393">
<h3>Bug Fixes<a class="headerlink" href="#id393" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>finagle-core: Fix a deadlock in Contexts</p></li>
<li><p>finagle-core: Fix breaking ABI change in SummarizingStatsReceiver</p></li>
<li><p>finagle-core: Fix bug in computing array index in SummarizingStatsReceiver</p></li>
<li><p>finagle-core: Fix build.properties location for maven builds</p></li>
<li><p>finagle-core: Fix synchronization in LeasedFactory</p></li>
<li><p>finagle-core: Fix tracing with Stack{Client, Server}</p></li>
<li><p>finagle-core: Make FailedFastException an instance variable.</p></li>
<li><p>finagle-core: Synchronized access to the Stackable mutable.params map</p></li>
<li><p>finagle-http: Fix CookieMap.rewriteCookieHeaders()</p></li>
<li><p>finagle-http: Fix the memory leak in HttpClientDispatcher</p></li>
<li><p>finagle-mysql: Fix timestamp fractional seconds encoding</p></li>
<li><p>finagle-mysql: Properly heed timezone when extracting TimestampValue</p></li>
<li><p>mux: clear contexts after receive, not in ‘finally’ clause</p></li>
</ul>
</section>
</section>
<section id="id394">
<h2>6.21.0<a class="headerlink" href="#id394" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle</cite>: Upgrade to scala_2.10</p></li>
<li><p><cite>finagle-core</cite>: Add weighted address support to InetResolver.</p></li>
<li><p><cite>finagle-core</cite>: Adds ClientRegistry.expAllRegisteredClientsResolved</p></li>
<li><p><cite>finagle-core</cite>: Attach Dtab.local to NoBrokersAvailableException in filter</p></li>
<li><p><cite>finagle-core</cite>: Attempt to add dtab stats to all clients and servers</p></li>
<li><p><cite>finagle-core</cite>: Avoid SOCKS proxy for both loopback and link-local addresses</p></li>
<li><p><cite>finagle-core</cite>: Bind names lazily under Alt so we don’t do needless lookups</p></li>
<li><p><cite>finagle-core</cite>: DelayedFactory to detachable implementation</p></li>
<li><p><cite>finagle-core</cite>: Fix a race in load balancer initialization</p></li>
<li><p><cite>finagle-core</cite>: Improve loadbalancer logging</p></li>
<li><p><cite>finagle-core</cite>: Introduce ewma load metric</p></li>
<li><p><cite>finagle-core</cite>: Log state for ewma load metric</p></li>
<li><p><cite>finagle-core</cite>: Redesign of twitter-server admin page</p></li>
<li><p><cite>finagle-core</cite>: Register StackClient with Path dest in ClientRegistry as evaluated against Dtab.base Problem</p></li>
<li><p><cite>finagle-core</cite>: Rewrote ServiceLoader to avoid creating</p></li>
<li><p><cite>finagle-core</cite>: SingletonPool: a single-service pool with good semantics</p></li>
<li><p><cite>finagle-core</cite>: Zipkin tracing for name resolution</p></li>
<li><p><cite>finagle-core</cite>: fix synchronization in SummarizingStatsReceiver</p></li>
<li><p><cite>finagle-core</cite>: reusing pool: isAvailable === underlying.isAvailable</p></li>
<li><p><cite>finagle-docs</cite>: A better picture for filters. (Replaces hand-drawn monstrosity.)</p></li>
<li><p><cite>finagle-docs</cite>: Add Scaladocs for all public exception classes in Finagle.</p></li>
<li><p><cite>finagle-docs</cite>: Add a section to the FAQ regarding FailedFastExceptions</p></li>
<li><p><cite>finagle-exp</cite>: Generify the DarkTrafficFilter problem</p></li>
<li><p><cite>finagle-guide</cite>: Document stabilizing serverset metrics.</p></li>
<li><p><cite>finagle-http</cite>: Add support for a Dtab-Local header</p></li>
<li><p><cite>finagle-http</cite>: Fail requests with invalid X-Dtab headers</p></li>
<li><p><cite>finagle-http</cite>: Fail requests with invalid X-Dtab headers</p></li>
<li><p><cite>finagle-http</cite>: TextualContentCompressor should compress textual Content-Type’s even when containing a charset</p></li>
<li><p><cite>finagle-mux</cite>,thriftmux: explain why the files are named Netty3</p></li>
<li><p><cite>finagle-mux</cite>: Better gc avoidance flags for experimentation</p></li>
<li><p><cite>finagle-mux</cite>: Enable gc avoidance for parallel gc</p></li>
<li><p><cite>finagle-mux</cite>: Improve mux’s handling of client disconnects</p></li>
<li><p><cite>finagle-mux</cite>: Improved Garbage Collection Avoidance Docs</p></li>
<li><p><cite>finagle-mux</cite>: docs and minor cleansing in Message subclasses</p></li>
<li><p><cite>finagle-mysql</cite>: Switches PreparedCache over to util-cache FutureCache</p></li>
<li><p><cite>finagle-serversets</cite>: Add support for getEphemerals ZooKeeper call</p></li>
<li><p><cite>finagle-serversets</cite>: Memoize getChildrenWatchOp instead of globPrefixWatchOp</p></li>
<li><p><cite>finagle-serversets</cite>: Reuse ObjectMapper in JSON parser.</p></li>
<li><p><cite>finagle-serversets</cite>: add latency metrics for ServerSet2.</p></li>
<li><p><cite>finagle-zipkin</cite>: Reduce allocations when tracing</p></li>
</ul>
</section>
<section id="id395">
<h2>6.20.0<a class="headerlink" href="#id395" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle</cite>: Smattering of minor cleanups in util and finagle</p></li>
<li><p><cite>finagle</cite>: Upgrade sbt to 0.13</p></li>
<li><p><cite>finagle</cite>: Upgrade to Netty 3.9.1.1.Final</p></li>
<li><p><cite>finagle-core</cite>: Add NameTree.Fail to permit failing a name without fallback</p></li>
<li><p><cite>finagle-core</cite>: Add a generic DtabStatsFilter</p></li>
<li><p><cite>finagle-core</cite>: Add a singleton exception and a counter in WatermarkPool</p></li>
<li><p><cite>finagle-core</cite>: DefaultClient in terms of StackClient</p></li>
<li><p><cite>finagle-core</cite>: Disable Netty’s thread renaming</p></li>
<li><p><cite>finagle-core</cite>: Fix CumulativeGauge memory leak</p></li>
<li><p><cite>finagle-core</cite>: Fix negative resolution in Namer.global</p></li>
<li><p><cite>finagle-core</cite>: Fixed ChannelStatsHandler to properly filter exceptions</p></li>
<li><p><cite>finagle-core</cite>: Forces finagle-core to use ipv4 network stack</p></li>
<li><p><cite>finagle-core</cite>: Improve <cite>Failure.toString</cite></p></li>
<li><p><cite>finagle-core</cite>: Include path and Dtab.local in NoBrokersAvailableException</p></li>
<li><p><cite>finagle-core</cite>: Log exceptions caught by ChannelStatsHandler</p></li>
<li><p><cite>finagle-core</cite>: Make timer-based DNS resolution as default of InetResolver</p></li>
<li><p><cite>finagle-core</cite>: Reader and getContent symmetry</p></li>
<li><p><cite>finagle-core</cite>: Reduces log level for common exceptions</p></li>
<li><p><cite>finagle-core</cite>: Register clients centrally</p></li>
<li><p><cite>finagle-doc</cite>: Add fintop to companion projects list on Finagle website</p></li>
<li><p><cite>finagle-http</cite>: Don’t emit (illegal) newlines in lengthy dtab header values</p></li>
<li><p><cite>finagle-http</cite>: Fix code style from an open-source contribution</p></li>
<li><p><cite>finagle-http</cite>: Migrate from specs to scalatest</p></li>
<li><p><cite>finagle-kestrel</cite>: Make transaction abort timeout configurable in MultiReader</p></li>
<li><p><cite>finagle-mux</cite>: Added extra client logging</p></li>
<li><p><cite>finagle-mux</cite>: Fix broken draining behavior</p></li>
<li><p><cite>finagle-mux</cite>: Improve granularity of rate to bytes/millisecond</p></li>
<li><p><cite>finagle-serversets</cite>: Handle errors that occur when fetching endpoints</p></li>
<li><p><cite>finagle-serversets</cite>: Increase ZK session timeout to 10 seconds</p></li>
<li><p><cite>finagle-serversets</cite>: Merge WeightedSocketAddresses with same host:port but different weight in Stabilizer</p></li>
<li><p><cite>finagle-serversets</cite>: Synchronize bug fixes &amp; test coverage across ZK facades</p></li>
<li><p><cite>finagle-swift</cite>: Fixes pants build warning</p></li>
<li><p><cite>finagle-thrift</cite>: Add explicit dependency on libthrift</p></li>
<li><p><cite>finagle-thrift</cite>: Remove usage of java_sources, should be able to depend on it normally</p></li>
</ul>
</section>
<section id="id396">
<h2>6.19.0<a class="headerlink" href="#id396" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Allow trailing semicolons in dtabs</p></li>
<li><p><cite>finagle-core</cite>: Rescue exceptions thrown by filter in <cite>Filter.andthen(Filter)</cite></p></li>
<li><p><cite>finagle-core</cite>: StackClient, StackClientLike don’t leak underlying In, Out types</p></li>
<li><p><cite>finagle-doc</cite>: Clarify cancellation</p></li>
<li><p><cite>finagle-doc</cite>: Fix broken link in document</p></li>
<li><p><cite>finagle-doc</cite>: Fix name footnote in finagle Names docs</p></li>
<li><p><cite>finagle-http</cite>: Buf, Reader remove Buf.Eof; end-of-stream is None</p></li>
<li><p><cite>finagle-http</cite>: Prepend comment to JSONP callbacks</p></li>
<li><p><cite>finagle-http</cite>: Removing specs from the CookieMapSpec test.</p></li>
<li><p><cite>finagle-kestrel</cite>: Make failFast configurable in Kestrel codec</p></li>
<li><p><cite>finagle-mysql</cite>: Ensure mysql specific tracing is composed.</p></li>
<li><p><cite>finagle-mysql</cite>: Finagle MySQL PreparedStatement accepts Value types as params.</p></li>
<li><p><cite>finagle-serversets</cite>: Identity Providers for Serverset2</p></li>
<li><p><cite>finagle-thriftmux</cite>: Add withProtocolFactory API endpoint</p></li>
<li><p><cite>finagle-thriftmux</cite>: Don’t reuse InMemoryStatsReceiver in the same test</p></li>
</ul>
</section>
<section id="id397">
<h2>6.18.0<a class="headerlink" href="#id397" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-*</cite>: release scrooge v3.16.0</p></li>
<li><p><cite>finagle-*</cite>: release util v6.18.0</p></li>
<li><p><cite>finagle-core</cite>: Add <cite>description</cite> field to com.twitter.finagle.Stackable trait</p></li>
<li><p><cite>finagle-core</cite>: Add a Flag to turn on per-host stats</p></li>
<li><p><cite>finagle-core</cite>: Add a service acquisition latency stat to StatsFactoryWrapper</p></li>
<li><p><cite>finagle-core</cite>: Don’t support empty path elements in com.twitter.finagle.Path</p></li>
<li><p><cite>finagle-core</cite>: Improves FailFastFactory documentation</p></li>
<li><p><cite>finagle-core</cite>: Make c.t.f.Failure a direct subclass of Exception</p></li>
<li><p><cite>finagle-core</cite>: Skip SOCKS proxy when connecting to loopback address</p></li>
<li><p><cite>finagle-core</cite>: Use Monitor from caller’s context in DefaultTimer</p></li>
<li><p><cite>finagle-http</cite>: Add “Enhance Your Calm” and “Too Many Requests” HTTP status codes</p></li>
<li><p><cite>finagle-http</cite>: Add exp.HttpServer, which allows request limits to be configured</p></li>
<li><p><cite>finagle-http</cite>: Change Request#params to a memoized def</p></li>
<li><p><cite>finagle-http</cite>: Stream request body</p></li>
<li><p><cite>finagle-kestrel</cite>: Add Name-based methods for MultiReader construction</p></li>
<li><p><cite>finagle-memcached</cite>: Expose the client type <cite>KetamaClient</cite> in the <cite>build()</cite> API</p></li>
<li><p><cite>finagle-mux</cite>: GC Avoidance Algorithm</p></li>
<li><p><cite>finagle-mux</cite>: Hook up GC avoidance to servers</p></li>
<li><p><cite>finagle-mux</cite>: Move UseMux.java to the correct directory</p></li>
<li><p><cite>finagle-serversets</cite>: Randomizes backoff interval in ZK2</p></li>
<li><p><cite>finagle-serversets</cite>: Start resolution eagerly in ZK2</p></li>
<li><p><cite>finagle-stats</cite>: Add a stat-filtration GlobalFlag</p></li>
<li><p><cite>ostrich</cite>: release ostrich v9.5.2</p></li>
<li><p><cite>user guide</cite>: Add Google Analytics tracking code</p></li>
<li><p><cite>user guide</cite>: Add sections about review process and starter issues</p></li>
<li><p><cite>user guide</cite>: Update Finagle adopter list on user guide website</p></li>
<li><p><cite>wily</cite>: Add Dtab expansion</p></li>
</ul>
</section>
<section id="id398">
<h2>6.17.0<a class="headerlink" href="#id398" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle</cite>: Add list of Finagle adopters</p></li>
<li><p><cite>finagle</cite>: Upgrade third-party dependencies</p></li>
<li><p><cite>finagle-core</cite>: Add <cite>Addr.Neg</cite> to the user guide’s list of Addr types</p></li>
<li><p><cite>finagle-core</cite>: Added Failure support for sourcing to finagle</p></li>
<li><p><cite>finagle-core</cite>: ClientBuilder should turn per-host stats off by default (matching new Client building API).</p></li>
<li><p><cite>finagle-core</cite>: Implement DefaultServer in terms of StackServer</p></li>
<li><p><cite>finagle-core</cite>: Improve the Dtab API</p></li>
<li><p><cite>finagle-core</cite>: Prevent scoping stats with the empty-string</p></li>
<li><p><cite>finagle-core</cite>: Rolls up the /tries scope properly</p></li>
<li><p><cite>finagle-core</cite>: ServerStatsReceiver and ClientStatsReceiver can now update their root scope</p></li>
<li><p><cite>finagle-core</cite>: fix race case in DelayedFactory</p></li>
<li><p><cite>finagle-core</cite>: introduce AbstractResolver</p></li>
<li><p><cite>finagle-core</cite>: remove need for hostConnectionLimit when using ClientBuilder#stack</p></li>
<li><p><cite>finagle-core</cite>: widen to type for ServerBuilder#stack</p></li>
<li><p><cite>finagle-core</cite>: widen type of ClientBuilder#stack</p></li>
<li><p><cite>finagle-doc</cite>: Removed a line from conf.py</p></li>
<li><p><cite>finagle-http</cite>: DtabFilter should always clear dtab headers</p></li>
<li><p><cite>finagle-http</cite>: add HOST header for CONNECT method</p></li>
<li><p><cite>finagle-http</cite>: scala 2.10 compatible tests</p></li>
<li><p><cite>finagle-memcached</cite>: filter out one more cancelling request exception in failure accrual</p></li>
<li><p><cite>finagle-memcached</cite>: remove empty test</p></li>
<li><p><cite>finagle-mux</cite>: Improve Mux server close behavior, control messages to non-Mux clients</p></li>
<li><p><cite>finagle-mux</cite>: Marked a gc test as flaky</p></li>
<li><p><cite>finagle-mux</cite>: Modifies MuxService to essentially be a Service[Spool[Buf], Spool[Buf]] Problem</p></li>
<li><p><cite>finagle-mux</cite>: Rm ClientHangupException in favor of CancelledRequestException</p></li>
<li><p><cite>finagle-mysql</cite>: Retrieving a timestamp from the DB nw creates a timestamp in UTC</p></li>
<li><p><cite>finagle-mysql</cite>: fix for issue where time was not being returned in UTC for binary protocol</p></li>
<li><p><cite>finagle-serversets</cite>: Prevent gauges from being garbage collected</p></li>
<li><p><cite>finagle-thrift</cite>: Blackhole control messages sent to non-mux Thrift clients</p></li>
<li><p><cite>finagle-thriftmux</cite>: Add per-connection protocol-usage stats</p></li>
<li><p><cite>finagle-thriftmux</cite>: Add stats to identify ThriftMux clients and servers</p></li>
<li><p><cite>finagle-thriftmux</cite>: Propagate Contexts from non-ThriftMux clients</p></li>
<li><p><cite>finagle-thriftmux</cite>: add ClientBuilder#stack compatibility and make APIs symmetric</p></li>
<li><p><cite>finagle-thriftmux</cite>: pass along ClientId with ClientBuilder API</p></li>
</ul>
</section>
<section id="id399">
<h2>6.16.0<a class="headerlink" href="#id399" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Add Stack#remove</p></li>
<li><p><cite>finagle-core</cite>: Add a copy constructor to Stack{Client, Server}</p></li>
<li><p><cite>finagle-core</cite>: Fixed a typo in scaladoc <a class="reference external" href="https://github.com/twitter/finagle/pull/264">https://github.com/twitter/finagle/pull/264</a></p></li>
<li><p><cite>finagle-core</cite>: Implement ClientBuilder in terms of StackClient</p></li>
<li><p><cite>finagle-core</cite>: Invert the <cite>cancelOnHangup</cite> value passed to MaskCancelFilter.Param</p></li>
<li><p><cite>finagle-core</cite>: Liberate Failure</p></li>
<li><p><cite>finagle-core</cite>: Log all services loaded by c.t.finagle.util.LoadService</p></li>
<li><p><cite>finagle-core</cite>: Minor c.t.app.ClassPath/c.t.f.util.LoadService cleanup</p></li>
<li><p><cite>finagle-core</cite>: Properly close sockets on shutdown</p></li>
<li><p><cite>finagle-core</cite>: Properly scope stats by label in Stack{Client,Server}</p></li>
<li><p><cite>finagle-core</cite>: Remove <cite>Stack{Server,Client}.transformed</cite></p></li>
<li><p><cite>finagle-core</cite>: Scoped the RollupStatsReceiver carefully</p></li>
<li><p><cite>finagle-core</cite>: Thread through Codec#newClientTransport in ClientBuilder</p></li>
<li><p><cite>finagle-core</cite>: Update to netty-3.9.1.Final</p></li>
<li><p><cite>finagle-example</cite>: Add Java Thrift client and server</p></li>
<li><p><cite>finagle-http</cite>: Add Csv,Xls,Zip to finagle MediaType</p></li>
<li><p><cite>finagle-http</cite>: Adds tls support to finagle 6 apis</p></li>
<li><p><cite>finagle-http</cite>: Set the response content-length header to 0 in ExceptionFilter.</p></li>
<li><p><cite>finagle-kestrel</cite>: Add Thrift support to Kestrel MultiReader in Finagle-Kestrel</p></li>
<li><p><cite>finagle-mux</cite>: Cleaned up build information</p></li>
<li><p><cite>finagle-mux</cite>: GC Avoidance primitives</p></li>
<li><p><cite>finagle-mux</cite>: Move exp.MuxClient and exp.MuxServer</p></li>
<li><p><cite>finagle-mux</cite>: Record tracing info when Mux is enabled</p></li>
<li><p><cite>finagle-mux</cite>: Refactor Session to make closing a Session uniform</p></li>
<li><p><cite>finagle-mux</cite>: Render mux clients leasable</p></li>
<li><p><cite>finagle-redis</cite>: Added support for redis MOVE command.</p></li>
<li><p><cite>finagle-serversets</cite>: Reduce the number of intermediate datastructures</p></li>
<li><p><cite>finagle-thriftmux</cite>: Add ThriftMux.withClientId</p></li>
<li><p><cite>finagle-thriftmux</cite>: Maintain legacy client and server names</p></li>
<li><p><cite>finagle-{core,thrift,mux}</cite>: Clean up contexts, delimit Locals</p></li>
</ul>
</section>
<section id="id400">
<h2>6.15.0<a class="headerlink" href="#id400" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Fixed DefaultClient to use the base close method</p></li>
<li><p><cite>finagle-core</cite>: Fix a race condition when closing in DefaultServer</p></li>
<li><p><cite>finagle-serversets</cite>: memoize path parses in ServerSet2</p></li>
<li><p><cite>finagle-mux</cite>: remove references to org.jboss.netty.util.CharsetUtil</p></li>
<li><p><cite>finagle-http</cite>: create HttpTransport in codec</p></li>
<li><p><cite>finagle-http</cite>: fix basic authentication with special characters</p></li>
<li><p><cite>finagle-http</cite>: temporary fix for prematurely expiring streaming responses</p></li>
<li><p><cite>finagle-core</cite>: don’t discard outstanding readq elements in ChannelTransport</p></li>
<li><p><cite>finagle-core</cite>: Add Socks Proxy Authentication support</p></li>
<li><p><cite>finagle-doc</cite>: fix image size in client stack figure.</p></li>
<li><p><cite>finagle-stats</cite>: unregister cumulative gauges when all references have been collected</p></li>
<li><p><cite>finagle-core</cite>: fix truncation in ChannelBufferBuf#slice()</p></li>
<li><p><cite>finagle-stats</cite>: upgrade to the latest version of metrics</p></li>
<li><p><cite>finagle-stats</cite>: Enable cumulative gauges in MetricsStatsReceiver</p></li>
<li><p><cite>finagle-mysql</cite>: Move mysql testing out of finagle-mysql</p></li>
<li><p><cite>finagle-serversets</cite>: serverset namer - synthesize nodes for each endpoint</p></li>
<li><p><cite>finagle-http</cite>: fix HttpClientDispatcher</p></li>
<li><p><cite>finagle-core</cite>: transport should be considered closed if it is failed</p></li>
<li><p><cite>finagle-core</cite>: Improve the failure for cancelled requests in the ClientDispatcher</p></li>
<li><p><cite>finagle-core</cite>: LocalScheduler - add LIFO option</p></li>
<li><p><cite>finagle-core</cite>: don’t join after interrupt in Exitguard.Unguard()</p></li>
<li><p><cite>finagle-serversets</cite>: Replaces Op with Activity Problem</p></li>
<li><p><cite>finagle-mysql</cite>: implement builder using StackClient.</p></li>
<li><p><cite>finagle-core</cite>: Make LoadService not fail if a sub-dir is not readable</p></li>
<li><p><cite>finagle-core</cite>: Make com.twitter.finagle.Name an ADT</p></li>
<li><p><cite>finagle-core</cite>: curry <cite>newDispatcher</cite> in Stack{Client, Server}</p></li>
<li><p><cite>finagle-thriftmux</cite>: Add a flag for enabling ThriftMux</p></li>
<li><p><cite>finagle-doc</cite>: improved rastering of logos</p></li>
<li><p><cite>finagle-core</cite>: Retry on com.twitter.util.TimeoutException</p></li>
<li><p><cite>finagle-core</cite>: introduce ForkJoinScheduler</p></li>
<li><p><cite>finagle-serversets</cite>: facade for ZooKeeper libraries</p></li>
</ul>
</section>
<section id="id401">
<h2>6.14.0<a class="headerlink" href="#id401" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-*</cite>: Add com.twitter.io.Charsets and replace the use of org.jboss.netty.util.CharsetUtil</p></li>
<li><p><cite>finagle-benchmark</cite>: Fix caliper failures due to new guava</p></li>
<li><p><cite>finagle-core</cite>: Disable Monitor usage of in Netty3Listener</p></li>
<li><p><cite>finagle-core</cite>: Enforce usage of c.t.finagle.util.DefaultLogger</p></li>
<li><p><cite>finagle-core</cite>: Fix a Netty3Timer capitalization bug</p></li>
<li><p><cite>finagle-core</cite>: Fixed unresolved promises in client dispatcher</p></li>
<li><p><cite>finagle-core</cite>: Implement ServerBuilder in terms of StackServer.</p></li>
<li><p><cite>finagle-core</cite>: Introduce 2-level caching in the name interpreter</p></li>
<li><p><cite>finagle-core</cite>: Introduce Failure interface (internally)</p></li>
<li><p><cite>finagle-core</cite>: Introduce StackServer</p></li>
<li><p><cite>finagle-core</cite>: Introduce a flag for debug tracing</p></li>
<li><p><cite>finagle-core</cite>: Make StackClient symmetric to StackServer</p></li>
<li><p><cite>finagle-core</cite>: Parse names into trees; introduce separate evaluation.</p></li>
<li><p><cite>finagle-core</cite>: Remove redundant Netty3Timer param def</p></li>
<li><p><cite>finagle-core</cite>: Resolver.resolve throws IllegalArgumentException on logical name</p></li>
<li><p><cite>finagle-core</cite>: RetryPolicy filter, limit, combine</p></li>
<li><p><cite>finagle-core</cite>: Thread through NullReporterFactory in ServerBuilder.</p></li>
<li><p><cite>finagle-core</cite>: Use DefaultLoadBalancerFactory</p></li>
<li><p><cite>finagle-core</cite>: Use JDK6-friendly RuntimeException constructor in Failure</p></li>
<li><p><cite>finagle-doc</cite>: README refresh</p></li>
<li><p><cite>finagle-doc</cite>: Refresh client stack docs</p></li>
<li><p><cite>finagle-memcached</cite>: Ketama memcache: accept weighted addresses</p></li>
<li><p><cite>finagle-mux</cite>: Add server-side Stack wiring for Mux and ThriftMux</p></li>
<li><p><cite>finagle-mysql</cite>: Proper prepared statement support.</p></li>
<li><p><cite>finagle-serversets</cite>: Add Read-Only ZK support to zk2 Resolver</p></li>
<li><p><cite>finagle-serversets</cite>: Zk2: deliver events serially in their own thread</p></li>
<li><p><cite>finagle-thrift</cite>: workaround libthrift TBinaryProtocol.writeBinary bug</p></li>
<li><p><cite>finagle-zipkin</cite>: Include service name in all traces</p></li>
</ul>
</section>
<section id="id402">
<h2>6.13.1<a class="headerlink" href="#id402" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Case insensitive Dtab headers in HTTP codec</p></li>
<li><p><cite>finagle-core</cite>: Introduce Stack.Params#contains</p></li>
<li><p><cite>finagle-docs</cite>: address small style nits</p></li>
<li><p><cite>finagle-http</cite>: support reading params in content body for HTTP methods other than POST and PUT</p></li>
<li><p><cite>finagle-memcached</cite>: add ketamaclient initial readiness before the first request</p></li>
<li><p><cite>finagle-serversets</cite>: Disable retry behavior but turn exception into negative resolution.</p></li>
<li><p><cite>finagle-serversets</cite>: Stabilizer: don’t consider Pending update successful</p></li>
<li><p><cite>finagle-stats</cite>: use java.lang.Double in addGauge()</p></li>
<li><p><cite>finagle</cite>: Add <cite>cause</cite> Throwables for all ConnectionFailedExceptions</p></li>
<li><p><cite>finagle</cite>: Fix Travis-CI integration.</p></li>
<li><p><cite>finagle</cite>: Swap Stack.Node and Stack.Leaf args in toString formatting</p></li>
<li><p><cite>finagle</cite>: Update 3rdparty library versions</p></li>
<li><p><cite>finagle</cite>: Upgrade birdcage to guava 16</p></li>
<li><p><cite>finagle</cite>: upgrade ostrich to 9.4.2</p></li>
<li><p><cite>finagle</cite>: upgrade util to 6.13.2</p></li>
</ul>
</section>
<section id="id403">
<h2>6.13.0<a class="headerlink" href="#id403" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: ForkJoin scheduler: first draft</p></li>
<li><p><cite>finagle-doc</cite>: Update URL to Finagle blog post. Motivation: Outdated URL</p></li>
<li><p><cite>finagle-http</cite>: compress text-like content-types by default</p></li>
<li><p><cite>finagle-memcached</cite>: Mark test “not migrating yet” as flaky</p></li>
<li><p><cite>finagle-mux</cite>: don’t delegate empty dtabs</p></li>
<li><p><cite>finagle-mysql</cite>: Better failure handling for the dispatcher</p></li>
<li><p><cite>finagle-ostrich4</cite>: Make OstrichExporter compatible with Ostrich CommandHandler.</p></li>
<li><p><cite>finagle-redis</cite>: Add SINTER command to redis client</p></li>
<li><p><cite>finagle-redis</cite>: Allow an empty string as a hash field value</p></li>
<li><p><cite>finagle-redis</cite>: Fixed the empty string issue of MBULK_REPLY</p></li>
<li><p><cite>finagle-serverset</cite>: ServerSets2: reset value on SyncConnected</p></li>
<li><p><cite>finagle-stats</cite>: Upgrade metrics dependency to the latest version.</p></li>
<li><p><cite>finagle-thrift</cite>: Do not rely on ThreadLocal’d ClientIds in TTwitterFilter</p></li>
<li><p><cite>finagle-thrift[mux]</cite>: Reintroduce ClientIdContext by default</p></li>
<li><p><cite>finagle-zipkin</cite>: TraceId invariance</p></li>
<li><p><cite>finagle/S2</cite>: introduce address stabilization, stats</p></li>
<li><p><cite>finagle</cite>: Add Mux and ThriftMux Clients based on com.twitter.finagle.Stack</p></li>
<li><p><cite>finagle</cite>: fix dependency problem with multiple version of serversets</p></li>
<li><p><cite>finagle</cite>: Fix the sbt doc generation (and tests)</p></li>
<li><p><cite>finagle</cite>: upgrade Netty to 3.8.1</p></li>
<li><p><cite>finagle</cite>: upgrade ostrich to version 9.4.0</p></li>
<li><p><cite>finagle</cite>: upgrade util to version 6.13.0</p></li>
</ul>
</section>
<section id="id404">
<h2>6.12.2<a class="headerlink" href="#id404" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle</cite>: release scrooge version 3.12.3</p></li>
<li><p><cite>finagle-exception</cite>: Drop scrooge in favor of pre-generated Thrift Java source code.</p></li>
<li><p><cite>finagle-zipkin</cite>: Drop scrooge in favor of pre-generated Thrift Java source code.</p></li>
</ul>
</section>
<section id="id405">
<h2>6.12.1<a class="headerlink" href="#id405" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle</cite>: release ostrich version 9.3.1</p></li>
<li><p><cite>finagle</cite>: release util version 6.12.1</p></li>
<li><p><cite>finagle</cite>: Upgrade everyone to the new c.t.common.server-set</p></li>
</ul>
</section>
<section id="id406">
<h2>6.12.0<a class="headerlink" href="#id406" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Add a <cite>ServerBuilder.safeBuild(ServiceFactory)</cite> method for Java compatibility</p></li>
<li><p><cite>finagle-core</cite>: Add basic Scaladocs for all Filters and Services</p></li>
<li><p><cite>finagle-core</cite>: close Name Var observation on service close</p></li>
<li><p><cite>finagle-core</cite>: com.twitter.finagle.Stack: initial version</p></li>
<li><p><cite>finagle-core</cite>: Fix race condition in server dispatcher draining state machine</p></li>
<li><p><cite>finagle-core</cite>: low hanging fruit</p></li>
<li><p><cite>finagle-core</cite>: Make <cite>Resolver.evalLabeled</cite> private[finagle]</p></li>
<li><p><cite>finagle-core</cite>: Option to enable thread pool scheduler in finagle”</p></li>
<li><p><cite>finagle-core</cite>: Record Finagle version in tracing information</p></li>
<li><p><cite>finagle-core</cite>: Remove a long-forgotten java file</p></li>
<li><p><cite>finagle-core</cite>: Separate stats scopes for service-creation and request failure</p></li>
<li><p><cite>finagle-core</cite>: TimeoutFactorySpec =&gt; TimeoutFactoryTest</p></li>
<li><p><cite>finagle-core</cite>: Users don’t get NPE on directories without permissions</p></li>
<li><p><cite>finagle-core</cite>: Weights, weighted load balancer, memoization</p></li>
<li><p><cite>finagle-core</cite>: Write <cite>Throwables.mkString</cite> in terms of ArrayBuffer instead of Seq</p></li>
<li><p><cite>finagle-doc</cite>: How do I change my timeouts in the Finagle 6 APIs?</p></li>
<li><p><cite>finagle-example</cite>: Port finagle-example thrift to new style APIs</p></li>
<li><p><cite>finagle-http</cite>: Add Dtab filter in RichHttp</p></li>
<li><p><cite>finagle-http</cite>: enable tracing on finagle 6 http api</p></li>
<li><p><cite>finagle-kestrel</cite>: Fix match-exhaustiveness issue in <cite>DecodingToResponse.parseResponse</cite></p></li>
<li><p><cite>finagle-kestrel</cite>: Use Var[Addr] as underlying cluster representation</p></li>
<li><p><cite>finagle-memcache</cite>: Add a parameter to disable host ejection from KetamaFailureAccrualFilter</p></li>
<li><p><cite>finagle-memcached</cite>: include response type for IllegalStateException</p></li>
<li><p><cite>finagle-mux</cite>: Adds lease support to mux clients</p></li>
<li><p><cite>finagle-mysql</cite>: Embeddable MySql support for Unit/Integration Testing in Finagle-MySql</p></li>
<li><p><cite>finagle-serversets</cite>: prevent MatchError when resolving zk path + endpoint</p></li>
<li><p><cite>finagle-serversets</cite>: Use ephemeral ports and <cite>Var.sample</cite> in tests</p></li>
<li><p><cite>finagle-serversets</cite>: Use the watch method instead of the now deprecated monitor method</p></li>
<li><p><cite>finagle-tracing</cite> /zipkin: remove some allocations</p></li>
<li><p><cite>finagle</cite>: update dependencies com.twitter.common*</p></li>
<li><p><cite>finagle</cite>: update ostrich to 9.3.0</p></li>
<li><p><cite>finagle</cite>: update util to 6.12.0</p></li>
<li><p><cite>finagle</cite>: Use a more descriptive message for when client name resolution is negative</p></li>
</ul>
</section>
<section id="id407">
<h2>6.11.1<a class="headerlink" href="#id407" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Masks cancellation on PipeliningDispatcher</p></li>
<li><p><cite>finagle-doc</cite>: Fix finagle-websocket link on Finagle docs website.</p></li>
<li><p><cite>finagle-http</cite>: Http client dispatcher</p></li>
<li><p><cite>finagle-kestrel</cite>: Add abort command to kestrel client</p></li>
</ul>
</section>
<section id="id408">
<h2>6.11.0<a class="headerlink" href="#id408" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Add a “tries” scoped StatsFilter to ClientBuilder.</p></li>
<li><p><cite>finagle-core</cite>: Allow clean shutdown for insoluble address in DelayedFactory.</p></li>
<li><p><cite>finagle-core</cite>: Better exception message for resolver not found issue.</p></li>
<li><p><cite>finagle-core</cite>: Introduce P2CLB: O(1), fair-weighted, concurrent load balancer</p></li>
<li><p><cite>finagle-core</cite>: Refactor dispatchers.</p></li>
<li><p><cite>finagle-core</cite>: Set interest ops when reading in ChannelTransport.</p></li>
<li><p><cite>finagle-core</cite>: Skip hostStatsReceiver rollup if it’s null in DefaultClient.</p></li>
<li><p><cite>finagle-core</cite>: Untyped ChannelTransports.</p></li>
<li><p><cite>finagle-example</cite>: Use new <cite>request.headers()</cite> Netty API.</p></li>
<li><p><cite>finagle-http</cite>: Proper streaming dispatch.</p></li>
<li><p><cite>finagle-kestrel</cite>: Make ReadHandle an abstract class for better Java compatibility.</p></li>
<li><p><cite>finagle-serversets</cite>: Fix com.twitter.common.zookeeper.server-set dependency discrepancy.</p></li>
<li><p><cite>finagle-serversets</cite>: Introduce ServerSet2.</p></li>
<li><p><cite>finagle-serversets</cite>: Weight/priority vectors in ServerSet2.</p></li>
<li><p><cite>finagle-stream</cite>: Use dispatch logic.</p></li>
<li><p><cite>finagle-stress</cite>: Use BridgedThreadPoolScheduler.</p></li>
<li><p><cite>finagle-thrift</cite>: Add TFinagleBinaryProtocol</p></li>
<li><p><cite>finagle-thriftmux</cite>: Drop dependency on finagle-ostrich4.</p></li>
<li><p><cite>finagle-thriftmux</cite>: Remove scrooge2 dependency.</p></li>
<li><p><cite>finagle</cite>: Use Future.before.</p></li>
<li><p><cite>finagle</cite>: adds a section to the FAQ explaining the com.twitter.common situation.</p></li>
<li><p><cite>finagle</cite>: s/setValue(())/setDone()/g</p></li>
</ul>
</section>
<section id="id409">
<h2>6.10.0<a class="headerlink" href="#id409" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Fix ServiceTimeoutException naming.</p></li>
<li><p><cite>finagle-core</cite>: Increase default tcpConnectTimeout to 350ms.</p></li>
<li><p><cite>finagle-core</cite>: Remove memory leak for never satisfied promises in DelayedFactory.</p></li>
<li><p><cite>finagle-memcached</cite>: Add ClientBuilder APIs that use Name instead of Group.</p></li>
<li><p><cite>finagle</cite>: Daemonize threads in ClientBuilders used in finagle.</p></li>
</ul>
</section>
<section id="id410">
<h2>6.9.0<a class="headerlink" href="#id410" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Avoid creating a new ‘NoStacktrace’ array for each exception.</p></li>
<li><p><cite>finagle-core</cite>: Better support for negative Addr resolution in StabilizingAddr.</p></li>
<li><p><cite>finagle-core</cite>: Make Dtab.base changeable.</p></li>
<li><p><cite>finagle-core</cite>: Move mask cancel filter over to Future#mask.</p></li>
<li><p><cite>finagle-exp</cite>: New warmup filter.</p></li>
<li><p><cite>finagle-ostrich4</cite>: Deprecate Netty methods.</p></li>
<li><p><cite>finagle-serversets</cite>: Better handling of permission exceptions in ZkResolver.</p></li>
<li><p><cite>finagle-testers</cite>: Small latency evaluation framework.</p></li>
<li><p><cite>finagle</cite>: Adhere to scala 2.10 pattern matching strictness.</p></li>
</ul>
</section>
<section id="id411">
<h2>6.8.1<a class="headerlink" href="#id411" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle</cite>: Upgrade ostrich to 9.2.1</p></li>
<li><p><cite>finagle</cite>: Upgarde util to 6.8.1</p></li>
<li><p><cite>finagle</cite>: Upgarde scrooge to 3.11.1</p></li>
</ul>
</section>
<section id="id412">
<h2>6.8.0<a class="headerlink" href="#id412" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-serversets</cite>: Higher fidelity addrs from ZK We do the best we can with the current server set implementation.</p></li>
<li><p><cite>finagle-mysql</cite>: better type support</p></li>
<li><p><cite>finagle-http</cite>: Allow Integer to extract negative number</p></li>
<li><p><cite>finagle-redis</cite>: Decode nested multi-bulk replies</p></li>
<li><p><cite>finagle-redis</cite>: Allow expirations in the past</p></li>
<li><p><cite>finagle-core</cite>: bump Netty to 3.8.0.Final</p></li>
<li><p><cite>finagle</cite>: Return empty string when resolving an unlabeled address</p></li>
<li><p><cite>finagle</cite>: Don’t re-scope StatsReceivers per request failure</p></li>
<li><p><cite>finagle-thrift</cite>: Unconditionally set TraceId and ClientId on servers</p></li>
<li><p><cite>finagle-core</cite>: Take -com.twitter.server.serversetZkHosts flag (for tunnelling)</p></li>
<li><p><cite>finagle-native</cite>: tomcat-native-1.1.27</p></li>
<li><p><cite>finagle-mysql</cite>: fix readLengthCodedBinary to read longs</p></li>
<li><p><cite>finagle-testers</cite>: library for integration testing of finagle services</p></li>
<li><p><cite>finagle</cite>: scaladoc warning cleanup</p></li>
<li><p><cite>finagle-doc</cite>: documented all of the stats in finagle-core</p></li>
<li><p><cite>finagle-serversets</cite>: bump server-set dependency to 1.0.56</p></li>
<li><p><cite>finagle-stats</cite>: adds a cautious registration to HttpMuxer / adds a default metrics endpoint to twitter-server</p></li>
<li><p><cite>finagle-core</cite>: verifies that statsfilter has the correct behavior</p></li>
<li><p><cite>finagle-serversets</cite>: Add support for parsing a !shardId on the end of a serverset address</p></li>
<li><p><cite>finagle-http</cite>: Use Reader for streaming</p></li>
<li><p><cite>finagle-core</cite>: no longer makes an anonymous exception in DefaultClient</p></li>
<li><p><cite>finagle-core</cite>: Using system class loader does not work when run inside sbt</p></li>
<li><p><cite>finagle-core</cite>: add pool_num_waited counter to WatermarkPool</p></li>
<li><p><cite>finagle-core</cite>: Protocol support for Wily: HTTP, thrift, mux (&amp; thus thriftmux).</p></li>
<li><p><cite>finagle-core</cite>: respect standard socksProxyHost / socksProxyPort properties in ClientBuilder and Netty3Transporter default args</p></li>
<li><p><cite>finagle-core</cite>: buffers requests until Var[Addr] is in a ready state</p></li>
<li><p><cite>finagle-core</cite>: Add putLong and getLong functions to util.ByteArrays</p></li>
<li><p><cite>finagle-core</cite>: don’t blow up if we don’t have a resolvable host name</p></li>
<li><p><cite>finagle-core</cite>: rm allocation in RichChannelFuture.apply’s operationComplete</p></li>
<li><p><cite>finagle-core</cite>: remove Var.apply; introduce Var.sample</p></li>
<li><p><cite>finagle-thriftmux</cite>: Support ClientIds at the protocol level</p></li>
<li><p><cite>finagle-kestrel</cite>: memory allocation improvements</p></li>
<li><p><cite>finagle-http</cite>: allow PUT requests to use RequestParamMap.postParams</p></li>
<li><p><cite>finagle-memcached</cite>: more performance and less allocations in Decoder</p></li>
</ul>
</section>
<section id="id413">
<h2>6.7.4<a class="headerlink" href="#id413" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Fail ChannelTransport read queue before closing the connection</p></li>
<li><p><cite>finagle-mux</cite>: Add session for mux message passing and bidirectional RPC</p></li>
<li><p><cite>finagle-zipkin</cite>: Depend on scrooge-core instead of scrooge-runtime</p></li>
</ul>
</section>
<section id="id414">
<h2>6.7.2<a class="headerlink" href="#id414" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: LoadService: skip empty lines</p></li>
<li><p><cite>finagle-core</cite>: Improve GC profile of Var and Group</p></li>
<li><p><cite>finagle-core</cite>: added a simple defaultpool test to show how it works + more docs</p></li>
<li><p><cite>finagle-core</cite>: removes commented out casting filter</p></li>
<li><p><cite>finagle-mysql</cite>: move protocol into a dispatcher and port to new style apis.</p></li>
</ul>
</section>
<section id="id415">
<h2>6.7.1<a class="headerlink" href="#id415" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-*</cite>: Tagging various tests as flaky</p></li>
<li><p><cite>finagle-*</cite>: Fix and reenable some formerly-flaky tests Now that Time.withXXXX is threadsafe</p></li>
<li><p><cite>finagle-*</cite>: Move Var to util</p></li>
<li><p><cite>finagle-*</cite>: Provide generic request contexts</p></li>
<li><p><cite>finagle-*</cite>: Use scrooge3 and up-to-date scrooge-maven-plugin settings</p></li>
<li><p><cite>finagle-*</cite>: upgrade Netty to 3.7.0.Final</p></li>
<li><p><cite>finagle-core</cite>: Add UnwritableChannel stat to ChannelStatsHandler</p></li>
<li><p><cite>finagle-core</cite>: Add a test for Proc exception-swallowing</p></li>
<li><p><cite>finagle-core</cite>: Better interface for RetryPolicy</p></li>
<li><p><cite>finagle-core</cite>: Ensure FIFO ordering when delivering updates to StabilizingGroup</p></li>
<li><p><cite>finagle-core</cite>: Export a health stat in StabilizingGroup</p></li>
<li><p><cite>finagle-core</cite>: Fix a race condition in ListeningSever.announce and don’t announce 0.0.0.0</p></li>
<li><p><cite>finagle-core</cite>: Fix sourcing for SourcedExceptions</p></li>
<li><p><cite>finagle-core</cite>: Group: communicate via Var[Set[T]]</p></li>
<li><p><cite>finagle-core</cite>: Improve HeapBalancer req distribution when N=2</p></li>
<li><p><cite>finagle-core</cite>: Introduce staged names</p></li>
<li><p><cite>finagle-core</cite>: Let the number of cores be specified on the command line</p></li>
<li><p><cite>finagle-core</cite>: Make socket writable duration stats more useful</p></li>
<li><p><cite>finagle-core</cite>: Migrate RetryingFilter tests from specs to scalatest</p></li>
<li><p><cite>finagle-core</cite>: Move the connections gauge into ChannelStatsHandler for GC</p></li>
<li><p><cite>finagle-core</cite>: Reuse a single exception instance in ServerDispatcher</p></li>
<li><p><cite>finagle-core</cite>: Update com.twitter.finagle package documentation</p></li>
<li><p><cite>finagle-doc</cite>: Add Client/Server Anatomy to docs</p></li>
<li><p><cite>finagle-doc</cite>: Link to “Your Server as a Function”</p></li>
<li><p><cite>finagle-http</cite>: Proper CORS implementation on Finagle</p></li>
<li><p><cite>finagle-http</cite>: SPNEGO http auth (for Kerberos) with an example implementation for internal services</p></li>
<li><p><cite>finagle-memcached</cite>: Exclude CancelledRequestException and CancelledConectionException or cache client failure accrual</p></li>
<li><p><cite>finagle-memcached</cite>: Read key remapping config from ZooKeeper</p></li>
<li><p><cite>finagle-memcached</cite>: ZK based cache node group implementation</p></li>
<li><p><cite>finagle-redis</cite>: SRandMember, send command without count when None</p></li>
<li><p><cite>finagle-serversets</cite>: Mark ZookeeperServerSetCluster as deprecated</p></li>
<li><p><cite>finagle-thrift</cite>: Add a request context for ClientId</p></li>
<li><p><cite>finagle-thrift</cite>: Set the client id in thriftmux</p></li>
</ul>
</section>
<section id="id416">
<h2>6.7.0<a class="headerlink" href="#id416" title="Permalink to this headline">¶</a></h2>
<p>Release process failed. Rolled forward to 6.7.1.</p>
</section>
<section id="id417">
<h2>6.6.2<a class="headerlink" href="#id417" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Configurable loadBalancer for ClientConfig</p></li>
<li><p><cite>finagle-core</cite>: Fix the memory leak due to the GlobalStatsReceiver</p></li>
<li><p><cite>finagle-core</cite>: Inet util, bind to all if no host is provided</p></li>
<li><p><cite>finagle-core</cite>: Make Future.never a val instead of a def</p></li>
<li><p><cite>finagle-memcached</cite>: Fix tracing ClientRecv timestamp</p></li>
<li><p><cite>finagle</cite>: New ostrich version</p></li>
</ul>
</section>
<section id="id418">
<h2>6.6.0<a class="headerlink" href="#id418" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Add a RetryPolicy constant for retrying on ChannelClosedExceptions.</p></li>
<li><p><cite>finagle-core</cite>: ChannelSnooper: Print exceptions via Logger</p></li>
<li><p><cite>finagle-core</cite>: Finagle client/server APIs: s/target/addr/g</p></li>
<li><p><cite>finagle-core</cite>: Introduce swappable schedulers, ThreadPool scheduler.</p></li>
<li><p><cite>finagle-core</cite>: Replacing ostrich-specific Stats with StatsReceiver interface</p></li>
<li><p><cite>finagle-core</cite>: Tests for BroadcastStatsReceiver</p></li>
<li><p><cite>finagle-core</cite>: adding service name to a service exception</p></li>
<li><p><cite>finagle-core</cite>: fix file mispelling for StabilizingGroup.scala</p></li>
<li><p><cite>finagle-core</cite>: fix memory leak in Group#fromCluster</p></li>
<li><p><cite>finagle-core</cite>: refactor use of InetSocketAddress group and deprecate use of cluster in cache client</p></li>
<li><p><cite>finagle-http</cite>: Add Access-Control-Expose-Headers to Finagle CORSFilter</p></li>
<li><p><cite>finagle-http</cite>: Fix Path comments, improve sbt definition</p></li>
<li><p><cite>finagle-http</cite>: Http connection manager: close synchronously</p></li>
<li><p><cite>finagle-http</cite>: Make behavior of HttpMuxer match its javadoc</p></li>
<li><p><cite>finagle-http</cite>: Mix in Proxy with HttpMessageProxy</p></li>
<li><p><cite>finagle-http</cite>: bump request/response sizes to 5 megs</p></li>
<li><p><cite>finagle-memcached</cite>: Memcached Ketama Client Builder: Add group support that is compatible with oldlibmemcached , creates CacheNodes with ipAddress instead of hostname.</p></li>
<li><p><cite>finagle-memcached</cite>: Update jackson to 2.2.2</p></li>
<li><p><cite>finagle-memcached</cite>: allow custom key in ketama client</p></li>
<li><p><cite>finagle-memcached</cite>: better exception messages for invalid keys</p></li>
<li><p><cite>finagle-memcached</cite>: migration client</p></li>
<li><p><cite>finagle-ostrich4</cite>: improve perf of Counter and Stat</p></li>
<li><p><cite>finagle-swift</cite>: experimental swift-based thrift server and client An experimental annotation based proxy and dispatcher for thrift, using Facebook???s swift for serialization.</p></li>
<li><p><cite>finagle-thrift</cite>: breaking out finagle, higher-kinded-type interface</p></li>
<li><p><cite>finagle-thrift</cite>: fix finagle-thrift rich to work with scrooge 3.6.0</p></li>
<li><p><cite>finagle-thrift</cite>: move scrooge-runtime to scrooge</p></li>
<li><p><cite>finagle-thrift</cite>: remove use of deprecated generated ostrich ThriftServer</p></li>
<li><p><cite>finagle-zipkin</cite>: Add newlines to scribe message</p></li>
<li><p><cite>finagle-zipkin</cite>: Use better metric names for error stats</p></li>
<li><p><cite>finagle-zipkin</cite>: optimize scribe logging to not need slf4j</p></li>
</ul>
</section>
<section id="id419">
<h2>6.5.2<a class="headerlink" href="#id419" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>finagle-ostrich4: set stats export URI to stats.json</p></li>
<li><p>finagle-core: Introduce StabilizingGroup which cautiously removes items from a Group</p></li>
<li><p>finagle-core: Add group method to ClientBuilder</p></li>
<li><p>finagle-core: Add service/client name to ServiceTimeoutException</p></li>
<li><p>finagle-mux: Don’t allocate headers via direct buffers</p></li>
<li><p>finagle-http: Implement missing modifiers in Http case class</p></li>
<li><p>finagle-memcache: added support for twemcache commands</p></li>
</ul>
</section>
<section id="id420">
<h2>6.5.1<a class="headerlink" href="#id420" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-http</cite>: Move routing by path and method function to RoutingService</p></li>
<li><p><cite>finagle-redis</cite>: Switching from Strings to ChannelBuffers for Scored Zrange commands</p></li>
<li><p><cite>finagle-stats</cite>: Upgrade metrics to 0.0.9</p></li>
<li><p><cite>finagle-stream</cite>: Revert “Stream interface (i.e. chunked) for HTTP message bodies”</p></li>
<li><p><cite>finagle</cite>: Fix documentation about Java &amp; Future</p></li>
<li><p><cite>finagle</cite>: Refresh OWNERS/GROUPS in all subdirectories</p></li>
<li><p><cite>finagle</cite>: Upgrade Netty version to 3.6.6.Final</p></li>
<li><p><cite>finagle</cite>: Upgrade ostrich version to 9.1.2</p></li>
<li><p><cite>finagle</cite>: Upgrade util version to 6.3.7</p></li>
<li><p><cite>finagle-redis</cite>: Implement new SET syntax introduced in redis 2.6.12</p></li>
<li><p><cite>finagle-core</cite>: Open connection threshold et al</p></li>
</ul>
</section>
<section id="id421">
<h2>6.5.0<a class="headerlink" href="#id421" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: fix a bug in Trace.unwind in ruby</p></li>
<li><p><cite>finagle-core</cite>: speed up tracing when a trace is unsampled.</p></li>
<li><p><cite>finagle-redis</cite>: implement PEXPIRE/PEXPIREAT/PTTL</p></li>
<li><p><cite>finagle-redis</cite>: Make the multiple argument version of zAdd a separate method.</p></li>
<li><p><cite>finagle-serverset</cite>: create a ZkAnnouncer</p></li>
<li><p><cite>finagle-thriftmux</cite>: make thriftmux server back compatible with thrift framed codec</p></li>
<li><p><cite>finagle-zipkin</cite>: Performance improvement for finagle-zipkin</p></li>
<li><p><cite>finagle</cite>: Gizzard: Some followup deps alignment to fix deployment classpath issues</p></li>
<li><p><cite>finagle-memcached</cite>: KetamaClient based on finagle-6 API</p></li>
<li><p><cite>finagle-exception</cite>: unique namespace for scribe</p></li>
<li><p><cite>finagle-thrift</cite>: Add scrooge3 support</p></li>
<li><p><cite>finagle</cite>: bump sbt util/finagle version</p></li>
<li><p><cite>finagle</cite>: Updating owner list</p></li>
<li><p><cite>finagle</cite>: Upgrade util to 6.3.6 and scrooge-runtime to 3.1.2</p></li>
</ul>
</section>
<section id="id422">
<h2>6.4.1<a class="headerlink" href="#id422" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-http</cite>: CookieMap instead of CookieSet</p></li>
<li><p><cite>finagle-memcached</cite>: remove items stats test since twemcache does not carry those</p></li>
<li><p><cite>finagle-http</cite>: don’t choke on HEAD requests</p></li>
<li><p><cite>finagle-core</cite>: ReusingPool: fix race between setting Future.never and initiating connect</p></li>
<li><p><cite>finagle-thriftmux</cite>: also release services</p></li>
<li><p><cite>finagle-http</cite>: Use the correct dispatcher for RichHttp and new API</p></li>
<li><p><cite>finagle-exception</cite>: a loadable exception reporter</p></li>
<li><p><cite>finagle-core</cite>: make global flags consistently camelCase</p></li>
<li><p><cite>finagel-http</cite>: enable tracing by default for Http</p></li>
<li><p><cite>finagle-http</cite>: Call super method only if response is not chunked</p></li>
<li><p><cite>finagle-core</cite>: Tracing changes to annotate both client and server ip addresses</p></li>
<li><p><cite>finagle-http</cite>: Stream interface (i.e. chunked) for HTTP message bodies</p></li>
<li><p><cite>finagle-core</cite>: get a resolver instance contained in the main Resolver</p></li>
<li><p><cite>finagle-mux</cite>: fix TagMap.iterator</p></li>
<li><p><cite>finagle-mdns</cite>: Adding project to sbt</p></li>
<li><p><cite>inagle</cite>: Fix doc</p></li>
<li><p><cite>finagle-mysql</cite>: refactor endec into proper fsm</p></li>
<li><p><cite>finagle</cite>: Update sbt project for (util, ostrich, finagle)</p></li>
</ul>
</section>
<section id="id423">
<h2>6.4.0<a class="headerlink" href="#id423" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Add unmanaged cache pool cluster</p></li>
<li><p><cite>finagle-core</cite>: Always enable TracingFilter even when no tracers are used.</p></li>
<li><p><cite>finagle-core</cite>: cache the cancelled connections in WatermarkPool instead of CachingPool</p></li>
<li><p><cite>finagle-core</cite>: Fix behavior of proxy forwarding in StatsReceiver</p></li>
<li><p><cite>finagle-core</cite>: Fix usage of RollupStatsReceiver in StatsFactoryWrapper.</p></li>
<li><p><cite>finagle-core</cite>: Generalize LoggingFilter</p></li>
<li><p><cite>finagle-core</cite>: HeapBalancer: fix handling of unavailable nodes</p></li>
<li><p><cite>finagle-core</cite>: Properly synchronize concurrent access to ProxyService state.</p></li>
<li><p><cite>finagle-core</cite>: Refactor Heapbalancer, remove usage of per host statsReceiver.</p></li>
<li><p><cite>finagle-core</cite>: share worker pools between server and client</p></li>
<li><p><cite>finagle-exception</cite>: Fix sourceHost supplied to chickadee exception reporter</p></li>
<li><p><cite>finagle-http</cite>: Add HttpConnectHandler and HttpClientCodec in the correct order when setting up an HTTP proxy client.</p></li>
<li><p><cite>finagle-http</cite>: add Response(status)</p></li>
<li><p><cite>finagle-http</cite>: EncodeBytes/decodeBytes for Request</p></li>
<li><p><cite>finagle-http</cite>: Refactor HeaderMap/ParamMap</p></li>
<li><p><cite>finagle-memcache</cite>: change to use consistent way to provide failure accrual params</p></li>
<li><p><cite>finagle-memcached</cite>: Propagating error message from server to client</p></li>
<li><p><cite>finagle-memcached</cite>: support for configuring numReps in KetamaClientBuilder</p></li>
<li><p><cite>finagle-mux</cite>: convert tests to use ScalaTest</p></li>
<li><p><cite>finagle-mysql</cite>: Ability to deal with non-ascii utf-8 characters</p></li>
<li><p><cite>finagle-mysql</cite>: Add ability to pass StatsReceiver to builder</p></li>
<li><p><cite>finagle-mysql</cite>: adds support for latin1_bin, paves the way for more charsets.</p></li>
<li><p><cite>finagle-mysql</cite>: Encode all the given the error information in the ServerError</p></li>
<li><p><cite>finagle-mysql</cite>: Fix improper use of ServiceFactory in Client</p></li>
<li><p><cite>finagle-redis</cite>: Fix byte encoding problem with Z(Rev)Rank</p></li>
<li><p><cite>finagle-redis</cite>: fixing Nil values in MBulkReplies</p></li>
<li><p><cite>Finagle-zipkin</cite>: decoupled sampling logic from ZipkinTracer to make a reusable SamplingTracer</p></li>
<li><p><cite>finagle-zipkin</cite>: Improve zipkin trace sampling</p></li>
<li><p><cite>finagle-zipkin</cite>: make ZipkinTracer loadable</p></li>
<li><p><cite>finagle</cite>: Document metrics</p></li>
<li><p><cite>finagle</cite>: Force service loader to return a concrete collection</p></li>
<li><p><cite>finagle</cite>: Refactor Future#get to Await.result</p></li>
<li><p><cite>finagle</cite>: Upgrade jackson to 1.9.11</p></li>
<li><p><cite>finagle</cite>: Upgrade ostrich to 9.1.1</p></li>
<li><p><cite>finagle</cite>: Upgrade util to 6.3.4</p></li>
</ul>
</section>
<section id="id424">
<h2>6.3.0<a class="headerlink" href="#id424" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle</cite>: Upgrade util to 6.3.0</p></li>
<li><p><cite>finagle-thrift</cite>: SocketAddress when serving an iface</p></li>
<li><p><cite>finagle-core</cite>: Specify DefaultTimer when creating a ChannelFactory</p></li>
<li><p><cite>finagle-core</cite>: DefaultClient/Server: Do not add TracingFilter if NullTracer is used</p></li>
</ul>
</section>
<section id="id425">
<h2>6.1.4<a class="headerlink" href="#id425" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-zipkin</cite>: tracing improvements</p></li>
<li><p><cite>finagle</cite>: Upgrade util to 6.2.5</p></li>
</ul>
</section>
<section id="id426">
<h2>6.1.3<a class="headerlink" href="#id426" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Add BroadcastCounter and BroadcastStat, refactor Broadcast and Rollup Receiver.</p></li>
<li><p><cite>finagle</cite>: update sbt, add finagle-exp</p></li>
<li><p><cite>finagle-doc</cite>: Add a FAQ, add an entry about CancelledRequestExceptions</p></li>
<li><p><cite>finagle-core</cite>: Add client support for proxies that support HTTP CONNECT, such as squid.</p></li>
<li><p><cite>finagle-doc</cite>: A few wording fixes in Sphinx doc templates.</p></li>
<li><p><cite>finagle-core</cite>: StatsFilter: Check for WriteException-wrapped backup-request losers</p></li>
<li><p><cite>finagle-mysql</cite>: bug fixes</p></li>
<li><p><cite>finagle</cite>: Update sbt project definition</p></li>
<li><p><cite>finagle-core</cite>: Introduce DefaultTracer that load available Tracers via LoadService + Fix equality with NullStatsReceiver</p></li>
<li><p><cite>finagle-core</cite>: CachingPool: Do not schedule timer tasks if ttl is Duration.Top</p></li>
</ul>
</section>
<section id="id427">
<h2>6.1.2<a class="headerlink" href="#id427" title="Permalink to this headline">¶</a></h2>
<p>Released 2013/03/21</p>
<ul class="simple">
<li><p><cite>finagle</cite>: Fix flakey tests</p></li>
<li><p><cite>finagle</cite>: fix sbt build</p></li>
<li><p><cite>finagle</cite>: Upgrade util to 6.2.4</p></li>
<li><p><cite>finagle-core</cite>: Fix reporting bug for pending reqs</p></li>
<li><p><cite>finagle-core</cite>: Move Disposable/Managed to util</p></li>
<li><p><cite>finagle-core</cite>: Use Future.Nil</p></li>
<li><p><cite>finagle-doc</cite>: Improve, add Matt Ho’s talk.</p></li>
<li><p><cite>finagle-exp</cite>: Add BackupRequestFilter, new backup request filter using response latency quantiles</p></li>
<li><p><cite>finagle-http</cite>: Avoid URISyntaxException</p></li>
<li><p><cite>finagle-memcached</cite>: Add Replication Cache Client</p></li>
<li><p><cite>finagle-mysql</cite>: Make prepareAndExecute and prepareAndSelect useful again.</p></li>
<li><p><cite>finagle-mysql</cite>: Make sure we are properly managing prepared statement</p></li>
<li><p><cite>finagle-mysql</cite>: Move interfaces outside of protocol package</p></li>
<li><p><cite>finagle-redis</cite>: Moved redis server classes from private to public</p></li>
<li><p><cite>finagle-thrift</cite>: fix 2.10 build</p></li>
</ul>
</section>
<section id="id428">
<h2>6.1.1<a class="headerlink" href="#id428" title="Permalink to this headline">¶</a></h2>
<p>Released 2013/03/12</p>
<ul class="simple">
<li><p><cite>doc</cite>: Finagle user guide!</p></li>
<li><p><cite>finagle</cite>: Remove finagle’s dependence on jerkson.</p></li>
<li><p><cite>finagle</cite>: Upgrade Netty to 3.5.12</p></li>
<li><p><cite>finagle</cite>: Upgrade scrooge-runtime to 2.4.0</p></li>
<li><p><cite>finagle</cite>: Upgrade util to 6.2.2</p></li>
<li><p><cite>finagle-core</cite>: com.twitter.finagle.Group: introduce names, use them.</p></li>
<li><p><cite>finagle-core</cite>: deprivatize, document Client, Server.</p></li>
<li><p><cite>finagle-core</cite>: fix multiple stats bugs.</p></li>
<li><p><cite>finagle-core</cite>: Log Finagle’s version number on startup.</p></li>
<li><p><cite>finagle-core</cite>: RetryingFilter, don’t retry on CancelledRequestException.</p></li>
<li><p><cite>finagle-http</cite>: New Request object queryString utility functions.</p></li>
<li><p><cite>finagle-http</cite>: New Request/Response encode/decode functions.</p></li>
<li><p><cite>finagle-memcached</cite>: Actively reestablish zk connection whenever disconnected or expired.</p></li>
<li><p><cite>finagle-memcached</cite>: Cache pool cluster not updated since 2nd serverset change.</p></li>
<li><p><cite>finagle-memcached</cite>: Don’t use deprecated FuturePool.defaultPool.</p></li>
<li><p><cite>finagle-mysql</cite>: Add project in the list of deployed jar.</p></li>
<li><p><cite>finagle-mysql</cite>: Fix race condition in the authentication process.</p></li>
<li><p><cite>finagle-mysql</cite>: Move it to experimental package.</p></li>
<li><p><cite>finagle-ostrich4</cite>: Add OstrichExporter to enable Ostrich stats in the new App stack.</p></li>
<li><p><cite>finagle-redis</cite>: Add support for INFO command.</p></li>
<li><p><cite>finagle-resolver</cite>: additional visibility for Announcers and Resolvers.</p></li>
<li><p><cite>finagle-zipkin</cite>: new factory methods.</p></li>
</ul>
</section>
<section id="id429">
<h2>6.1.0<a class="headerlink" href="#id429" title="Permalink to this headline">¶</a></h2>
<p>Released 2013/01/30</p>
<ul class="simple">
<li><p><cite>finagle</cite>: update util and ostrich dependencies</p></li>
<li><p><cite>finagle</cite>: libraries: preliminary 2.10 port/build</p></li>
<li><p><cite>finagle</cite>: Tracer use new daemon() flag; get rid of factory. Simplify.</p></li>
<li><p><cite>finagle</cite>: refactor clients and servers to be simpler, more logical.</p></li>
<li><p><cite>finagle-core</cite>: Provide a reportHostStatsTo API on ClientBuilder that per-host stats will be reported to.</p></li>
<li><p><cite>finagle-core</cite>: Use Groups in place of Clusters</p></li>
<li><p><cite>finagle-core</cite>: Create a NonShrinkingCluster</p></li>
<li><p><cite>finagle-redis</cite>: made zRange… commands work more like the actual redis commands</p></li>
<li><p><cite>finagle-stats</cite>: new project that provides a StatsReceiver based on Twitter’s Metrics library.</p></li>
<li><p><cite>finagle-http</cite>: add new-style client and server, including a primitive URL fetcher</p></li>
</ul>
</section>
<section id="id430">
<h2>6.0.5<a class="headerlink" href="#id430" title="Permalink to this headline">¶</a></h2>
<p>Released 2013/01/22</p>
<ul class="simple">
<li><p><cite>finagle-core</cite>: basic SOCKS support for finagle clients, intended for use with ssh -D.</p></li>
</ul>
</section>
<section id="id431">
<h2>6.0.4<a class="headerlink" href="#id431" title="Permalink to this headline">¶</a></h2>
<p>Released 2013/01/22</p>
<ul class="simple">
<li><p><cite>finagle-core</cite>: CachingPool owns connections and caches them even if upstream cancels</p></li>
<li><p><cite>finagle-core</cite>: Eliminate varargs overhead in StatsReceiver.time and timeFuture</p></li>
<li><p><cite>finagle-core</cite>: LoadBalancerTest: allow the tests to be run with Google Caliper</p></li>
<li><p><cite>finagle-core</cite>: make snap on mapped cluster thread-safe</p></li>
<li><p><cite>finagle-memcached</cite>: explicitly pass in initial cache nodes when using a a static cluster</p></li>
<li><p><cite>finagle-native</cite>: fix up grab_and_path_tomcat_native</p></li>
<li><p><cite>finagle-redis</cite>: finagle redis btree sorted set commands</p></li>
<li><p><cite>finagle-redis</cite>: Implemented redis HMSET</p></li>
<li><p><cite>finagle-redis</cite>: expireAt command</p></li>
</ul>
</section>
<section id="id432">
<h2>6.0.3<a class="headerlink" href="#id432" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/12/18</p>
<ul class="simple">
<li><p><cite>finagle-mux</cite>: new session protocol</p></li>
<li><p><cite>documentation</cite>: document connection management and associated configuration options</p></li>
<li><p><cite>finagle-core</cite>: expose newChannelTransport in Codec to allow multiplexing in clients</p></li>
<li><p><cite>finagle-http RequestProxy</cite>: proxy response</p></li>
</ul>
</section>
<section id="id433">
<h2>6.0.2<a class="headerlink" href="#id433" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/12/11</p>
<ul class="simple">
<li><p><cite>TimerSpec, RefcountedSpec</cite>: make deterministic</p></li>
<li><p><cite>finagle-core</cite>: JSSE SSL support for intermediate certificates</p></li>
<li><p><cite>finagle-core</cite>: push SSLEngine all the way up to the ServerBuilder</p></li>
<li><p><cite>finagle-core</cite>: preclude default SourceMonitor in clients</p></li>
<li><p><cite>finagle-core</cite>: ReusingPool for pipelined, multiplexed clients</p></li>
<li><p><cite>finagle-core</cite>: remove wasteful RichLong allocations in hot path</p></li>
<li><p><cite>finagle-core</cite>: move acquire/release of services outside of WatermarkPool’s synchronization</p></li>
<li><p><cite>finagle-core</cite>: remove unintended reflection-by-refinement-type</p></li>
<li><p><cite>finagle-thrift</cite>: actually support multiple protocols</p></li>
<li><p><cite>finagle-ostrich4</cite>: configurable delimiter</p></li>
<li><p><cite>finagle-redis</cite>: parse case-insensitive commands</p></li>
</ul>
</section>
<section id="id434">
<h2>6.0.1<a class="headerlink" href="#id434" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/11/26</p>
<ul class="simple">
<li><p>Use java.util.ArrayDeque in place of mutable.Queue due to <a class="reference external" href="https://issues.scala-lang.org/browse/SI-6690">https://issues.scala-lang.org/browse/SI-6690</a></p></li>
</ul>
</section>
<section id="id435">
<h2>6.0.0<a class="headerlink" href="#id435" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/11/26</p>
<ul class="simple">
<li><p>util 6.0.0 dependency</p></li>
<li><p><cite>finagle-core</cite>: new client/server APIs; not yet exposed to users</p></li>
</ul>
</section>
<section id="id436">
<h2>5.3.23<a class="headerlink" href="#id436" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/11/21</p>
<ul class="simple">
<li><p><cite>finagle-spdy</cite>: new codec</p></li>
<li><p><cite>finagle-core</cite>: ServiceTimeoutException is now a WriteException (so they can be retried)</p></li>
<li><p><cite>finagle-core</cite>: close channels owned by ChannelTransport before failing queues</p></li>
<li><p><cite>finagle-core</cite>: share ChannelStatsHandler in clients and servers to avoid excessive stats-related weakrefs</p></li>
<li><p><cite>finagle-core</cite>: don’t leak Spooled updates in the HeapBalancer</p></li>
</ul>
</section>
<section id="id437">
<h2>5.3.22<a class="headerlink" href="#id437" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/11/08</p>
<ul class="simple">
<li><p><cite>finagle-redis</cite>: String commands</p></li>
<li><p><cite>finagle-redis</cite>: collection.Set =&gt; collection.immutable.Set per #116</p></li>
<li><p><cite>finagle-thrift</cite>: SeqIdFilter: Don’t modify thrift requests.</p></li>
<li><p><cite>BackupRequestFilter</cite>: experimental service filter to perform backup requests</p></li>
</ul>
</section>
<section id="id438">
<h2>5.3.20<a class="headerlink" href="#id438" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/10/26</p>
<ul class="simple">
<li><p><cite>finagle-redis</cite>: fix zrevrangebyscore (<a class="reference external" href="https://github.com/twitter/finagle/issues/114">https://github.com/twitter/finagle/issues/114</a>)</p></li>
<li><p><cite>finagle-memcached</cite>: fix space leak when using clustering</p></li>
<li><p><cite>finagle-core</cite>: special case 1-hosted (static) clients to bypass loadbalancer</p></li>
<li><p><cite>finagle-core</cite>: Introduce an experimental buffer-based pool</p></li>
</ul>
</section>
<section id="id439">
<h2>5.3.19<a class="headerlink" href="#id439" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/10/16</p>
<ul class="simple">
<li><p>Upgrade ostrich to 8.2.9</p></li>
<li><p>Upgrade util to 5.3.13</p></li>
<li><p>Upgrading slf4j to 1.6.1</p></li>
<li><p><cite>finagle</cite>: Rm usage of deprecated Predef.error.</p></li>
<li><p><cite>finagle-core</cite>: Changed stats name in ChannelStatsHandler from exception msg to getClass.getName</p></li>
<li><p><cite>finagle-core</cite>: Add counters to track disconnections due to Idle activity (both read/write)</p></li>
<li><p><cite>finagle-core</cite>: Add “adds”/”removes” counters in HeapBalancer to track modifications</p></li>
<li><p><cite>finagle-core</cite>: Added name to HeapBalancer init (via exception) if HB size is 0</p></li>
<li><p><cite>finagle-core</cite>: Don’t log dropped events: they are actually quite numerous.</p></li>
<li><p><cite>finagle-kestrel</cite>: Disable failFast for kestrel.</p></li>
<li><p><cite>finagle-memcached</cite>: Cluster support within finagle-memcached (phase 2)</p></li>
<li><p><cite>finagle-redis</cite>: added new commands</p></li>
</ul>
</section>
<section id="id440">
<h2>5.3.18<a class="headerlink" href="#id440" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/09/27</p>
<ul class="simple">
<li><p><cite>Doc</cite>: update README with working thrift Java example</p></li>
<li><p><cite>Doc</cite>: fix compile errors in examples</p></li>
<li><p><cite>finagle-http</cite>: fix typo in RequestBuilder API</p></li>
<li><p><cite>finagle-stress</cite>: FrontEndServerStress refactor; now generates runnable binary</p></li>
<li><p><cite>finagle-core</cite>: add optional <cite>shouldRetry</cite> argument to RetryPolicy.tries</p></li>
<li><p><cite>finagle-core</cite>: pools propagate underlying availability correctly</p></li>
<li><p><cite>finagle-core</cite>: move fail-fast before the pool. This prevents it from masking errors from the failure accrual mechanism, and is arguably the “correct” placement</p></li>
<li><p><cite>finagle-core</cite>: fix argument type in RetryingFilter.apply</p></li>
<li><p><cite>finagle-core</cite>: failFast by default; disable for Kestrel</p></li>
<li><p><cite>finagle-memcached</cite>: cache-pool specific Cluster implementation</p></li>
<li><p><cite>finagle-memcached</cite>: add stat to cache-pool cluster</p></li>
<li><p><cite>finagle-redis</cite>: add scan, hscan commands</p></li>
<li><p><cite>finagle-redis</cite>: add list commands</p></li>
</ul>
</section>
<section id="id441">
<h2>5.3.9<a class="headerlink" href="#id441" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/09/07</p>
<ul class="simple">
<li><p><cite>finagle</cite>: Update/fix README</p></li>
<li><p><cite>finagle</cite>: Upgrade util to 5.3.10</p></li>
<li><p><cite>finagle</cite>: Update guava to v13</p></li>
<li><p><cite>finagle-redis</cite>: API v2 + update example</p></li>
<li><p><cite>finagle-thrift</cite>: validate connections based on TApplicationException</p></li>
<li><p><cite>finagle-core</cite>: SSL: fix connection failure propagation in futures</p></li>
</ul>
</section>
<section id="id442">
<h2>5.3.8<a class="headerlink" href="#id442" title="Permalink to this headline">¶</a></h2>
<p>2012/08/24</p>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Upgrade to Netty 3.5.5</p></li>
</ul>
</section>
<section id="id443">
<h2>5.3.7<a class="headerlink" href="#id443" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/08/24</p>
<ul class="simple">
<li><p><cite>Doc</cite>: Fix mistake in finagLe README that claimed Future objects have a getContentAsync method</p></li>
<li><p><cite>Doc</cite>: Fix typos in README</p></li>
<li><p><cite>finagle-thrift</cite>: ThriftChannelBufferDecoder: fix for composite buffers</p></li>
<li><p><cite>finagle-mysql</cite>: MySQL codec from Ruben Oanta.</p></li>
<li><p><cite>finagle-core</cite>: add isSuccess to FailureAccrualFactory</p></li>
<li><p><cite>finagle-http</cite>: Fix file extension bug in finagle-http</p></li>
</ul>
</section>
<section id="id444">
<h2>5.3.6<a class="headerlink" href="#id444" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/06/17</p>
<ul class="simple">
<li><p><cite>Doc</cite>: Typos</p></li>
<li><p><cite>finagle-core</cite>: fix canceling recurring timers</p></li>
<li><p><cite>finagle</cite>: kill finagle-memcached-hadoop</p></li>
<li><p><cite>finagle-memcached</cite>: in-process memcache server now supports expiry</p></li>
<li><p><cite>finagle-memcached</cite>: Adding key length validation and refactor validation logic.</p></li>
</ul>
</section>
<section id="id445">
<h2>5.3.5<a class="headerlink" href="#id445" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/08/10</p>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Fixed stats visibility</p></li>
<li><p><cite>finagle-serversets</cite>: allow specification of an additional endpoint name in ZookeeperServerSetCluster</p></li>
<li><p><cite>finagle-serversets</cite>: ZookeeperServerSetCluster.join now return an EndpointStatus + Named/Daemonized init thread</p></li>
<li><p><cite>finagle-core</cite>: Changed Cache’s internal implementation from queue to deque (to allow LIFO behavior)</p></li>
<li><p><cite>finagle-core</cite>: cluster initialization honors global timeout in ClientBuilder.</p></li>
<li><p><cite>finagle-stress</cite>: finagle: kill obsolete benchmark</p></li>
</ul>
</section>
<section id="id446">
<h2>5.3.4<a class="headerlink" href="#id446" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/08/02</p>
<ul class="simple">
<li><p><cite>finagle</cite>: patch public release of OSS libraries; catch up sbt</p></li>
<li><p><cite>finagle-core</cite>: netty 3.5.3.Final</p></li>
<li><p><cite>finagle-core</cite>: Timer: address review comments, fix tiny race</p></li>
</ul>
</section>
<section id="id447">
<h2>5.3.3<a class="headerlink" href="#id447" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/07/31</p>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Timer: dispose timeouts on cancellation</p></li>
</ul>
</section>
<section id="id448">
<h2>5.3.2<a class="headerlink" href="#id448" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/07/31</p>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Fix critical bug in Timer by refactoring the Timer model</p></li>
<li><p><cite>finagle</cite>: Add OWNERS file to finagle-memcached, finagle-redis</p></li>
<li><p><cite>finagle-redis</cite>: add keys and hkeys</p></li>
<li><p><cite>finagle-zipkin</cite>: Add a debug flag, add an i64 bit field to the thrift request header struct and as a http header</p></li>
<li><p><cite>finagle-core</cite>: SourceTrackingMonitor to report whether it’s in client or server</p></li>
<li><p><cite>finagle-zipkin</cite>: Add duration to the the JVM gc annotation.</p></li>
</ul>
</section>
<section id="id449">
<h2>5.3.1<a class="headerlink" href="#id449" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/07/20</p>
<ul class="simple">
<li><p><cite>finagle-serversets</cite>: Use authenticated zookeeper client suggested for new SD cluster migration</p></li>
<li><p><cite>finagle-thrift</cite>: seqid filter: improved tests</p></li>
<li><p><cite>finagle-zipkin</cite>: Add duration to annotations for timing operations</p></li>
<li><p><cite>finagle-serversets</cite>: bump up server-set version to 1.0.10 (latest) in finagle-serversets</p></li>
</ul>
</section>
<section id="id450">
<h2>5.3.0<a class="headerlink" href="#id450" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/06/25</p>
<ul class="simple">
<li><p><cite>finagle-core</cite>: ClientBuilder and ServerBuilder’s MonitorFilter to report exception sources</p></li>
<li><p><cite>finagle-test</cite>: Add TaskTrackingTimer benchmark</p></li>
<li><p><cite>finagle-thrift</cite>: SeqIdFilter: helpful exceptions</p></li>
<li><p><cite>Dispatcher</cite>: all write exceptions are wrapped with WriteException</p></li>
</ul>
</section>
<section id="id451">
<h2>5.1.0<a class="headerlink" href="#id451" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/06/14</p>
<ul class="simple">
<li><p><cite>finagle</cite>: Upgrade util to 5.2.0, ostrich to 8.1.0</p></li>
<li><p><cite>finagle-redis</cite>: extend codec</p></li>
<li><p><cite>finagle-memcache</cite>: first phase of serverset support</p></li>
<li><p><cite>finagle-b3</cite>: we are using zipkin now</p></li>
<li><p><cite>finagle-kestrel</cite>: Kill com.twitter.concurrent.Channel</p></li>
<li><p><cite>finagle-core</cite>: JvmFiler, trace jvm events</p></li>
</ul>
</section>
<section id="id452">
<h2>5.0.2<a class="headerlink" href="#id452" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/06/01</p>
<ul class="simple">
<li><p><cite>finagle-core</cite>: Refactor the new way of managing resources</p></li>
<li><p><cite>finagle-core</cite>: Add capability to drain dispatcher on expire</p></li>
<li><p><cite>finagle-core</cite>: ZookeeperServersetCluster notify client when underlying Cluster is ready</p></li>
<li><p><cite>finagle-exception</cite>: Upgrade jerkson to 0.5.0 and streamyj to 0.4.1</p></li>
</ul>
</section>
<section id="id453">
<h2>5.0.0<a class="headerlink" href="#id453" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/05/25</p>
<ul class="simple">
<li><p>Upgrade to scala 2.9.2</p></li>
<li><p><cite>finagle-core</cite>: FailFast, do not admit requests when marked failed</p></li>
<li><p><cite>finagle-redis</cite>: now return tuples and doubles</p></li>
<li><p><cite>finagle-memcached</cite>: record client recv annotation after hit/miss</p></li>
<li><p><cite>finagle-core</cite>: expand exception chain in StatsFilter</p></li>
</ul>
</section>
<section id="id454">
<h2>4.0.0<a class="headerlink" href="#id454" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/05/08</p>
<ul class="simple">
<li><p><cite>http</cite>: add AddResponseHeadersFilter, CorsFilter</p></li>
<li><p><cite>finagle-redis</cite>: Add ZCard, ZRem, ZRevRange, ZRevRangeByScore commands</p></li>
<li><p><cite>finagle-memcached</cite>: Added b3 annotations for key hits/misses</p></li>
<li><p><cite>finagle-memcached</cite>: getResult/getsResult for java</p></li>
<li><p><cite>finagle-http</cite>: fix client codec</p></li>
<li><p><cite>HeapBalancer</cite>: close services that are removed from cluster</p></li>
<li><p><cite>finagle-redis</cite>: add tracing and stats support</p></li>
<li><p><cite>finagle-http</cite>: Add the client address for http traces. Also record uri after service name has been set</p></li>
<li><p><cite>finagle-memcached</cite>: more efficient implementation of GetResult.merged</p></li>
<li><p><cite>finagle-redis</cite>: return pairs for hgetall, zrangebyscores, zrevrangebyscores cmds</p></li>
<li><p><cite>finagle-core</cite>: introduce Transports and Dispatchers</p></li>
<li><p><cite>tracing</cite>: annotate client connection when tracing</p></li>
<li><p>update to netty 3.4.1.Final</p></li>
<li><p>prevent tenuring of response objects for responses from previously idle connections</p></li>
<li><p><cite>finagle-redis</cite>: add quit command</p></li>
<li><p><cite>finagle-http</cite>: add service multiplexer</p></li>
<li><p>friendlier java interface for retries</p></li>
</ul>
</section>
<section id="id455">
<h2>3.0.0<a class="headerlink" href="#id455" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/03/14</p>
<ul class="simple">
<li><p><cite>ServiceToChannelHandler</cite>: keep track of shutdowns with pending replies, don’t monitor errors that occur after cancellation.</p></li>
<li><p>Add two received_bytesm sent_bytes to per-channel stats.</p></li>
<li><p><cite>http</cite>: Add wwwAuthenticate(=) and isXmlHttpRequest</p></li>
<li><p><cite>http</cite>: CancelledRequestExceptions become 499s</p></li>
<li><p><cite>clients</cite>: experimental Fail-Fast mode (ClientBuilder.expFailFast(true))</p></li>
<li><p><cite>b3</cite>: Only log that a span was unfinished if we actually found one</p></li>
<li><p><cite>thrift</cite>: better support for one-way calls</p></li>
<li><p><cite>server</cite>: option for cancellation on hangup (default=true)</p></li>
<li><p><cite>codecs</cite>: improved support for multiplexed protocols</p></li>
<li><p>upgrade to netty 3.4.0.alpha1 which fixes connect timer resolution issues. Trustin says this should be as stable as 3.3.1.Final</p></li>
<li><p><cite>serversets</cite>: allow for additional endpoints</p></li>
<li><p><cite>tests</cite>: use true ephemeral ports instead of RandomSocket</p></li>
<li><p><cite>memcache stress</cite>: use new command line flag library from commons</p></li>
<li><p><cite>thrift</cite>: concatenate arrays with System.arraycopy</p></li>
<li><p><cite>memached</cite>: fix bug wherein we made requests with empty keys on retries</p></li>
</ul>
</section>
<section id="id456">
<h2>2.0.1<a class="headerlink" href="#id456" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/03/01</p>
<ul class="simple">
<li><p><cite>commons-stats</cite>: memoize counters</p></li>
<li><p><cite>cluster</cite>: don’t reuse adds; keep many values per key</p></li>
<li><p><cite>clientbuilder</cite>: buffer handlers to avoid deadlock</p></li>
</ul>
</section>
<section id="id457">
<h2>2.0.0<a class="headerlink" href="#id457" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/02/27</p>
<ul class="simple">
<li><p>unify client and server factories</p></li>
<li><p><cite>memcache stress test</cite>: one connection per process</p></li>
<li><p><cite>b3</cite>: make tests deterministic</p></li>
<li><p>upgrade to newest util (and to Guava r11)</p></li>
</ul>
</section>
<section id="id458">
<h2>1.11.1<a class="headerlink" href="#id458" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/02/15</p>
<ul class="simple">
<li><p><cite>HeapBalancer</cite>: safely remove services from cluster when they have requests in flight</p></li>
<li><p><cite>http</cite>: speed up logging</p></li>
<li><p><cite>core</cite>: keep track of handler walltimes</p></li>
</ul>
</section>
<section id="id459">
<h2>1.11.0<a class="headerlink" href="#id459" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/02/13</p>
<ul class="simple">
<li><p><cite>finagle-redis</cite>: publish.</p></li>
<li><p><cite>http</cite>: Message.mediaType=: no longer sets charset to utf-8</p></li>
<li><p><cite>http</cite>: Message.setContentType: defaults charset to utf-8</p></li>
<li><p><cite>http</cite>: added Message.charset, Message.charset=</p></li>
<li><p>Refactor resource management inside of the builders, making lifetimes explicit</p></li>
<li><p>Generic cluster API, support in the HeapBalancer for dynamic hosts list; remove other load balancers</p></li>
<li><p><cite>redis</cite>: memcache.Client-style interface</p></li>
<li><p><cite>netty</cite>: update to 3.3.1.Final, and add NPN TLS extension support</p></li>
<li><p><cite>b3</cite>: flush span if timeout occurs</p></li>
<li><p><cite>b3</cite>: java friendly tracer API</p></li>
<li><p><cite>stress/example</cite>: “topo”, a minimal appserver-like topology for testing</p></li>
<li><p><cite>memcache</cite>: tunable example for benchmarking, testing</p></li>
<li><p><cite>ServerBuilder</cite>: major refactor &amp; simplification</p></li>
<li><p><cite>SummarizingStatsReceiver</cite>: fix bug where sort didn’t operate over a stable collection</p></li>
</ul>
</section>
<section id="id460">
<h2>1.10.0<a class="headerlink" href="#id460" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/01/24</p>
<ul class="simple">
<li><p><cite>http</cite>: Message.withX methods now have parameterized return types</p></li>
<li><p><cite>memcached</cite>: (Ketama) host ejection</p></li>
<li><p>Noisier, more robust monitoring.</p></li>
<li><p><cite>zk cluster</cite>: avoid potential infinite loop</p></li>
<li><p><cite>http streaming</cite>: better detection, handling of dead channels</p></li>
<li><p><cite>http</cite>: always encode output as UTF-8</p></li>
<li><p><cite>stream</cite>: use offer/broker for duplex stream</p></li>
<li><p><cite>redis</cite>: imported finagle redis client from Tumblr. not yet published.</p></li>
</ul>
</section>
<section id="id461">
<h2>1.9.12<a class="headerlink" href="#id461" title="Permalink to this headline">¶</a></h2>
<p>Released 2012/01/05</p>
<ul class="simple">
<li><p><cite>SSLEngine</cite>: do not reuse between connections</p></li>
<li><p><cite>ServerBuilder.Server</cite>: localAddress to get ephemeral port values</p></li>
<li><p>More detailed client stats</p></li>
<li><p><cite>kestrel</cite>: parse parseStatsLines</p></li>
<li><p><cite>FailFastFactory</cite>: new fast-fail strategy with maxOutstandingConnections</p></li>
<li><p><cite>exceptions</cite>: add peer information to connection failures, add service name to all exceptions</p></li>
<li><p><cite>fixes</cite>: space leak in stats, ReliableDuplexFilter lazy load ordering</p></li>
<li><p><cite>b3</cite>: allow the user to specify sample rate</p></li>
<li><p><cite>exception reporter</cite>: share scribe connection across instances</p></li>
<li><p><cite>finagle-ostrich</cite>: remove, it’s obsoleted by finagle-ostrich4</p></li>
</ul>
</section>
<section id="id462">
<h2>1.9.10<a class="headerlink" href="#id462" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/12/02</p>
<ul class="simple">
<li><p>update to util 1.12.7</p></li>
</ul>
</section>
<section id="id463">
<h2>1.9.9<a class="headerlink" href="#id463" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/12/01</p>
<ul class="simple">
<li><p>update to util 1.12.6</p></li>
</ul>
</section>
<section id="id464">
<h2>1.9.8<a class="headerlink" href="#id464" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/11/30</p>
<ul class="simple">
<li><p>upgrade to netty 3.2.7.Final</p></li>
<li><p><cite>streaming</cite>: support HTTP/1.0</p></li>
<li><p><cite>native</cite>: fix content-length header</p></li>
</ul>
</section>
<section id="id465">
<h2>1.9.7<a class="headerlink" href="#id465" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/11/29</p>
<ul class="simple">
<li><p><cite>http</cite>: Propagate CancelledRequestException rather than continuing</p></li>
<li><p><cite>thrift</cite>: deprecated LookupContext, using finagle.thrift.ClientId</p></li>
<li><p>use monitors where applicable (composable widgets for handling exceptions)</p></li>
<li><p><cite>memcache</cite>: PHPMemCacheClient</p></li>
<li><p>make RetryingFilter usable from Java</p></li>
<li><p><cite>thrift</cite>: convert uncaught application exceptions into TApplicationExceptions on the wire</p></li>
<li><p>NoStacktrace.getStackTrace() returns non-empty stacktrace array</p></li>
<li><p>kill off openConnectionsHealthThresholds (unused)</p></li>
</ul>
</section>
<section id="id466">
<h2>1.9.6<a class="headerlink" href="#id466" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/11/08</p>
<ul class="simple">
<li><p><cite>SSL</cite>: make native provider bootstrapping code work; refactor ‘Ssl’ singleton</p></li>
<li><p><cite>tracing</cite>: Update configurations and libraries to use tracer factory introduced to make it possible to release resources properly in tracers</p></li>
<li><p><cite>finagle-thrift</cite>: connection options + client id</p></li>
<li><p>a more flexible retry filter</p></li>
</ul>
</section>
<section id="id467">
<h2>1.9.5<a class="headerlink" href="#id467" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/11/04</p>
<ul class="simple">
<li><p><cite>ExpiringService</cite>: add stats for idle and lifetime expiration. Deactivate() regardless of latch counter</p></li>
<li><p><cite>Filters</cite>: don’t apply refcounts on composition, do it only (and always) in the builder</p></li>
<li><p>Count pending timeouts, and export them</p></li>
<li><p><cite>ChannelService</cite>: release services when <cite>prepareChannel</cite> fails. This fixes a connection leak</p></li>
<li><p><cite>WatermarkPool</cite>: flush waiters on creation failure. This fixes a condition wherein we’d keep waiters unnecessarily.</p></li>
<li><p><cite>Timeout exceptions</cite>: include service name</p></li>
<li><p>Suppress excessive logging of the exceptions that mostly caused by unreliable client connections.</p></li>
<li><p><cite>memcached</cite>: Add generic type support (via Client.adapt), and Array[Byte] and String instances</p></li>
<li><p><cite>finagle-stream</cite>: do not admit concurrent requests</p></li>
<li><p><cite>Tracing</cite>: Add release method to Tracer trait, add tracerFactory to builders, deprecate tracer on builders</p></li>
</ul>
</section>
<section id="id468">
<h2>1.9.4<a class="headerlink" href="#id468" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/10/24</p>
<ul class="simple">
<li><p><cite>Service</cite>: response Future will now be cancelled if the client disconnects</p></li>
<li><p>use static exceptions for TimedOutRequestException</p></li>
<li><p><cite>kestrel</cite>: Cancel request Future on close in kestrel ReadHandle</p></li>
<li><p><cite>exception cleanup</cite>: wrap all Channel exceptions with their underlying exception. This makes UnknownChannelExceptions in particular easier to debug</p></li>
<li><p><cite>Friendlier exceptions</cite>: In order to give very specific error messages to timeouts in finagle (so beginners know which settings in the client and server builder caused them), I’m adding lots of human-readable messages to the various TimeoutExceptions.</p></li>
<li><p><cite>some timer bug fixes, particularly</cite>: TimerToNettyTimer: actually cancel underlying task.</p></li>
</ul>
</section>
<section id="id469">
<h2>1.9.2<a class="headerlink" href="#id469" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/10/14</p>
<ul class="simple">
<li><p><cite>tracing</cite>: Change SpanId to use RichU64String</p></li>
<li><p><cite>tracing</cite>: Trace.{enable,disable}</p></li>
<li><p><cite>http</cite>: http.RequestBuilder</p></li>
<li><p><cite>http</cite>: add common media types</p></li>
</ul>
</section>
<section id="id470">
<h2>1.9.1<a class="headerlink" href="#id470" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/09/28</p>
<ul class="simple">
<li><p><cite>memcached</cite>: new interface for partial results (ie. retrieval failures + successes)</p></li>
<li><p><cite>tracing</cite>: set service name in the endpoint instead of the span</p></li>
<li><p>more idiomatic KetamaClientBuilder constructor</p></li>
<li><p><cite>tracing</cite>: convenience methods to add binary annotations</p></li>
<li><p><cite>finagle-http</cite>: misc. fixes</p></li>
<li><p>HeapBalancer - a new lg n load balancer (asymptotically more efficient!)</p></li>
<li><p>upgrade to ostrich 4.9.0</p></li>
</ul>
</section>
<section id="id471">
<h2>1.9.0<a class="headerlink" href="#id471" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/08/29</p>
<ul class="simple">
<li><p><cite>http</cite>: new http library</p></li>
</ul>
</section>
<section id="id472">
<h2>1.8.4<a class="headerlink" href="#id472" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/08/23</p>
<ul class="simple">
<li><p><cite>tracing</cite>: fixed space leak</p></li>
<li><p><cite>ssl</cite>: integrate openssl sslengine</p></li>
<li><p><cite>thrift</cite>: update to sbt-thrift 2.0.1</p></li>
<li><p><cite>stream</cite>: always release server when we close</p></li>
<li><p><cite>serversets</cite>: upgraded to guava-r09</p></li>
<li><p><cite>core</cite>: expose stats on failed retries</p></li>
</ul>
</section>
<section id="id473">
<h2>1.8.3<a class="headerlink" href="#id473" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/08/12</p>
<ul class="simple">
<li><p><cite>thrift</cite>: add a server-side buffered codec; fix tracing issue in buffered codec</p></li>
<li><p><cite>http</cite>: workaround hole in netty logic to guarantee maxRequestSize</p></li>
<li><p><cite>serversets</cite>: don’t block on ClientBuilder construction</p></li>
<li><p><cite>ostrich4</cite>: update to ostrich 4.8.2</p></li>
<li><p><cite>streaming</cite>: reimplement HTTP chunked streaming in terms of offer/broker</p></li>
<li><p><cite>kestrel</cite>: buffered &amp; merging of ReadHandles</p></li>
</ul>
</section>
<section id="id474">
<h2>1.8.1<a class="headerlink" href="#id474" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/08/05</p>
<ul class="simple">
<li><p>upgrade to netty 3.2.5.Final</p></li>
<li><p><cite>kestrel</cite>: fix visibility of ResultWithCAS</p></li>
<li><p><cite>kestrel</cite>: Client.{read,write}, Client.readReliably, MultiReader: suite of kestrel streaming readers (including grabby-hands replacements) using Offer/Broker</p></li>
<li><p><cite>kestrel</cite>: don’t render timeouts &gt; 2^31-1</p></li>
<li><p><cite>tracing</cite>: fix sampling bug</p></li>
<li><p><cite>tracing</cite>: trace the kestrel client</p></li>
<li><p>quench unecessary error reporting</p></li>
</ul>
</section>
<section id="id475">
<h2>1.8.0<a class="headerlink" href="#id475" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/08/02</p>
<ul class="simple">
<li><p><cite>SSL</cite>: perform hostname validation in the client. this is the reason for the minor bump: we change the .tls() ClientBuilder signature</p></li>
<li><p>introduce util-codec dependency for use of the apache commons base 64 codec</p></li>
</ul>
</section>
<section id="id476">
<h2>1.7.5<a class="headerlink" href="#id476" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/07/29</p>
<ul class="simple">
<li><p>make it easier to use the NullStatsReceiver from java</p></li>
<li><p>convert WriteException to a case class (github issue 25)</p></li>
<li><p>add _root_. to java.util.Map import. reorder imports</p></li>
<li><p>Upgrade finagle-common-stats to twitter-common-stats 0.0.16</p></li>
<li><p>encode more HTTP codec errors</p></li>
<li><p>adding cardinality to ServiceException</p></li>
<li><p><cite>finagle CachingPool</cite>: limit size to highWatermark - lowWatermark</p></li>
<li><p><cite>exception reporting</cite>: gzipping trace strings</p></li>
<li><p>set ostrich version of finagle-ostrich4 to 4.7.3</p></li>
<li><p><cite>ChannelServiceFactory</cite>: encode exceptions from bootstrap.connect()</p></li>
</ul>
</section>
<section id="id477">
<h2>1.7.4<a class="headerlink" href="#id477" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/07/22</p>
<ul class="simple">
<li><p><cite>http</cite>: convert codec exceptions into 4xx errors; report them as such upstream</p></li>
<li><p><cite>memcache</cite>: <cite>gets</cite> and <cite>cas</cite> support.</p></li>
</ul>
</section>
<section id="id478">
<h2>1.7.3<a class="headerlink" href="#id478" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/07/19</p>
<ul class="simple">
<li><p><cite>fix</cite>: 1.7.2 introduced a regression in the pool that may, under certain circumstances, admit connections beyond the high watermark.</p></li>
<li><p>quench exception for setting multiple Promise values when racing with write errors.</p></li>
<li><p>Adds tracing support for the Memcached client. This only creates the client side annotations, no support for passing along ids and such to the memcached server.</p></li>
</ul>
</section>
<section id="id479">
<h2>1.7.2<a class="headerlink" href="#id479" title="Permalink to this headline">¶</a></h2>
<p>Released 2011/07/18</p>
<ul class="simple">
<li><p>support end-to-end cancellation in finagle clients; fixes possible pool starvation conditions, and allows clients to cancel requests and reclaim resources</p></li>
<li><p><cite>end-to-end timeouts</cite>: introduce, .connectTimeout and .timeout. .connectTimeout is the end-to-end connection timeout (includes acquisition &amp; TCP time), .timeout is an end-to-end request time: no requests will take longer</p></li>
<li><p>some doc fixes</p></li>
<li><p>misc. bug fixes</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo"><a href="index.html">
  <img class="logo" src="_static/logo_small.png" alt="Logo"/>
</a></p><a href="index.html"><h3>Finagle</h3></a>
<p>
  Finagle is a network stack for distributed systems.
</p>

<h3>Useful Links</h3>
<ul>
  <li><a href="https://github.com/twitter/finagle">Finagle @ GitHub</a></li>
  <li><a href="https://github.com/twitter/finagle/issues">Issue Tracker</a></li>
</ul>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Changelog</a><ul>
<li><a class="reference internal" href="#unreleased">Unreleased</a></li>
<li><a class="reference internal" href="#id1">24.2.0</a><ul>
<li><a class="reference internal" href="#new-features">New Features</a></li>
<li><a class="reference internal" href="#bug-fixes">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2">23.11.0</a><ul>
<li><a class="reference internal" href="#id3">New Features</a></li>
<li><a class="reference internal" href="#runtime-behavior-changes">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id4">Bug Fixes</a></li>
<li><a class="reference internal" href="#breaking-api-changes">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id5">22.12.0</a><ul>
<li><a class="reference internal" href="#id6">New Features</a></li>
<li><a class="reference internal" href="#id7">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id8">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id9">22.7.0</a><ul>
<li><a class="reference internal" href="#id10">New Features</a></li>
<li><a class="reference internal" href="#id13">Bug Fixes</a></li>
<li><a class="reference internal" href="#id14">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id15">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id16">22.4.0</a><ul>
<li><a class="reference internal" href="#id17">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id18">22.3.0</a><ul>
<li><a class="reference internal" href="#id19">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id20">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id21">22.2.0</a><ul>
<li><a class="reference internal" href="#id22">New Features</a></li>
<li><a class="reference internal" href="#id23">Bug Fixes</a></li>
<li><a class="reference internal" href="#id24">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id25">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id26">22.1.0</a><ul>
<li><a class="reference internal" href="#id27">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id28">21.12.0</a><ul>
<li><a class="reference internal" href="#deprecations">Deprecations</a></li>
<li><a class="reference internal" href="#id29">Bug Fixes</a></li>
<li><a class="reference internal" href="#id30">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id31">21.11.0</a><ul>
<li><a class="reference internal" href="#id32">New Features</a></li>
<li><a class="reference internal" href="#id33">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id34">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id35">21.10.0</a><ul>
<li><a class="reference internal" href="#id36">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id37">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id38">21.9.0</a><ul>
<li><a class="reference internal" href="#id39">New Features</a></li>
<li><a class="reference internal" href="#id40">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id41">Bug Fixes</a></li>
<li><a class="reference internal" href="#id42">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#no-21-7-0-release">21.8.0 (No 21.7.0 Release)</a><ul>
<li><a class="reference internal" href="#id43">New Features</a></li>
<li><a class="reference internal" href="#id44">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id45">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id46">21.6.0</a><ul>
<li><a class="reference internal" href="#id47">New Features</a></li>
<li><a class="reference internal" href="#id48">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id49">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id50">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id51">21.5.0</a><ul>
<li><a class="reference internal" href="#id52">New Features</a></li>
<li><a class="reference internal" href="#id53">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id54">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id55">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id56">21.4.0</a><ul>
<li><a class="reference internal" href="#id57">New Features</a></li>
<li><a class="reference internal" href="#id58">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id59">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id60">21.3.0</a><ul>
<li><a class="reference internal" href="#id61">New Features</a></li>
<li><a class="reference internal" href="#id62">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id63">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id64">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id65">21.2.0</a><ul>
<li><a class="reference internal" href="#id66">New Features</a></li>
<li><a class="reference internal" href="#id67">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id68">21.1.0</a><ul>
<li><a class="reference internal" href="#id69">New Features</a></li>
<li><a class="reference internal" href="#id70">Bug Fixes</a></li>
<li><a class="reference internal" href="#id71">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id72">20.12.0</a><ul>
<li><a class="reference internal" href="#id73">New Features</a></li>
<li><a class="reference internal" href="#id74">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id75">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id76">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id77">20.10.0</a><ul>
<li><a class="reference internal" href="#id78">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id79">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id80">20.9.0</a><ul>
<li><a class="reference internal" href="#id81">New Features</a></li>
<li><a class="reference internal" href="#id82">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id83">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id84">20.8.1</a><ul>
<li><a class="reference internal" href="#id85">New Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#do-not-use">20.8.0 (DO NOT USE)</a><ul>
<li><a class="reference internal" href="#id86">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id87">New Features</a></li>
<li><a class="reference internal" href="#id88">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id89">20.7.0</a><ul>
<li><a class="reference internal" href="#id90">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id91">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id92">20.6.0</a><ul>
<li><a class="reference internal" href="#id93">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id94">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id95">New Features</a></li>
<li><a class="reference internal" href="#id96">Bug Fixes</a></li>
<li><a class="reference internal" href="#id97">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id98">20.5.0</a><ul>
<li><a class="reference internal" href="#id99">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id100">20.4.1</a><ul>
<li><a class="reference internal" href="#id101">New Features</a></li>
<li><a class="reference internal" href="#id102">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id103">Bug Fixes</a></li>
<li><a class="reference internal" href="#id104">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id107">20.4.0 (DO NOT USE)</a><ul>
<li><a class="reference internal" href="#id108">New Features</a></li>
<li><a class="reference internal" href="#id109">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id110">Bug Fixes</a></li>
<li><a class="reference internal" href="#id111">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id112">20.3.0</a><ul>
<li><a class="reference internal" href="#id113">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id114">Bug Fixes</a></li>
<li><a class="reference internal" href="#id115">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id116">20.2.1</a><ul>
<li><a class="reference internal" href="#id117">New Features</a></li>
<li><a class="reference internal" href="#id118">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id119">Bug Fixes</a></li>
<li><a class="reference internal" href="#id120">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id121">20.1.0</a><ul>
<li><a class="reference internal" href="#id122">New Features</a></li>
<li><a class="reference internal" href="#id123">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id124">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id125">19.12.0</a><ul>
<li><a class="reference internal" href="#id126">New Features</a></li>
<li><a class="reference internal" href="#id127">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id128">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id129">Deprecations</a></li>
<li><a class="reference internal" href="#id130">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id131">19.11.0</a><ul>
<li><a class="reference internal" href="#id132">New Features</a></li>
<li><a class="reference internal" href="#id133">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id134">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id135">19.10.0</a><ul>
<li><a class="reference internal" href="#id136">New Features</a></li>
<li><a class="reference internal" href="#id137">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id138">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id139">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id140">19.9.0</a><ul>
<li><a class="reference internal" href="#id141">New Features</a></li>
<li><a class="reference internal" href="#id142">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id143">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id144">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id145">19.8.0</a><ul>
<li><a class="reference internal" href="#id146">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id147">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id148">19.7.0</a><ul>
<li><a class="reference internal" href="#id149">New Features</a></li>
<li><a class="reference internal" href="#id150">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id151">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id152">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id153">19.6.0</a><ul>
<li><a class="reference internal" href="#id154">New Features</a></li>
<li><a class="reference internal" href="#id155">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id156">Bug Fixes</a></li>
<li><a class="reference internal" href="#id157">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id158">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id159">19.5.1</a></li>
<li><a class="reference internal" href="#id160">19.5.0</a><ul>
<li><a class="reference internal" href="#id161">New Features</a></li>
<li><a class="reference internal" href="#id162">Bug Fixes</a></li>
<li><a class="reference internal" href="#id163">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id164">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id165">19.4.0</a><ul>
<li><a class="reference internal" href="#id166">New Features</a></li>
<li><a class="reference internal" href="#id167">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id168">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id169">19.3.0</a><ul>
<li><a class="reference internal" href="#id170">New Features</a></li>
<li><a class="reference internal" href="#id171">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id172">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id173">19.2.0</a><ul>
<li><a class="reference internal" href="#id174">New Features</a></li>
<li><a class="reference internal" href="#id175">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id176">Bug Fixes</a></li>
<li><a class="reference internal" href="#id177">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id178">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id179">19.1.0</a><ul>
<li><a class="reference internal" href="#id180">New Features</a></li>
<li><a class="reference internal" href="#id181">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id182">Bug Fixes</a></li>
<li><a class="reference internal" href="#id183">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id184">18.12.0</a><ul>
<li><a class="reference internal" href="#id185">New Features</a></li>
<li><a class="reference internal" href="#id186">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id187">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id188">18.11.0</a><ul>
<li><a class="reference internal" href="#id189">New Features</a></li>
<li><a class="reference internal" href="#id190">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id191">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id192">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id193">18.10.0</a><ul>
<li><a class="reference internal" href="#id194">Deprecations</a></li>
<li><a class="reference internal" href="#id195">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id196">18.9.1</a><ul>
<li><a class="reference internal" href="#id197">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id198">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id199">18.9.0</a><ul>
<li><a class="reference internal" href="#id200">New Features</a></li>
<li><a class="reference internal" href="#id201">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id202">Bug Fixes</a></li>
<li><a class="reference internal" href="#id203">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id204">18.8.0</a><ul>
<li><a class="reference internal" href="#id205">New Features</a></li>
<li><a class="reference internal" href="#id206">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id207">Bug Fixes</a></li>
<li><a class="reference internal" href="#id208">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id209">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id210">18.7.0</a><ul>
<li><a class="reference internal" href="#id211">New Features</a></li>
<li><a class="reference internal" href="#id212">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id213">Bug Fixes</a></li>
<li><a class="reference internal" href="#id214">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id215">18.6.0</a><ul>
<li><a class="reference internal" href="#id216">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id217">New Features</a></li>
<li><a class="reference internal" href="#id218">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id219">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id220">18.5.0</a><ul>
<li><a class="reference internal" href="#id221">New Features</a></li>
<li><a class="reference internal" href="#id222">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id223">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id224">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id225">18.4.0</a><ul>
<li><a class="reference internal" href="#id226">New Features</a></li>
<li><a class="reference internal" href="#id227">Bug Fixes</a></li>
<li><a class="reference internal" href="#id228">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id229">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id230">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id231">18.3.0</a><ul>
<li><a class="reference internal" href="#id232">New Features</a></li>
<li><a class="reference internal" href="#id233">Bug Fixes</a></li>
<li><a class="reference internal" href="#id234">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id235">18.2.0</a><ul>
<li><a class="reference internal" href="#id236">New Features</a></li>
<li><a class="reference internal" href="#id237">Bug Fixes</a></li>
<li><a class="reference internal" href="#id238">Deprecations</a></li>
<li><a class="reference internal" href="#id239">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id240">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id241">18.1.0</a><ul>
<li><a class="reference internal" href="#id242">New Features</a></li>
<li><a class="reference internal" href="#id243">Bug Fixes</a></li>
<li><a class="reference internal" href="#id244">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id245">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id246">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id247">17.12.0</a><ul>
<li><a class="reference internal" href="#id248">New Features</a></li>
<li><a class="reference internal" href="#id249">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id250">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id251">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id252">17.11.0</a><ul>
<li><a class="reference internal" href="#id253">New Features</a></li>
<li><a class="reference internal" href="#id254">Bug Fixes</a></li>
<li><a class="reference internal" href="#id255">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id256">17.10.0</a><ul>
<li><a class="reference internal" href="#release-version-format">Release Version Format</a></li>
<li><a class="reference internal" href="#id257">New Features</a></li>
<li><a class="reference internal" href="#id258">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id259">Deprecations</a></li>
<li><a class="reference internal" href="#id260">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id261">7.1.0</a><ul>
<li><a class="reference internal" href="#id262">New Features</a></li>
<li><a class="reference internal" href="#id263">Bug Fixes</a></li>
<li><a class="reference internal" href="#id264">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id265">Deprecations</a></li>
<li><a class="reference internal" href="#id266">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id267">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id268">7.0.0</a><ul>
<li><a class="reference internal" href="#id269">New Features</a></li>
<li><a class="reference internal" href="#id270">Bug Fixes</a></li>
<li><a class="reference internal" href="#id271">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id272">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id273">6.45.0</a><ul>
<li><a class="reference internal" href="#id274">New Features</a></li>
<li><a class="reference internal" href="#id275">Bug Fixes</a></li>
<li><a class="reference internal" href="#id276">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id277">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id278">6.44.0</a><ul>
<li><a class="reference internal" href="#id279">New Features</a></li>
<li><a class="reference internal" href="#id280">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id281">Bug Fixes</a></li>
<li><a class="reference internal" href="#id282">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id283">6.43.0</a><ul>
<li><a class="reference internal" href="#id284">New Features</a></li>
<li><a class="reference internal" href="#id285">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id286">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id287">Deprecations</a></li>
<li><a class="reference internal" href="#id288">Bug Fixes</a></li>
<li><a class="reference internal" href="#id289">Dependencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id290">6.42.0</a><ul>
<li><a class="reference internal" href="#id291">New Features</a></li>
<li><a class="reference internal" href="#id292">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id293">Deprecations</a></li>
<li><a class="reference internal" href="#id294">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id295">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id296">6.41.0</a><ul>
<li><a class="reference internal" href="#id297">New Features</a></li>
<li><a class="reference internal" href="#id298">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id299">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id300">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id301">6.40.0</a><ul>
<li><a class="reference internal" href="#id302">New Features</a></li>
<li><a class="reference internal" href="#id303">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id304">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id305">Bug Fixes</a></li>
<li><a class="reference internal" href="#id306">Deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id307">6.39.0</a><ul>
<li><a class="reference internal" href="#id308">New Features</a></li>
<li><a class="reference internal" href="#id309">Deprecations</a></li>
<li><a class="reference internal" href="#id310">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id311">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id312">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id313">6.38.0</a><ul>
<li><a class="reference internal" href="#id314">New Features</a></li>
<li><a class="reference internal" href="#id315">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id316">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id317">6.37.0</a><ul>
<li><a class="reference internal" href="#id318">Deprecations</a></li>
<li><a class="reference internal" href="#id319">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id320">New Features</a></li>
<li><a class="reference internal" href="#id321">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id322">6.36.0</a><ul>
<li><a class="reference internal" href="#id323">Deprecations</a></li>
<li><a class="reference internal" href="#id324">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id325">Bug Fixes</a></li>
<li><a class="reference internal" href="#id326">New Features</a></li>
<li><a class="reference internal" href="#id327">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id328">6.35.0</a><ul>
<li><a class="reference internal" href="#id329">Deprecations</a></li>
<li><a class="reference internal" href="#id330">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id331">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id332">New Features</a></li>
<li><a class="reference internal" href="#id333">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id334">6.34.0</a><ul>
<li><a class="reference internal" href="#id335">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id336">New Features</a></li>
<li><a class="reference internal" href="#id337">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id338">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id339">6.33.0</a><ul>
<li><a class="reference internal" href="#id340">New Features</a></li>
<li><a class="reference internal" href="#id341">Deprecations</a></li>
<li><a class="reference internal" href="#id342">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id343">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id344">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id345">6.32.0</a></li>
<li><a class="reference internal" href="#id346">6.31.0</a><ul>
<li><a class="reference internal" href="#id347">New Features</a></li>
<li><a class="reference internal" href="#id348">Deprecations</a></li>
<li><a class="reference internal" href="#id349">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id350">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id351">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id352">6.30.0</a><ul>
<li><a class="reference internal" href="#id353">New Features</a></li>
<li><a class="reference internal" href="#id354">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id355">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id356">6.29.0</a><ul>
<li><a class="reference internal" href="#id357">Deprecations</a></li>
<li><a class="reference internal" href="#id358">New Features</a></li>
<li><a class="reference internal" href="#id359">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id360">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id361">6.28.0</a><ul>
<li><a class="reference internal" href="#id362">New Features</a></li>
<li><a class="reference internal" href="#id363">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id364">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id365">6.27.0</a><ul>
<li><a class="reference internal" href="#id366">New Features</a></li>
<li><a class="reference internal" href="#id367">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id368">Breaking API Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id369">6.26.0</a><ul>
<li><a class="reference internal" href="#id370">Deprecations</a></li>
<li><a class="reference internal" href="#id371">New Features</a></li>
<li><a class="reference internal" href="#id372">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id373">New Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id374">6.25.0</a><ul>
<li><a class="reference internal" href="#id375">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id376">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id377">Deprecations</a></li>
<li><a class="reference internal" href="#id378">New Features</a></li>
<li><a class="reference internal" href="#id379">Bug Fixes</a></li>
<li><a class="reference internal" href="#miscellaneous-cleanup">Miscellaneous Cleanup</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id380">6.24.0</a><ul>
<li><a class="reference internal" href="#id381">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id382">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#id383">Deprecations</a></li>
<li><a class="reference internal" href="#id384">New Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id385">6.23.0</a><ul>
<li><a class="reference internal" href="#id386">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id387">Deprecations</a></li>
<li><a class="reference internal" href="#id388">Runtime Behavior Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id389">6.22.0</a><ul>
<li><a class="reference internal" href="#id390">Breaking API Changes</a></li>
<li><a class="reference internal" href="#id391">New Features</a></li>
<li><a class="reference internal" href="#id392">Runtime Behavior Changes</a></li>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#optimization">Optimization</a></li>
<li><a class="reference internal" href="#id393">Bug Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id394">6.21.0</a></li>
<li><a class="reference internal" href="#id395">6.20.0</a></li>
<li><a class="reference internal" href="#id396">6.19.0</a></li>
<li><a class="reference internal" href="#id397">6.18.0</a></li>
<li><a class="reference internal" href="#id398">6.17.0</a></li>
<li><a class="reference internal" href="#id399">6.16.0</a></li>
<li><a class="reference internal" href="#id400">6.15.0</a></li>
<li><a class="reference internal" href="#id401">6.14.0</a></li>
<li><a class="reference internal" href="#id402">6.13.1</a></li>
<li><a class="reference internal" href="#id403">6.13.0</a></li>
<li><a class="reference internal" href="#id404">6.12.2</a></li>
<li><a class="reference internal" href="#id405">6.12.1</a></li>
<li><a class="reference internal" href="#id406">6.12.0</a></li>
<li><a class="reference internal" href="#id407">6.11.1</a></li>
<li><a class="reference internal" href="#id408">6.11.0</a></li>
<li><a class="reference internal" href="#id409">6.10.0</a></li>
<li><a class="reference internal" href="#id410">6.9.0</a></li>
<li><a class="reference internal" href="#id411">6.8.1</a></li>
<li><a class="reference internal" href="#id412">6.8.0</a></li>
<li><a class="reference internal" href="#id413">6.7.4</a></li>
<li><a class="reference internal" href="#id414">6.7.2</a></li>
<li><a class="reference internal" href="#id415">6.7.1</a></li>
<li><a class="reference internal" href="#id416">6.7.0</a></li>
<li><a class="reference internal" href="#id417">6.6.2</a></li>
<li><a class="reference internal" href="#id418">6.6.0</a></li>
<li><a class="reference internal" href="#id419">6.5.2</a></li>
<li><a class="reference internal" href="#id420">6.5.1</a></li>
<li><a class="reference internal" href="#id421">6.5.0</a></li>
<li><a class="reference internal" href="#id422">6.4.1</a></li>
<li><a class="reference internal" href="#id423">6.4.0</a></li>
<li><a class="reference internal" href="#id424">6.3.0</a></li>
<li><a class="reference internal" href="#id425">6.1.4</a></li>
<li><a class="reference internal" href="#id426">6.1.3</a></li>
<li><a class="reference internal" href="#id427">6.1.2</a></li>
<li><a class="reference internal" href="#id428">6.1.1</a></li>
<li><a class="reference internal" href="#id429">6.1.0</a></li>
<li><a class="reference internal" href="#id430">6.0.5</a></li>
<li><a class="reference internal" href="#id431">6.0.4</a></li>
<li><a class="reference internal" href="#id432">6.0.3</a></li>
<li><a class="reference internal" href="#id433">6.0.2</a></li>
<li><a class="reference internal" href="#id434">6.0.1</a></li>
<li><a class="reference internal" href="#id435">6.0.0</a></li>
<li><a class="reference internal" href="#id436">5.3.23</a></li>
<li><a class="reference internal" href="#id437">5.3.22</a></li>
<li><a class="reference internal" href="#id438">5.3.20</a></li>
<li><a class="reference internal" href="#id439">5.3.19</a></li>
<li><a class="reference internal" href="#id440">5.3.18</a></li>
<li><a class="reference internal" href="#id441">5.3.9</a></li>
<li><a class="reference internal" href="#id442">5.3.8</a></li>
<li><a class="reference internal" href="#id443">5.3.7</a></li>
<li><a class="reference internal" href="#id444">5.3.6</a></li>
<li><a class="reference internal" href="#id445">5.3.5</a></li>
<li><a class="reference internal" href="#id446">5.3.4</a></li>
<li><a class="reference internal" href="#id447">5.3.3</a></li>
<li><a class="reference internal" href="#id448">5.3.2</a></li>
<li><a class="reference internal" href="#id449">5.3.1</a></li>
<li><a class="reference internal" href="#id450">5.3.0</a></li>
<li><a class="reference internal" href="#id451">5.1.0</a></li>
<li><a class="reference internal" href="#id452">5.0.2</a></li>
<li><a class="reference internal" href="#id453">5.0.0</a></li>
<li><a class="reference internal" href="#id454">4.0.0</a></li>
<li><a class="reference internal" href="#id455">3.0.0</a></li>
<li><a class="reference internal" href="#id456">2.0.1</a></li>
<li><a class="reference internal" href="#id457">2.0.0</a></li>
<li><a class="reference internal" href="#id458">1.11.1</a></li>
<li><a class="reference internal" href="#id459">1.11.0</a></li>
<li><a class="reference internal" href="#id460">1.10.0</a></li>
<li><a class="reference internal" href="#id461">1.9.12</a></li>
<li><a class="reference internal" href="#id462">1.9.10</a></li>
<li><a class="reference internal" href="#id463">1.9.9</a></li>
<li><a class="reference internal" href="#id464">1.9.8</a></li>
<li><a class="reference internal" href="#id465">1.9.7</a></li>
<li><a class="reference internal" href="#id466">1.9.6</a></li>
<li><a class="reference internal" href="#id467">1.9.5</a></li>
<li><a class="reference internal" href="#id468">1.9.4</a></li>
<li><a class="reference internal" href="#id469">1.9.2</a></li>
<li><a class="reference internal" href="#id470">1.9.1</a></li>
<li><a class="reference internal" href="#id471">1.9.0</a></li>
<li><a class="reference internal" href="#id472">1.8.4</a></li>
<li><a class="reference internal" href="#id473">1.8.3</a></li>
<li><a class="reference internal" href="#id474">1.8.1</a></li>
<li><a class="reference internal" href="#id475">1.8.0</a></li>
<li><a class="reference internal" href="#id476">1.7.5</a></li>
<li><a class="reference internal" href="#id477">1.7.4</a></li>
<li><a class="reference internal" href="#id478">1.7.3</a></li>
<li><a class="reference internal" href="#id479">1.7.2</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="developers/SignalingFailure.html" title="previous chapter">Signaling Failure within Finagle</a></li>
      <li>Next: <a href="license.html" title="next chapter">License</a></li>
  </ul></li>
</ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Search the contents of this site.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">&copy; Copyright 2024 Twitter, Inc.</div>
  
  </body>
</html>