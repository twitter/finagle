define service {[
	line down .05 left .05 then down .05 right .1 then down .05 left .1 then down .1 right .2 then down .1 left .2 then down .1 right .1
	down
	box "Codec"
	box "Transport"
	box "Service"
]}


define channelservice {[
	Fun: [
		  service
 		"\fB() => \fP" rjust at last [].w
 	]
 	
	box  ht 2.4 wid boxwid*3 thickness 2 with .n at Fun.n
	"\fIServiceFactory - ChannelService\fP" with .s at last box.s+(0,.2)
]}

define stack {[
	channelservice

	movewid=.2
	[service ; service; service] with .n at last [].s+(0,-.2)

	box with .nw at last [].nw wid last [].wid  ht last[].ht+boxht thickness 2
	"\fIServiceFactory - Pool\fP" with .s at  last box.s+(0,.2)
	"..." with .n at last box.s+(0,-.2)
]}
